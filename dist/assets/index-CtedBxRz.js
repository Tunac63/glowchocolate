(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function yS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var M_={exports:{}},pu={},V_={exports:{}},he={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uo=Symbol.for("react.element"),vS=Symbol.for("react.portal"),_S=Symbol.for("react.fragment"),wS=Symbol.for("react.strict_mode"),ES=Symbol.for("react.profiler"),TS=Symbol.for("react.provider"),kS=Symbol.for("react.context"),IS=Symbol.for("react.forward_ref"),SS=Symbol.for("react.suspense"),AS=Symbol.for("react.memo"),NS=Symbol.for("react.lazy"),kg=Symbol.iterator;function xS(t){return t===null||typeof t!="object"?null:(t=kg&&t[kg]||t["@@iterator"],typeof t=="function"?t:null)}var L_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},F_=Object.assign,U_={};function ia(t,e,n){this.props=t,this.context=e,this.refs=U_,this.updater=n||L_}ia.prototype.isReactComponent={};ia.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ia.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function B_(){}B_.prototype=ia.prototype;function Uf(t,e,n){this.props=t,this.context=e,this.refs=U_,this.updater=n||L_}var Bf=Uf.prototype=new B_;Bf.constructor=Uf;F_(Bf,ia.prototype);Bf.isPureReactComponent=!0;var Ig=Array.isArray,z_=Object.prototype.hasOwnProperty,zf={current:null},$_={key:!0,ref:!0,__self:!0,__source:!0};function G_(t,e,n){var r,i={},s=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)z_.call(e,r)&&!$_.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var u=Array(l),d=0;d<l;d++)u[d]=arguments[d+2];i.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:Uo,type:t,key:s,ref:a,props:i,_owner:zf.current}}function CS(t,e){return{$$typeof:Uo,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function $f(t){return typeof t=="object"&&t!==null&&t.$$typeof===Uo}function RS(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Sg=/\/+/g;function Id(t,e){return typeof t=="object"&&t!==null&&t.key!=null?RS(""+t.key):e.toString(36)}function Zl(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Uo:case vS:a=!0}}if(a)return a=t,i=i(a),t=r===""?"."+Id(a,0):r,Ig(i)?(n="",t!=null&&(n=t.replace(Sg,"$&/")+"/"),Zl(i,e,n,"",function(d){return d})):i!=null&&($f(i)&&(i=CS(i,n+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(Sg,"$&/")+"/")+t)),e.push(i)),1;if(a=0,r=r===""?".":r+":",Ig(t))for(var l=0;l<t.length;l++){s=t[l];var u=r+Id(s,l);a+=Zl(s,e,n,u,i)}else if(u=xS(t),typeof u=="function")for(t=u.call(t),l=0;!(s=t.next()).done;)s=s.value,u=r+Id(s,l++),a+=Zl(s,e,n,u,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Al(t,e,n){if(t==null)return t;var r=[],i=0;return Zl(t,r,"","",function(s){return e.call(n,s,i++)}),r}function bS(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var qt={current:null},ec={transition:null},DS={ReactCurrentDispatcher:qt,ReactCurrentBatchConfig:ec,ReactCurrentOwner:zf};function K_(){throw Error("act(...) is not supported in production builds of React.")}he.Children={map:Al,forEach:function(t,e,n){Al(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Al(t,function(){e++}),e},toArray:function(t){return Al(t,function(e){return e})||[]},only:function(t){if(!$f(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};he.Component=ia;he.Fragment=_S;he.Profiler=ES;he.PureComponent=Uf;he.StrictMode=wS;he.Suspense=SS;he.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=DS;he.act=K_;he.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=F_({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=zf.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)z_.call(e,u)&&!$_.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var d=0;d<u;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:Uo,type:t.type,key:i,ref:s,props:r,_owner:a}};he.createContext=function(t){return t={$$typeof:kS,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:TS,_context:t},t.Consumer=t};he.createElement=G_;he.createFactory=function(t){var e=G_.bind(null,t);return e.type=t,e};he.createRef=function(){return{current:null}};he.forwardRef=function(t){return{$$typeof:IS,render:t}};he.isValidElement=$f;he.lazy=function(t){return{$$typeof:NS,_payload:{_status:-1,_result:t},_init:bS}};he.memo=function(t,e){return{$$typeof:AS,type:t,compare:e===void 0?null:e}};he.startTransition=function(t){var e=ec.transition;ec.transition={};try{t()}finally{ec.transition=e}};he.unstable_act=K_;he.useCallback=function(t,e){return qt.current.useCallback(t,e)};he.useContext=function(t){return qt.current.useContext(t)};he.useDebugValue=function(){};he.useDeferredValue=function(t){return qt.current.useDeferredValue(t)};he.useEffect=function(t,e){return qt.current.useEffect(t,e)};he.useId=function(){return qt.current.useId()};he.useImperativeHandle=function(t,e,n){return qt.current.useImperativeHandle(t,e,n)};he.useInsertionEffect=function(t,e){return qt.current.useInsertionEffect(t,e)};he.useLayoutEffect=function(t,e){return qt.current.useLayoutEffect(t,e)};he.useMemo=function(t,e){return qt.current.useMemo(t,e)};he.useReducer=function(t,e,n){return qt.current.useReducer(t,e,n)};he.useRef=function(t){return qt.current.useRef(t)};he.useState=function(t){return qt.current.useState(t)};he.useSyncExternalStore=function(t,e,n){return qt.current.useSyncExternalStore(t,e,n)};he.useTransition=function(){return qt.current.useTransition()};he.version="18.3.1";V_.exports=he;var M=V_.exports;const q_=yS(M);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jS=M,PS=Symbol.for("react.element"),OS=Symbol.for("react.fragment"),MS=Object.prototype.hasOwnProperty,VS=jS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,LS={key:!0,ref:!0,__self:!0,__source:!0};function H_(t,e,n){var r,i={},s=null,a=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)MS.call(e,r)&&!LS.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:PS,type:t,key:s,ref:a,props:i,_owner:VS.current}}pu.Fragment=OS;pu.jsx=H_;pu.jsxs=H_;M_.exports=pu;var c=M_.exports,yh={},W_={exports:{}},vn={},Q_={exports:{}},Y_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e($,K){var Y=$.length;$.push(K);e:for(;0<Y;){var ve=Y-1>>>1,ue=$[ve];if(0<i(ue,K))$[ve]=K,$[Y]=ue,Y=ve;else break e}}function n($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var K=$[0],Y=$.pop();if(Y!==K){$[0]=Y;e:for(var ve=0,ue=$.length,Ie=ue>>>1;ve<Ie;){var lt=2*(ve+1)-1,Ae=$[lt],xt=lt+1,Ye=$[xt];if(0>i(Ae,Y))xt<ue&&0>i(Ye,Ae)?($[ve]=Ye,$[xt]=Y,ve=xt):($[ve]=Ae,$[lt]=Y,ve=lt);else if(xt<ue&&0>i(Ye,Y))$[ve]=Ye,$[xt]=Y,ve=xt;else break e}}return K}function i($,K){var Y=$.sortIndex-K.sortIndex;return Y!==0?Y:$.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var u=[],d=[],m=1,p=null,g=3,k=!1,S=!1,R=!1,D=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I($){for(var K=n(d);K!==null;){if(K.callback===null)r(d);else if(K.startTime<=$)r(d),K.sortIndex=K.expirationTime,e(u,K);else break;K=n(d)}}function P($){if(R=!1,I($),!S)if(n(u)!==null)S=!0,be(F);else{var K=n(d);K!==null&&ze(P,K.startTime-$)}}function F($,K){S=!1,R&&(R=!1,w(v),v=-1),k=!0;var Y=g;try{for(I(K),p=n(u);p!==null&&(!(p.expirationTime>K)||$&&!A());){var ve=p.callback;if(typeof ve=="function"){p.callback=null,g=p.priorityLevel;var ue=ve(p.expirationTime<=K);K=t.unstable_now(),typeof ue=="function"?p.callback=ue:p===n(u)&&r(u),I(K)}else r(u);p=n(u)}if(p!==null)var Ie=!0;else{var lt=n(d);lt!==null&&ze(P,lt.startTime-K),Ie=!1}return Ie}finally{p=null,g=Y,k=!1}}var B=!1,N=null,v=-1,E=5,x=-1;function A(){return!(t.unstable_now()-x<E)}function b(){if(N!==null){var $=t.unstable_now();x=$;var K=!0;try{K=N(!0,$)}finally{K?C():(B=!1,N=null)}}else B=!1}var C;if(typeof y=="function")C=function(){y(b)};else if(typeof MessageChannel<"u"){var ye=new MessageChannel,Ue=ye.port2;ye.port1.onmessage=b,C=function(){Ue.postMessage(null)}}else C=function(){D(b,0)};function be($){N=$,B||(B=!0,C())}function ze($,K){v=D(function(){$(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function($){$.callback=null},t.unstable_continueExecution=function(){S||k||(S=!0,be(F))},t.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<$?Math.floor(1e3/$):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function($){switch(g){case 1:case 2:case 3:var K=3;break;default:K=g}var Y=g;g=K;try{return $()}finally{g=Y}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function($,K){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var Y=g;g=$;try{return K()}finally{g=Y}},t.unstable_scheduleCallback=function($,K,Y){var ve=t.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?ve+Y:ve):Y=ve,$){case 1:var ue=-1;break;case 2:ue=250;break;case 5:ue=1073741823;break;case 4:ue=1e4;break;default:ue=5e3}return ue=Y+ue,$={id:m++,callback:K,priorityLevel:$,startTime:Y,expirationTime:ue,sortIndex:-1},Y>ve?($.sortIndex=Y,e(d,$),n(u)===null&&$===n(d)&&(R?(w(v),v=-1):R=!0,ze(P,Y-ve))):($.sortIndex=ue,e(u,$),S||k||(S=!0,be(F))),$},t.unstable_shouldYield=A,t.unstable_wrapCallback=function($){var K=g;return function(){var Y=g;g=K;try{return $.apply(this,arguments)}finally{g=Y}}}})(Y_);Q_.exports=Y_;var FS=Q_.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var US=M,gn=FS;function z(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var J_=new Set,uo={};function es(t,e){$s(t,e),$s(t+"Capture",e)}function $s(t,e){for(uo[t]=e,t=0;t<e.length;t++)J_.add(e[t])}var _r=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vh=Object.prototype.hasOwnProperty,BS=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ag={},Ng={};function zS(t){return vh.call(Ng,t)?!0:vh.call(Ag,t)?!1:BS.test(t)?Ng[t]=!0:(Ag[t]=!0,!1)}function $S(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function GS(t,e,n,r){if(e===null||typeof e>"u"||$S(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ht(t,e,n,r,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var St={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){St[t]=new Ht(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];St[e]=new Ht(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){St[t]=new Ht(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){St[t]=new Ht(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){St[t]=new Ht(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){St[t]=new Ht(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){St[t]=new Ht(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){St[t]=new Ht(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){St[t]=new Ht(t,5,!1,t.toLowerCase(),null,!1,!1)});var Gf=/[\-:]([a-z])/g;function Kf(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Gf,Kf);St[e]=new Ht(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Gf,Kf);St[e]=new Ht(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Gf,Kf);St[e]=new Ht(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){St[t]=new Ht(t,1,!1,t.toLowerCase(),null,!1,!1)});St.xlinkHref=new Ht("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){St[t]=new Ht(t,1,!1,t.toLowerCase(),null,!0,!0)});function qf(t,e,n,r){var i=St.hasOwnProperty(e)?St[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(GS(e,n,i,r)&&(n=null),r||i===null?zS(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Cr=US.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Nl=Symbol.for("react.element"),ws=Symbol.for("react.portal"),Es=Symbol.for("react.fragment"),Hf=Symbol.for("react.strict_mode"),_h=Symbol.for("react.profiler"),X_=Symbol.for("react.provider"),Z_=Symbol.for("react.context"),Wf=Symbol.for("react.forward_ref"),wh=Symbol.for("react.suspense"),Eh=Symbol.for("react.suspense_list"),Qf=Symbol.for("react.memo"),Lr=Symbol.for("react.lazy"),ew=Symbol.for("react.offscreen"),xg=Symbol.iterator;function Ra(t){return t===null||typeof t!="object"?null:(t=xg&&t[xg]||t["@@iterator"],typeof t=="function"?t:null)}var Ke=Object.assign,Sd;function La(t){if(Sd===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Sd=e&&e[1]||""}return`
`+Sd+t}var Ad=!1;function Nd(t,e){if(!t||Ad)return"";Ad=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),s=r.stack.split(`
`),a=i.length-1,l=s.length-1;1<=a&&0<=l&&i[a]!==s[l];)l--;for(;1<=a&&0<=l;a--,l--)if(i[a]!==s[l]){if(a!==1||l!==1)do if(a--,l--,0>l||i[a]!==s[l]){var u=`
`+i[a].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=a&&0<=l);break}}}finally{Ad=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?La(t):""}function KS(t){switch(t.tag){case 5:return La(t.type);case 16:return La("Lazy");case 13:return La("Suspense");case 19:return La("SuspenseList");case 0:case 2:case 15:return t=Nd(t.type,!1),t;case 11:return t=Nd(t.type.render,!1),t;case 1:return t=Nd(t.type,!0),t;default:return""}}function Th(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Es:return"Fragment";case ws:return"Portal";case _h:return"Profiler";case Hf:return"StrictMode";case wh:return"Suspense";case Eh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Z_:return(t.displayName||"Context")+".Consumer";case X_:return(t._context.displayName||"Context")+".Provider";case Wf:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Qf:return e=t.displayName||null,e!==null?e:Th(t.type)||"Memo";case Lr:e=t._payload,t=t._init;try{return Th(t(e))}catch{}}return null}function qS(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Th(e);case 8:return e===Hf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ai(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function tw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function HS(t){var e=tw(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function xl(t){t._valueTracker||(t._valueTracker=HS(t))}function nw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=tw(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Ec(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function kh(t,e){var n=e.checked;return Ke({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Cg(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ai(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function rw(t,e){e=e.checked,e!=null&&qf(t,"checked",e,!1)}function Ih(t,e){rw(t,e);var n=ai(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Sh(t,e.type,n):e.hasOwnProperty("defaultValue")&&Sh(t,e.type,ai(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Rg(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Sh(t,e,n){(e!=="number"||Ec(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Fa=Array.isArray;function js(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ai(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Ah(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(z(91));return Ke({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function bg(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(z(92));if(Fa(n)){if(1<n.length)throw Error(z(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ai(n)}}function iw(t,e){var n=ai(e.value),r=ai(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Dg(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function sw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Nh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?sw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Cl,aw=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Cl=Cl||document.createElement("div"),Cl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Cl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ho(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Wa={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},WS=["Webkit","ms","Moz","O"];Object.keys(Wa).forEach(function(t){WS.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Wa[e]=Wa[t]})});function ow(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Wa.hasOwnProperty(t)&&Wa[t]?(""+e).trim():e+"px"}function lw(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=ow(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var QS=Ke({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xh(t,e){if(e){if(QS[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(z(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(z(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(z(61))}if(e.style!=null&&typeof e.style!="object")throw Error(z(62))}}function Ch(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Rh=null;function Yf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var bh=null,Ps=null,Os=null;function jg(t){if(t=$o(t)){if(typeof bh!="function")throw Error(z(280));var e=t.stateNode;e&&(e=wu(e),bh(t.stateNode,t.type,e))}}function cw(t){Ps?Os?Os.push(t):Os=[t]:Ps=t}function uw(){if(Ps){var t=Ps,e=Os;if(Os=Ps=null,jg(t),e)for(t=0;t<e.length;t++)jg(e[t])}}function dw(t,e){return t(e)}function hw(){}var xd=!1;function fw(t,e,n){if(xd)return t(e,n);xd=!0;try{return dw(t,e,n)}finally{xd=!1,(Ps!==null||Os!==null)&&(hw(),uw())}}function fo(t,e){var n=t.stateNode;if(n===null)return null;var r=wu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(z(231,e,typeof n));return n}var Dh=!1;if(_r)try{var ba={};Object.defineProperty(ba,"passive",{get:function(){Dh=!0}}),window.addEventListener("test",ba,ba),window.removeEventListener("test",ba,ba)}catch{Dh=!1}function YS(t,e,n,r,i,s,a,l,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(m){this.onError(m)}}var Qa=!1,Tc=null,kc=!1,jh=null,JS={onError:function(t){Qa=!0,Tc=t}};function XS(t,e,n,r,i,s,a,l,u){Qa=!1,Tc=null,YS.apply(JS,arguments)}function ZS(t,e,n,r,i,s,a,l,u){if(XS.apply(this,arguments),Qa){if(Qa){var d=Tc;Qa=!1,Tc=null}else throw Error(z(198));kc||(kc=!0,jh=d)}}function ts(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function mw(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Pg(t){if(ts(t)!==t)throw Error(z(188))}function e0(t){var e=t.alternate;if(!e){if(e=ts(t),e===null)throw Error(z(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Pg(i),t;if(s===r)return Pg(i),e;s=s.sibling}throw Error(z(188))}if(n.return!==r.return)n=i,r=s;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a)throw Error(z(189))}}if(n.alternate!==r)throw Error(z(190))}if(n.tag!==3)throw Error(z(188));return n.stateNode.current===n?t:e}function pw(t){return t=e0(t),t!==null?gw(t):null}function gw(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=gw(t);if(e!==null)return e;t=t.sibling}return null}var yw=gn.unstable_scheduleCallback,Og=gn.unstable_cancelCallback,t0=gn.unstable_shouldYield,n0=gn.unstable_requestPaint,et=gn.unstable_now,r0=gn.unstable_getCurrentPriorityLevel,Jf=gn.unstable_ImmediatePriority,vw=gn.unstable_UserBlockingPriority,Ic=gn.unstable_NormalPriority,i0=gn.unstable_LowPriority,_w=gn.unstable_IdlePriority,gu=null,Yn=null;function s0(t){if(Yn&&typeof Yn.onCommitFiberRoot=="function")try{Yn.onCommitFiberRoot(gu,t,void 0,(t.current.flags&128)===128)}catch{}}var Ln=Math.clz32?Math.clz32:l0,a0=Math.log,o0=Math.LN2;function l0(t){return t>>>=0,t===0?32:31-(a0(t)/o0|0)|0}var Rl=64,bl=4194304;function Ua(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Sc(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,a=n&268435455;if(a!==0){var l=a&~i;l!==0?r=Ua(l):(s&=a,s!==0&&(r=Ua(s)))}else a=n&~i,a!==0?r=Ua(a):s!==0&&(r=Ua(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Ln(e),i=1<<n,r|=t[n],e&=~i;return r}function c0(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function u0(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-Ln(s),l=1<<a,u=i[a];u===-1?(!(l&n)||l&r)&&(i[a]=c0(l,e)):u<=e&&(t.expiredLanes|=l),s&=~l}}function Ph(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function ww(){var t=Rl;return Rl<<=1,!(Rl&4194240)&&(Rl=64),t}function Cd(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Bo(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ln(e),t[e]=n}function d0(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Ln(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function Xf(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Ln(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Ne=0;function Ew(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Tw,Zf,kw,Iw,Sw,Oh=!1,Dl=[],Qr=null,Yr=null,Jr=null,mo=new Map,po=new Map,Ur=[],h0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mg(t,e){switch(t){case"focusin":case"focusout":Qr=null;break;case"dragenter":case"dragleave":Yr=null;break;case"mouseover":case"mouseout":Jr=null;break;case"pointerover":case"pointerout":mo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":po.delete(e.pointerId)}}function Da(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=$o(e),e!==null&&Zf(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function f0(t,e,n,r,i){switch(e){case"focusin":return Qr=Da(Qr,t,e,n,r,i),!0;case"dragenter":return Yr=Da(Yr,t,e,n,r,i),!0;case"mouseover":return Jr=Da(Jr,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return mo.set(s,Da(mo.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,po.set(s,Da(po.get(s)||null,t,e,n,r,i)),!0}return!1}function Aw(t){var e=ji(t.target);if(e!==null){var n=ts(e);if(n!==null){if(e=n.tag,e===13){if(e=mw(n),e!==null){t.blockedOn=e,Sw(t.priority,function(){kw(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function tc(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Mh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Rh=r,n.target.dispatchEvent(r),Rh=null}else return e=$o(n),e!==null&&Zf(e),t.blockedOn=n,!1;e.shift()}return!0}function Vg(t,e,n){tc(t)&&n.delete(e)}function m0(){Oh=!1,Qr!==null&&tc(Qr)&&(Qr=null),Yr!==null&&tc(Yr)&&(Yr=null),Jr!==null&&tc(Jr)&&(Jr=null),mo.forEach(Vg),po.forEach(Vg)}function ja(t,e){t.blockedOn===e&&(t.blockedOn=null,Oh||(Oh=!0,gn.unstable_scheduleCallback(gn.unstable_NormalPriority,m0)))}function go(t){function e(i){return ja(i,t)}if(0<Dl.length){ja(Dl[0],t);for(var n=1;n<Dl.length;n++){var r=Dl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Qr!==null&&ja(Qr,t),Yr!==null&&ja(Yr,t),Jr!==null&&ja(Jr,t),mo.forEach(e),po.forEach(e),n=0;n<Ur.length;n++)r=Ur[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ur.length&&(n=Ur[0],n.blockedOn===null);)Aw(n),n.blockedOn===null&&Ur.shift()}var Ms=Cr.ReactCurrentBatchConfig,Ac=!0;function p0(t,e,n,r){var i=Ne,s=Ms.transition;Ms.transition=null;try{Ne=1,em(t,e,n,r)}finally{Ne=i,Ms.transition=s}}function g0(t,e,n,r){var i=Ne,s=Ms.transition;Ms.transition=null;try{Ne=4,em(t,e,n,r)}finally{Ne=i,Ms.transition=s}}function em(t,e,n,r){if(Ac){var i=Mh(t,e,n,r);if(i===null)Fd(t,e,r,Nc,n),Mg(t,r);else if(f0(i,t,e,n,r))r.stopPropagation();else if(Mg(t,r),e&4&&-1<h0.indexOf(t)){for(;i!==null;){var s=$o(i);if(s!==null&&Tw(s),s=Mh(t,e,n,r),s===null&&Fd(t,e,r,Nc,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Fd(t,e,r,null,n)}}var Nc=null;function Mh(t,e,n,r){if(Nc=null,t=Yf(r),t=ji(t),t!==null)if(e=ts(t),e===null)t=null;else if(n=e.tag,n===13){if(t=mw(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Nc=t,null}function Nw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(r0()){case Jf:return 1;case vw:return 4;case Ic:case i0:return 16;case _w:return 536870912;default:return 16}default:return 16}}var qr=null,tm=null,nc=null;function xw(){if(nc)return nc;var t,e=tm,n=e.length,r,i="value"in qr?qr.value:qr.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===i[s-r];r++);return nc=i.slice(t,1<r?1-r:void 0)}function rc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function jl(){return!0}function Lg(){return!1}function _n(t){function e(n,r,i,s,a){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?jl:Lg,this.isPropagationStopped=Lg,this}return Ke(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=jl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=jl)},persist:function(){},isPersistent:jl}),e}var sa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nm=_n(sa),zo=Ke({},sa,{view:0,detail:0}),y0=_n(zo),Rd,bd,Pa,yu=Ke({},zo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:rm,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Pa&&(Pa&&t.type==="mousemove"?(Rd=t.screenX-Pa.screenX,bd=t.screenY-Pa.screenY):bd=Rd=0,Pa=t),Rd)},movementY:function(t){return"movementY"in t?t.movementY:bd}}),Fg=_n(yu),v0=Ke({},yu,{dataTransfer:0}),_0=_n(v0),w0=Ke({},zo,{relatedTarget:0}),Dd=_n(w0),E0=Ke({},sa,{animationName:0,elapsedTime:0,pseudoElement:0}),T0=_n(E0),k0=Ke({},sa,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),I0=_n(k0),S0=Ke({},sa,{data:0}),Ug=_n(S0),A0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},N0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},x0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function C0(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=x0[t])?!!e[t]:!1}function rm(){return C0}var R0=Ke({},zo,{key:function(t){if(t.key){var e=A0[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=rc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?N0[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:rm,charCode:function(t){return t.type==="keypress"?rc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?rc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),b0=_n(R0),D0=Ke({},yu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Bg=_n(D0),j0=Ke({},zo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:rm}),P0=_n(j0),O0=Ke({},sa,{propertyName:0,elapsedTime:0,pseudoElement:0}),M0=_n(O0),V0=Ke({},yu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),L0=_n(V0),F0=[9,13,27,32],im=_r&&"CompositionEvent"in window,Ya=null;_r&&"documentMode"in document&&(Ya=document.documentMode);var U0=_r&&"TextEvent"in window&&!Ya,Cw=_r&&(!im||Ya&&8<Ya&&11>=Ya),zg=" ",$g=!1;function Rw(t,e){switch(t){case"keyup":return F0.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function bw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ts=!1;function B0(t,e){switch(t){case"compositionend":return bw(e);case"keypress":return e.which!==32?null:($g=!0,zg);case"textInput":return t=e.data,t===zg&&$g?null:t;default:return null}}function z0(t,e){if(Ts)return t==="compositionend"||!im&&Rw(t,e)?(t=xw(),nc=tm=qr=null,Ts=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Cw&&e.locale!=="ko"?null:e.data;default:return null}}var $0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!$0[t.type]:e==="textarea"}function Dw(t,e,n,r){cw(r),e=xc(e,"onChange"),0<e.length&&(n=new nm("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Ja=null,yo=null;function G0(t){$w(t,0)}function vu(t){var e=Ss(t);if(nw(e))return t}function K0(t,e){if(t==="change")return e}var jw=!1;if(_r){var jd;if(_r){var Pd="oninput"in document;if(!Pd){var Kg=document.createElement("div");Kg.setAttribute("oninput","return;"),Pd=typeof Kg.oninput=="function"}jd=Pd}else jd=!1;jw=jd&&(!document.documentMode||9<document.documentMode)}function qg(){Ja&&(Ja.detachEvent("onpropertychange",Pw),yo=Ja=null)}function Pw(t){if(t.propertyName==="value"&&vu(yo)){var e=[];Dw(e,yo,t,Yf(t)),fw(G0,e)}}function q0(t,e,n){t==="focusin"?(qg(),Ja=e,yo=n,Ja.attachEvent("onpropertychange",Pw)):t==="focusout"&&qg()}function H0(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return vu(yo)}function W0(t,e){if(t==="click")return vu(e)}function Q0(t,e){if(t==="input"||t==="change")return vu(e)}function Y0(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Un=typeof Object.is=="function"?Object.is:Y0;function vo(t,e){if(Un(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!vh.call(e,i)||!Un(t[i],e[i]))return!1}return!0}function Hg(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Wg(t,e){var n=Hg(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Hg(n)}}function Ow(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Ow(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Mw(){for(var t=window,e=Ec();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Ec(t.document)}return e}function sm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function J0(t){var e=Mw(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Ow(n.ownerDocument.documentElement,n)){if(r!==null&&sm(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Wg(n,s);var a=Wg(n,r);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var X0=_r&&"documentMode"in document&&11>=document.documentMode,ks=null,Vh=null,Xa=null,Lh=!1;function Qg(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Lh||ks==null||ks!==Ec(r)||(r=ks,"selectionStart"in r&&sm(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Xa&&vo(Xa,r)||(Xa=r,r=xc(Vh,"onSelect"),0<r.length&&(e=new nm("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ks)))}function Pl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Is={animationend:Pl("Animation","AnimationEnd"),animationiteration:Pl("Animation","AnimationIteration"),animationstart:Pl("Animation","AnimationStart"),transitionend:Pl("Transition","TransitionEnd")},Od={},Vw={};_r&&(Vw=document.createElement("div").style,"AnimationEvent"in window||(delete Is.animationend.animation,delete Is.animationiteration.animation,delete Is.animationstart.animation),"TransitionEvent"in window||delete Is.transitionend.transition);function _u(t){if(Od[t])return Od[t];if(!Is[t])return t;var e=Is[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Vw)return Od[t]=e[n];return t}var Lw=_u("animationend"),Fw=_u("animationiteration"),Uw=_u("animationstart"),Bw=_u("transitionend"),zw=new Map,Yg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function mi(t,e){zw.set(t,e),es(e,[t])}for(var Md=0;Md<Yg.length;Md++){var Vd=Yg[Md],Z0=Vd.toLowerCase(),eA=Vd[0].toUpperCase()+Vd.slice(1);mi(Z0,"on"+eA)}mi(Lw,"onAnimationEnd");mi(Fw,"onAnimationIteration");mi(Uw,"onAnimationStart");mi("dblclick","onDoubleClick");mi("focusin","onFocus");mi("focusout","onBlur");mi(Bw,"onTransitionEnd");$s("onMouseEnter",["mouseout","mouseover"]);$s("onMouseLeave",["mouseout","mouseover"]);$s("onPointerEnter",["pointerout","pointerover"]);$s("onPointerLeave",["pointerout","pointerover"]);es("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));es("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));es("onBeforeInput",["compositionend","keypress","textInput","paste"]);es("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));es("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));es("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ba="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tA=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ba));function Jg(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,ZS(r,e,void 0,t),t.currentTarget=null}function $w(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var a=r.length-1;0<=a;a--){var l=r[a],u=l.instance,d=l.currentTarget;if(l=l.listener,u!==s&&i.isPropagationStopped())break e;Jg(i,l,d),s=u}else for(a=0;a<r.length;a++){if(l=r[a],u=l.instance,d=l.currentTarget,l=l.listener,u!==s&&i.isPropagationStopped())break e;Jg(i,l,d),s=u}}}if(kc)throw t=jh,kc=!1,jh=null,t}function Ve(t,e){var n=e[$h];n===void 0&&(n=e[$h]=new Set);var r=t+"__bubble";n.has(r)||(Gw(e,t,2,!1),n.add(r))}function Ld(t,e,n){var r=0;e&&(r|=4),Gw(n,t,r,e)}var Ol="_reactListening"+Math.random().toString(36).slice(2);function _o(t){if(!t[Ol]){t[Ol]=!0,J_.forEach(function(n){n!=="selectionchange"&&(tA.has(n)||Ld(n,!1,t),Ld(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ol]||(e[Ol]=!0,Ld("selectionchange",!1,e))}}function Gw(t,e,n,r){switch(Nw(e)){case 1:var i=p0;break;case 4:i=g0;break;default:i=em}n=i.bind(null,e,n,t),i=void 0,!Dh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Fd(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;a=a.return}for(;l!==null;){if(a=ji(l),a===null)return;if(u=a.tag,u===5||u===6){r=s=a;continue e}l=l.parentNode}}r=r.return}fw(function(){var d=s,m=Yf(n),p=[];e:{var g=zw.get(t);if(g!==void 0){var k=nm,S=t;switch(t){case"keypress":if(rc(n)===0)break e;case"keydown":case"keyup":k=b0;break;case"focusin":S="focus",k=Dd;break;case"focusout":S="blur",k=Dd;break;case"beforeblur":case"afterblur":k=Dd;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":k=Fg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":k=_0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":k=P0;break;case Lw:case Fw:case Uw:k=T0;break;case Bw:k=M0;break;case"scroll":k=y0;break;case"wheel":k=L0;break;case"copy":case"cut":case"paste":k=I0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":k=Bg}var R=(e&4)!==0,D=!R&&t==="scroll",w=R?g!==null?g+"Capture":null:g;R=[];for(var y=d,I;y!==null;){I=y;var P=I.stateNode;if(I.tag===5&&P!==null&&(I=P,w!==null&&(P=fo(y,w),P!=null&&R.push(wo(y,P,I)))),D)break;y=y.return}0<R.length&&(g=new k(g,S,null,n,m),p.push({event:g,listeners:R}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",k=t==="mouseout"||t==="pointerout",g&&n!==Rh&&(S=n.relatedTarget||n.fromElement)&&(ji(S)||S[wr]))break e;if((k||g)&&(g=m.window===m?m:(g=m.ownerDocument)?g.defaultView||g.parentWindow:window,k?(S=n.relatedTarget||n.toElement,k=d,S=S?ji(S):null,S!==null&&(D=ts(S),S!==D||S.tag!==5&&S.tag!==6)&&(S=null)):(k=null,S=d),k!==S)){if(R=Fg,P="onMouseLeave",w="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(R=Bg,P="onPointerLeave",w="onPointerEnter",y="pointer"),D=k==null?g:Ss(k),I=S==null?g:Ss(S),g=new R(P,y+"leave",k,n,m),g.target=D,g.relatedTarget=I,P=null,ji(m)===d&&(R=new R(w,y+"enter",S,n,m),R.target=I,R.relatedTarget=D,P=R),D=P,k&&S)t:{for(R=k,w=S,y=0,I=R;I;I=ms(I))y++;for(I=0,P=w;P;P=ms(P))I++;for(;0<y-I;)R=ms(R),y--;for(;0<I-y;)w=ms(w),I--;for(;y--;){if(R===w||w!==null&&R===w.alternate)break t;R=ms(R),w=ms(w)}R=null}else R=null;k!==null&&Xg(p,g,k,R,!1),S!==null&&D!==null&&Xg(p,D,S,R,!0)}}e:{if(g=d?Ss(d):window,k=g.nodeName&&g.nodeName.toLowerCase(),k==="select"||k==="input"&&g.type==="file")var F=K0;else if(Gg(g))if(jw)F=Q0;else{F=H0;var B=q0}else(k=g.nodeName)&&k.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(F=W0);if(F&&(F=F(t,d))){Dw(p,F,n,m);break e}B&&B(t,g,d),t==="focusout"&&(B=g._wrapperState)&&B.controlled&&g.type==="number"&&Sh(g,"number",g.value)}switch(B=d?Ss(d):window,t){case"focusin":(Gg(B)||B.contentEditable==="true")&&(ks=B,Vh=d,Xa=null);break;case"focusout":Xa=Vh=ks=null;break;case"mousedown":Lh=!0;break;case"contextmenu":case"mouseup":case"dragend":Lh=!1,Qg(p,n,m);break;case"selectionchange":if(X0)break;case"keydown":case"keyup":Qg(p,n,m)}var N;if(im)e:{switch(t){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else Ts?Rw(t,n)&&(v="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(v="onCompositionStart");v&&(Cw&&n.locale!=="ko"&&(Ts||v!=="onCompositionStart"?v==="onCompositionEnd"&&Ts&&(N=xw()):(qr=m,tm="value"in qr?qr.value:qr.textContent,Ts=!0)),B=xc(d,v),0<B.length&&(v=new Ug(v,t,null,n,m),p.push({event:v,listeners:B}),N?v.data=N:(N=bw(n),N!==null&&(v.data=N)))),(N=U0?B0(t,n):z0(t,n))&&(d=xc(d,"onBeforeInput"),0<d.length&&(m=new Ug("onBeforeInput","beforeinput",null,n,m),p.push({event:m,listeners:d}),m.data=N))}$w(p,e)})}function wo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function xc(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=fo(t,n),s!=null&&r.unshift(wo(t,s,i)),s=fo(t,e),s!=null&&r.push(wo(t,s,i))),t=t.return}return r}function ms(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Xg(t,e,n,r,i){for(var s=e._reactName,a=[];n!==null&&n!==r;){var l=n,u=l.alternate,d=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&d!==null&&(l=d,i?(u=fo(n,s),u!=null&&a.unshift(wo(n,u,l))):i||(u=fo(n,s),u!=null&&a.push(wo(n,u,l)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var nA=/\r\n?/g,rA=/\u0000|\uFFFD/g;function Zg(t){return(typeof t=="string"?t:""+t).replace(nA,`
`).replace(rA,"")}function Ml(t,e,n){if(e=Zg(e),Zg(t)!==e&&n)throw Error(z(425))}function Cc(){}var Fh=null,Uh=null;function Bh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var zh=typeof setTimeout=="function"?setTimeout:void 0,iA=typeof clearTimeout=="function"?clearTimeout:void 0,ey=typeof Promise=="function"?Promise:void 0,sA=typeof queueMicrotask=="function"?queueMicrotask:typeof ey<"u"?function(t){return ey.resolve(null).then(t).catch(aA)}:zh;function aA(t){setTimeout(function(){throw t})}function Ud(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),go(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);go(e)}function Xr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function ty(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var aa=Math.random().toString(36).slice(2),Qn="__reactFiber$"+aa,Eo="__reactProps$"+aa,wr="__reactContainer$"+aa,$h="__reactEvents$"+aa,oA="__reactListeners$"+aa,lA="__reactHandles$"+aa;function ji(t){var e=t[Qn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[wr]||n[Qn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=ty(t);t!==null;){if(n=t[Qn])return n;t=ty(t)}return e}t=n,n=t.parentNode}return null}function $o(t){return t=t[Qn]||t[wr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ss(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(z(33))}function wu(t){return t[Eo]||null}var Gh=[],As=-1;function pi(t){return{current:t}}function Fe(t){0>As||(t.current=Gh[As],Gh[As]=null,As--)}function Pe(t,e){As++,Gh[As]=t.current,t.current=e}var oi={},zt=pi(oi),en=pi(!1),zi=oi;function Gs(t,e){var n=t.type.contextTypes;if(!n)return oi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function tn(t){return t=t.childContextTypes,t!=null}function Rc(){Fe(en),Fe(zt)}function ny(t,e,n){if(zt.current!==oi)throw Error(z(168));Pe(zt,e),Pe(en,n)}function Kw(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(z(108,qS(t)||"Unknown",i));return Ke({},n,r)}function bc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||oi,zi=zt.current,Pe(zt,t),Pe(en,en.current),!0}function ry(t,e,n){var r=t.stateNode;if(!r)throw Error(z(169));n?(t=Kw(t,e,zi),r.__reactInternalMemoizedMergedChildContext=t,Fe(en),Fe(zt),Pe(zt,t)):Fe(en),Pe(en,n)}var ur=null,Eu=!1,Bd=!1;function qw(t){ur===null?ur=[t]:ur.push(t)}function cA(t){Eu=!0,qw(t)}function gi(){if(!Bd&&ur!==null){Bd=!0;var t=0,e=Ne;try{var n=ur;for(Ne=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ur=null,Eu=!1}catch(i){throw ur!==null&&(ur=ur.slice(t+1)),yw(Jf,gi),i}finally{Ne=e,Bd=!1}}return null}var Ns=[],xs=0,Dc=null,jc=0,wn=[],En=0,$i=null,dr=1,hr="";function Ri(t,e){Ns[xs++]=jc,Ns[xs++]=Dc,Dc=t,jc=e}function Hw(t,e,n){wn[En++]=dr,wn[En++]=hr,wn[En++]=$i,$i=t;var r=dr;t=hr;var i=32-Ln(r)-1;r&=~(1<<i),n+=1;var s=32-Ln(e)+i;if(30<s){var a=i-i%5;s=(r&(1<<a)-1).toString(32),r>>=a,i-=a,dr=1<<32-Ln(e)+i|n<<i|r,hr=s+t}else dr=1<<s|n<<i|r,hr=t}function am(t){t.return!==null&&(Ri(t,1),Hw(t,1,0))}function om(t){for(;t===Dc;)Dc=Ns[--xs],Ns[xs]=null,jc=Ns[--xs],Ns[xs]=null;for(;t===$i;)$i=wn[--En],wn[En]=null,hr=wn[--En],wn[En]=null,dr=wn[--En],wn[En]=null}var mn=null,hn=null,Be=!1,Mn=null;function Ww(t,e){var n=kn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function iy(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,mn=t,hn=Xr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,mn=t,hn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=$i!==null?{id:dr,overflow:hr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=kn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,mn=t,hn=null,!0):!1;default:return!1}}function Kh(t){return(t.mode&1)!==0&&(t.flags&128)===0}function qh(t){if(Be){var e=hn;if(e){var n=e;if(!iy(t,e)){if(Kh(t))throw Error(z(418));e=Xr(n.nextSibling);var r=mn;e&&iy(t,e)?Ww(r,n):(t.flags=t.flags&-4097|2,Be=!1,mn=t)}}else{if(Kh(t))throw Error(z(418));t.flags=t.flags&-4097|2,Be=!1,mn=t}}}function sy(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;mn=t}function Vl(t){if(t!==mn)return!1;if(!Be)return sy(t),Be=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Bh(t.type,t.memoizedProps)),e&&(e=hn)){if(Kh(t))throw Qw(),Error(z(418));for(;e;)Ww(t,e),e=Xr(e.nextSibling)}if(sy(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(z(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){hn=Xr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}hn=null}}else hn=mn?Xr(t.stateNode.nextSibling):null;return!0}function Qw(){for(var t=hn;t;)t=Xr(t.nextSibling)}function Ks(){hn=mn=null,Be=!1}function lm(t){Mn===null?Mn=[t]:Mn.push(t)}var uA=Cr.ReactCurrentBatchConfig;function Oa(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(z(309));var r=n.stateNode}if(!r)throw Error(z(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var l=i.refs;a===null?delete l[s]:l[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(z(284));if(!n._owner)throw Error(z(290,t))}return t}function Ll(t,e){throw t=Object.prototype.toString.call(e),Error(z(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function ay(t){var e=t._init;return e(t._payload)}function Yw(t){function e(w,y){if(t){var I=w.deletions;I===null?(w.deletions=[y],w.flags|=16):I.push(y)}}function n(w,y){if(!t)return null;for(;y!==null;)e(w,y),y=y.sibling;return null}function r(w,y){for(w=new Map;y!==null;)y.key!==null?w.set(y.key,y):w.set(y.index,y),y=y.sibling;return w}function i(w,y){return w=ni(w,y),w.index=0,w.sibling=null,w}function s(w,y,I){return w.index=I,t?(I=w.alternate,I!==null?(I=I.index,I<y?(w.flags|=2,y):I):(w.flags|=2,y)):(w.flags|=1048576,y)}function a(w){return t&&w.alternate===null&&(w.flags|=2),w}function l(w,y,I,P){return y===null||y.tag!==6?(y=Wd(I,w.mode,P),y.return=w,y):(y=i(y,I),y.return=w,y)}function u(w,y,I,P){var F=I.type;return F===Es?m(w,y,I.props.children,P,I.key):y!==null&&(y.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===Lr&&ay(F)===y.type)?(P=i(y,I.props),P.ref=Oa(w,y,I),P.return=w,P):(P=uc(I.type,I.key,I.props,null,w.mode,P),P.ref=Oa(w,y,I),P.return=w,P)}function d(w,y,I,P){return y===null||y.tag!==4||y.stateNode.containerInfo!==I.containerInfo||y.stateNode.implementation!==I.implementation?(y=Qd(I,w.mode,P),y.return=w,y):(y=i(y,I.children||[]),y.return=w,y)}function m(w,y,I,P,F){return y===null||y.tag!==7?(y=Fi(I,w.mode,P,F),y.return=w,y):(y=i(y,I),y.return=w,y)}function p(w,y,I){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Wd(""+y,w.mode,I),y.return=w,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Nl:return I=uc(y.type,y.key,y.props,null,w.mode,I),I.ref=Oa(w,null,y),I.return=w,I;case ws:return y=Qd(y,w.mode,I),y.return=w,y;case Lr:var P=y._init;return p(w,P(y._payload),I)}if(Fa(y)||Ra(y))return y=Fi(y,w.mode,I,null),y.return=w,y;Ll(w,y)}return null}function g(w,y,I,P){var F=y!==null?y.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return F!==null?null:l(w,y,""+I,P);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case Nl:return I.key===F?u(w,y,I,P):null;case ws:return I.key===F?d(w,y,I,P):null;case Lr:return F=I._init,g(w,y,F(I._payload),P)}if(Fa(I)||Ra(I))return F!==null?null:m(w,y,I,P,null);Ll(w,I)}return null}function k(w,y,I,P,F){if(typeof P=="string"&&P!==""||typeof P=="number")return w=w.get(I)||null,l(y,w,""+P,F);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case Nl:return w=w.get(P.key===null?I:P.key)||null,u(y,w,P,F);case ws:return w=w.get(P.key===null?I:P.key)||null,d(y,w,P,F);case Lr:var B=P._init;return k(w,y,I,B(P._payload),F)}if(Fa(P)||Ra(P))return w=w.get(I)||null,m(y,w,P,F,null);Ll(y,P)}return null}function S(w,y,I,P){for(var F=null,B=null,N=y,v=y=0,E=null;N!==null&&v<I.length;v++){N.index>v?(E=N,N=null):E=N.sibling;var x=g(w,N,I[v],P);if(x===null){N===null&&(N=E);break}t&&N&&x.alternate===null&&e(w,N),y=s(x,y,v),B===null?F=x:B.sibling=x,B=x,N=E}if(v===I.length)return n(w,N),Be&&Ri(w,v),F;if(N===null){for(;v<I.length;v++)N=p(w,I[v],P),N!==null&&(y=s(N,y,v),B===null?F=N:B.sibling=N,B=N);return Be&&Ri(w,v),F}for(N=r(w,N);v<I.length;v++)E=k(N,w,v,I[v],P),E!==null&&(t&&E.alternate!==null&&N.delete(E.key===null?v:E.key),y=s(E,y,v),B===null?F=E:B.sibling=E,B=E);return t&&N.forEach(function(A){return e(w,A)}),Be&&Ri(w,v),F}function R(w,y,I,P){var F=Ra(I);if(typeof F!="function")throw Error(z(150));if(I=F.call(I),I==null)throw Error(z(151));for(var B=F=null,N=y,v=y=0,E=null,x=I.next();N!==null&&!x.done;v++,x=I.next()){N.index>v?(E=N,N=null):E=N.sibling;var A=g(w,N,x.value,P);if(A===null){N===null&&(N=E);break}t&&N&&A.alternate===null&&e(w,N),y=s(A,y,v),B===null?F=A:B.sibling=A,B=A,N=E}if(x.done)return n(w,N),Be&&Ri(w,v),F;if(N===null){for(;!x.done;v++,x=I.next())x=p(w,x.value,P),x!==null&&(y=s(x,y,v),B===null?F=x:B.sibling=x,B=x);return Be&&Ri(w,v),F}for(N=r(w,N);!x.done;v++,x=I.next())x=k(N,w,v,x.value,P),x!==null&&(t&&x.alternate!==null&&N.delete(x.key===null?v:x.key),y=s(x,y,v),B===null?F=x:B.sibling=x,B=x);return t&&N.forEach(function(b){return e(w,b)}),Be&&Ri(w,v),F}function D(w,y,I,P){if(typeof I=="object"&&I!==null&&I.type===Es&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case Nl:e:{for(var F=I.key,B=y;B!==null;){if(B.key===F){if(F=I.type,F===Es){if(B.tag===7){n(w,B.sibling),y=i(B,I.props.children),y.return=w,w=y;break e}}else if(B.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===Lr&&ay(F)===B.type){n(w,B.sibling),y=i(B,I.props),y.ref=Oa(w,B,I),y.return=w,w=y;break e}n(w,B);break}else e(w,B);B=B.sibling}I.type===Es?(y=Fi(I.props.children,w.mode,P,I.key),y.return=w,w=y):(P=uc(I.type,I.key,I.props,null,w.mode,P),P.ref=Oa(w,y,I),P.return=w,w=P)}return a(w);case ws:e:{for(B=I.key;y!==null;){if(y.key===B)if(y.tag===4&&y.stateNode.containerInfo===I.containerInfo&&y.stateNode.implementation===I.implementation){n(w,y.sibling),y=i(y,I.children||[]),y.return=w,w=y;break e}else{n(w,y);break}else e(w,y);y=y.sibling}y=Qd(I,w.mode,P),y.return=w,w=y}return a(w);case Lr:return B=I._init,D(w,y,B(I._payload),P)}if(Fa(I))return S(w,y,I,P);if(Ra(I))return R(w,y,I,P);Ll(w,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,y!==null&&y.tag===6?(n(w,y.sibling),y=i(y,I),y.return=w,w=y):(n(w,y),y=Wd(I,w.mode,P),y.return=w,w=y),a(w)):n(w,y)}return D}var qs=Yw(!0),Jw=Yw(!1),Pc=pi(null),Oc=null,Cs=null,cm=null;function um(){cm=Cs=Oc=null}function dm(t){var e=Pc.current;Fe(Pc),t._currentValue=e}function Hh(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Vs(t,e){Oc=t,cm=Cs=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Xt=!0),t.firstContext=null)}function An(t){var e=t._currentValue;if(cm!==t)if(t={context:t,memoizedValue:e,next:null},Cs===null){if(Oc===null)throw Error(z(308));Cs=t,Oc.dependencies={lanes:0,firstContext:t}}else Cs=Cs.next=t;return e}var Pi=null;function hm(t){Pi===null?Pi=[t]:Pi.push(t)}function Xw(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,hm(e)):(n.next=i.next,i.next=n),e.interleaved=n,Er(t,r)}function Er(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Fr=!1;function fm(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Zw(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function pr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Zr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ee&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Er(t,n)}return i=r.interleaved,i===null?(e.next=e,hm(r)):(e.next=i.next,i.next=e),r.interleaved=e,Er(t,n)}function ic(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Xf(t,n)}}function oy(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=a:s=s.next=a,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Mc(t,e,n,r){var i=t.updateQueue;Fr=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var u=l,d=u.next;u.next=null,a===null?s=d:a.next=d,a=u;var m=t.alternate;m!==null&&(m=m.updateQueue,l=m.lastBaseUpdate,l!==a&&(l===null?m.firstBaseUpdate=d:l.next=d,m.lastBaseUpdate=u))}if(s!==null){var p=i.baseState;a=0,m=d=u=null,l=s;do{var g=l.lane,k=l.eventTime;if((r&g)===g){m!==null&&(m=m.next={eventTime:k,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var S=t,R=l;switch(g=e,k=n,R.tag){case 1:if(S=R.payload,typeof S=="function"){p=S.call(k,p,g);break e}p=S;break e;case 3:S.flags=S.flags&-65537|128;case 0:if(S=R.payload,g=typeof S=="function"?S.call(k,p,g):S,g==null)break e;p=Ke({},p,g);break e;case 2:Fr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,g=i.effects,g===null?i.effects=[l]:g.push(l))}else k={eventTime:k,lane:g,tag:l.tag,payload:l.payload,callback:l.callback,next:null},m===null?(d=m=k,u=p):m=m.next=k,a|=g;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;g=l,l=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(!0);if(m===null&&(u=p),i.baseState=u,i.firstBaseUpdate=d,i.lastBaseUpdate=m,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Ki|=a,t.lanes=a,t.memoizedState=p}}function ly(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(z(191,i));i.call(r)}}}var Go={},Jn=pi(Go),To=pi(Go),ko=pi(Go);function Oi(t){if(t===Go)throw Error(z(174));return t}function mm(t,e){switch(Pe(ko,e),Pe(To,t),Pe(Jn,Go),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Nh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Nh(e,t)}Fe(Jn),Pe(Jn,e)}function Hs(){Fe(Jn),Fe(To),Fe(ko)}function eE(t){Oi(ko.current);var e=Oi(Jn.current),n=Nh(e,t.type);e!==n&&(Pe(To,t),Pe(Jn,n))}function pm(t){To.current===t&&(Fe(Jn),Fe(To))}var $e=pi(0);function Vc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var zd=[];function gm(){for(var t=0;t<zd.length;t++)zd[t]._workInProgressVersionPrimary=null;zd.length=0}var sc=Cr.ReactCurrentDispatcher,$d=Cr.ReactCurrentBatchConfig,Gi=0,Ge=null,ut=null,pt=null,Lc=!1,Za=!1,Io=0,dA=0;function Pt(){throw Error(z(321))}function ym(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Un(t[n],e[n]))return!1;return!0}function vm(t,e,n,r,i,s){if(Gi=s,Ge=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,sc.current=t===null||t.memoizedState===null?pA:gA,t=n(r,i),Za){s=0;do{if(Za=!1,Io=0,25<=s)throw Error(z(301));s+=1,pt=ut=null,e.updateQueue=null,sc.current=yA,t=n(r,i)}while(Za)}if(sc.current=Fc,e=ut!==null&&ut.next!==null,Gi=0,pt=ut=Ge=null,Lc=!1,e)throw Error(z(300));return t}function _m(){var t=Io!==0;return Io=0,t}function Hn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pt===null?Ge.memoizedState=pt=t:pt=pt.next=t,pt}function Nn(){if(ut===null){var t=Ge.alternate;t=t!==null?t.memoizedState:null}else t=ut.next;var e=pt===null?Ge.memoizedState:pt.next;if(e!==null)pt=e,ut=t;else{if(t===null)throw Error(z(310));ut=t,t={memoizedState:ut.memoizedState,baseState:ut.baseState,baseQueue:ut.baseQueue,queue:ut.queue,next:null},pt===null?Ge.memoizedState=pt=t:pt=pt.next=t}return pt}function So(t,e){return typeof e=="function"?e(t):e}function Gd(t){var e=Nn(),n=e.queue;if(n===null)throw Error(z(311));n.lastRenderedReducer=t;var r=ut,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var l=a=null,u=null,d=s;do{var m=d.lane;if((Gi&m)===m)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var p={lane:m,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(l=u=p,a=r):u=u.next=p,Ge.lanes|=m,Ki|=m}d=d.next}while(d!==null&&d!==s);u===null?a=r:u.next=l,Un(r,e.memoizedState)||(Xt=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,Ge.lanes|=s,Ki|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Kd(t){var e=Nn(),n=e.queue;if(n===null)throw Error(z(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);Un(s,e.memoizedState)||(Xt=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function tE(){}function nE(t,e){var n=Ge,r=Nn(),i=e(),s=!Un(r.memoizedState,i);if(s&&(r.memoizedState=i,Xt=!0),r=r.queue,wm(sE.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||pt!==null&&pt.memoizedState.tag&1){if(n.flags|=2048,Ao(9,iE.bind(null,n,r,i,e),void 0,null),gt===null)throw Error(z(349));Gi&30||rE(n,e,i)}return i}function rE(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ge.updateQueue,e===null?(e={lastEffect:null,stores:null},Ge.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function iE(t,e,n,r){e.value=n,e.getSnapshot=r,aE(e)&&oE(t)}function sE(t,e,n){return n(function(){aE(e)&&oE(t)})}function aE(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Un(t,n)}catch{return!0}}function oE(t){var e=Er(t,1);e!==null&&Fn(e,t,1,-1)}function cy(t){var e=Hn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:So,lastRenderedState:t},e.queue=t,t=t.dispatch=mA.bind(null,Ge,t),[e.memoizedState,t]}function Ao(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ge.updateQueue,e===null?(e={lastEffect:null,stores:null},Ge.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function lE(){return Nn().memoizedState}function ac(t,e,n,r){var i=Hn();Ge.flags|=t,i.memoizedState=Ao(1|e,n,void 0,r===void 0?null:r)}function Tu(t,e,n,r){var i=Nn();r=r===void 0?null:r;var s=void 0;if(ut!==null){var a=ut.memoizedState;if(s=a.destroy,r!==null&&ym(r,a.deps)){i.memoizedState=Ao(e,n,s,r);return}}Ge.flags|=t,i.memoizedState=Ao(1|e,n,s,r)}function uy(t,e){return ac(8390656,8,t,e)}function wm(t,e){return Tu(2048,8,t,e)}function cE(t,e){return Tu(4,2,t,e)}function uE(t,e){return Tu(4,4,t,e)}function dE(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function hE(t,e,n){return n=n!=null?n.concat([t]):null,Tu(4,4,dE.bind(null,e,t),n)}function Em(){}function fE(t,e){var n=Nn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&ym(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function mE(t,e){var n=Nn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&ym(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function pE(t,e,n){return Gi&21?(Un(n,e)||(n=ww(),Ge.lanes|=n,Ki|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Xt=!0),t.memoizedState=n)}function hA(t,e){var n=Ne;Ne=n!==0&&4>n?n:4,t(!0);var r=$d.transition;$d.transition={};try{t(!1),e()}finally{Ne=n,$d.transition=r}}function gE(){return Nn().memoizedState}function fA(t,e,n){var r=ti(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},yE(t))vE(e,n);else if(n=Xw(t,e,n,r),n!==null){var i=Kt();Fn(n,t,r,i),_E(n,e,r)}}function mA(t,e,n){var r=ti(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(yE(t))vE(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,l=s(a,n);if(i.hasEagerState=!0,i.eagerState=l,Un(l,a)){var u=e.interleaved;u===null?(i.next=i,hm(e)):(i.next=u.next,u.next=i),e.interleaved=i;return}}catch{}finally{}n=Xw(t,e,i,r),n!==null&&(i=Kt(),Fn(n,t,r,i),_E(n,e,r))}}function yE(t){var e=t.alternate;return t===Ge||e!==null&&e===Ge}function vE(t,e){Za=Lc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function _E(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Xf(t,n)}}var Fc={readContext:An,useCallback:Pt,useContext:Pt,useEffect:Pt,useImperativeHandle:Pt,useInsertionEffect:Pt,useLayoutEffect:Pt,useMemo:Pt,useReducer:Pt,useRef:Pt,useState:Pt,useDebugValue:Pt,useDeferredValue:Pt,useTransition:Pt,useMutableSource:Pt,useSyncExternalStore:Pt,useId:Pt,unstable_isNewReconciler:!1},pA={readContext:An,useCallback:function(t,e){return Hn().memoizedState=[t,e===void 0?null:e],t},useContext:An,useEffect:uy,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ac(4194308,4,dE.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ac(4194308,4,t,e)},useInsertionEffect:function(t,e){return ac(4,2,t,e)},useMemo:function(t,e){var n=Hn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Hn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=fA.bind(null,Ge,t),[r.memoizedState,t]},useRef:function(t){var e=Hn();return t={current:t},e.memoizedState=t},useState:cy,useDebugValue:Em,useDeferredValue:function(t){return Hn().memoizedState=t},useTransition:function(){var t=cy(!1),e=t[0];return t=hA.bind(null,t[1]),Hn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ge,i=Hn();if(Be){if(n===void 0)throw Error(z(407));n=n()}else{if(n=e(),gt===null)throw Error(z(349));Gi&30||rE(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,uy(sE.bind(null,r,s,t),[t]),r.flags|=2048,Ao(9,iE.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Hn(),e=gt.identifierPrefix;if(Be){var n=hr,r=dr;n=(r&~(1<<32-Ln(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Io++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=dA++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},gA={readContext:An,useCallback:fE,useContext:An,useEffect:wm,useImperativeHandle:hE,useInsertionEffect:cE,useLayoutEffect:uE,useMemo:mE,useReducer:Gd,useRef:lE,useState:function(){return Gd(So)},useDebugValue:Em,useDeferredValue:function(t){var e=Nn();return pE(e,ut.memoizedState,t)},useTransition:function(){var t=Gd(So)[0],e=Nn().memoizedState;return[t,e]},useMutableSource:tE,useSyncExternalStore:nE,useId:gE,unstable_isNewReconciler:!1},yA={readContext:An,useCallback:fE,useContext:An,useEffect:wm,useImperativeHandle:hE,useInsertionEffect:cE,useLayoutEffect:uE,useMemo:mE,useReducer:Kd,useRef:lE,useState:function(){return Kd(So)},useDebugValue:Em,useDeferredValue:function(t){var e=Nn();return ut===null?e.memoizedState=t:pE(e,ut.memoizedState,t)},useTransition:function(){var t=Kd(So)[0],e=Nn().memoizedState;return[t,e]},useMutableSource:tE,useSyncExternalStore:nE,useId:gE,unstable_isNewReconciler:!1};function Pn(t,e){if(t&&t.defaultProps){e=Ke({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Wh(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ke({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var ku={isMounted:function(t){return(t=t._reactInternals)?ts(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Kt(),i=ti(t),s=pr(r,i);s.payload=e,n!=null&&(s.callback=n),e=Zr(t,s,i),e!==null&&(Fn(e,t,i,r),ic(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Kt(),i=ti(t),s=pr(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Zr(t,s,i),e!==null&&(Fn(e,t,i,r),ic(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Kt(),r=ti(t),i=pr(n,r);i.tag=2,e!=null&&(i.callback=e),e=Zr(t,i,r),e!==null&&(Fn(e,t,r,n),ic(e,t,r))}};function dy(t,e,n,r,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,a):e.prototype&&e.prototype.isPureReactComponent?!vo(n,r)||!vo(i,s):!0}function wE(t,e,n){var r=!1,i=oi,s=e.contextType;return typeof s=="object"&&s!==null?s=An(s):(i=tn(e)?zi:zt.current,r=e.contextTypes,s=(r=r!=null)?Gs(t,i):oi),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ku,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function hy(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&ku.enqueueReplaceState(e,e.state,null)}function Qh(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},fm(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=An(s):(s=tn(e)?zi:zt.current,i.context=Gs(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Wh(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&ku.enqueueReplaceState(i,i.state,null),Mc(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Ws(t,e){try{var n="",r=e;do n+=KS(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function qd(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Yh(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var vA=typeof WeakMap=="function"?WeakMap:Map;function EE(t,e,n){n=pr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Bc||(Bc=!0,of=r),Yh(t,e)},n}function TE(t,e,n){n=pr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Yh(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Yh(t,e),typeof r!="function"&&(ei===null?ei=new Set([this]):ei.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function fy(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new vA;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=DA.bind(null,t,e,n),e.then(t,t))}function my(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function py(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=pr(-1,1),e.tag=2,Zr(n,e,1))),n.lanes|=1),t)}var _A=Cr.ReactCurrentOwner,Xt=!1;function Gt(t,e,n,r){e.child=t===null?Jw(e,null,n,r):qs(e,t.child,n,r)}function gy(t,e,n,r,i){n=n.render;var s=e.ref;return Vs(e,i),r=vm(t,e,n,r,s,i),n=_m(),t!==null&&!Xt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Tr(t,e,i)):(Be&&n&&am(e),e.flags|=1,Gt(t,e,r,i),e.child)}function yy(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Cm(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,kE(t,e,s,r,i)):(t=uc(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(n=n.compare,n=n!==null?n:vo,n(a,r)&&t.ref===e.ref)return Tr(t,e,i)}return e.flags|=1,t=ni(s,r),t.ref=e.ref,t.return=e,e.child=t}function kE(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(vo(s,r)&&t.ref===e.ref)if(Xt=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Xt=!0);else return e.lanes=t.lanes,Tr(t,e,i)}return Jh(t,e,n,r,i)}function IE(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pe(bs,un),un|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Pe(bs,un),un|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Pe(bs,un),un|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Pe(bs,un),un|=r;return Gt(t,e,i,n),e.child}function SE(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Jh(t,e,n,r,i){var s=tn(n)?zi:zt.current;return s=Gs(e,s),Vs(e,i),n=vm(t,e,n,r,s,i),r=_m(),t!==null&&!Xt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Tr(t,e,i)):(Be&&r&&am(e),e.flags|=1,Gt(t,e,n,i),e.child)}function vy(t,e,n,r,i){if(tn(n)){var s=!0;bc(e)}else s=!1;if(Vs(e,i),e.stateNode===null)oc(t,e),wE(e,n,r),Qh(e,n,r,i),r=!0;else if(t===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var u=a.context,d=n.contextType;typeof d=="object"&&d!==null?d=An(d):(d=tn(n)?zi:zt.current,d=Gs(e,d));var m=n.getDerivedStateFromProps,p=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function";p||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||u!==d)&&hy(e,a,r,d),Fr=!1;var g=e.memoizedState;a.state=g,Mc(e,r,a,i),u=e.memoizedState,l!==r||g!==u||en.current||Fr?(typeof m=="function"&&(Wh(e,n,m,r),u=e.memoizedState),(l=Fr||dy(e,n,l,r,g,u,d))?(p||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),a.props=r,a.state=u,a.context=d,r=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,Zw(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:Pn(e.type,l),a.props=d,p=e.pendingProps,g=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=An(u):(u=tn(n)?zi:zt.current,u=Gs(e,u));var k=n.getDerivedStateFromProps;(m=typeof k=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==p||g!==u)&&hy(e,a,r,u),Fr=!1,g=e.memoizedState,a.state=g,Mc(e,r,a,i);var S=e.memoizedState;l!==p||g!==S||en.current||Fr?(typeof k=="function"&&(Wh(e,n,k,r),S=e.memoizedState),(d=Fr||dy(e,n,d,r,g,S,u)||!1)?(m||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,S,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,S,u)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=S),a.props=r,a.state=S,a.context=u,r=d):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return Xh(t,e,n,r,s,i)}function Xh(t,e,n,r,i,s){SE(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return i&&ry(e,n,!1),Tr(t,e,s);r=e.stateNode,_A.current=e;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=qs(e,t.child,null,s),e.child=qs(e,null,l,s)):Gt(t,e,l,s),e.memoizedState=r.state,i&&ry(e,n,!0),e.child}function AE(t){var e=t.stateNode;e.pendingContext?ny(t,e.pendingContext,e.pendingContext!==e.context):e.context&&ny(t,e.context,!1),mm(t,e.containerInfo)}function _y(t,e,n,r,i){return Ks(),lm(i),e.flags|=256,Gt(t,e,n,r),e.child}var Zh={dehydrated:null,treeContext:null,retryLane:0};function ef(t){return{baseLanes:t,cachePool:null,transitions:null}}function NE(t,e,n){var r=e.pendingProps,i=$e.current,s=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Pe($e,i&1),t===null)return qh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,s?(r=e.mode,s=e.child,a={mode:"hidden",children:a},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=Au(a,r,0,null),t=Fi(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=ef(n),e.memoizedState=Zh,t):Tm(e,a));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return wA(t,e,a,r,l,i,n);if(s){s=r.fallback,a=e.mode,i=t.child,l=i.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=ni(i,u),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=ni(l,s):(s=Fi(s,a,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,a=t.child.memoizedState,a=a===null?ef(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~n,e.memoizedState=Zh,r}return s=t.child,t=s.sibling,r=ni(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Tm(t,e){return e=Au({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Fl(t,e,n,r){return r!==null&&lm(r),qs(e,t.child,null,n),t=Tm(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function wA(t,e,n,r,i,s,a){if(n)return e.flags&256?(e.flags&=-257,r=qd(Error(z(422))),Fl(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Au({mode:"visible",children:r.children},i,0,null),s=Fi(s,i,a,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&qs(e,t.child,null,a),e.child.memoizedState=ef(a),e.memoizedState=Zh,s);if(!(e.mode&1))return Fl(t,e,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(z(419)),r=qd(s,r,void 0),Fl(t,e,a,r)}if(l=(a&t.childLanes)!==0,Xt||l){if(r=gt,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Er(t,i),Fn(r,t,i,-1))}return xm(),r=qd(Error(z(421))),Fl(t,e,a,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=jA.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,hn=Xr(i.nextSibling),mn=e,Be=!0,Mn=null,t!==null&&(wn[En++]=dr,wn[En++]=hr,wn[En++]=$i,dr=t.id,hr=t.overflow,$i=e),e=Tm(e,r.children),e.flags|=4096,e)}function wy(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Hh(t.return,e,n)}function Hd(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function xE(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Gt(t,e,r.children,n),r=$e.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&wy(t,n,e);else if(t.tag===19)wy(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Pe($e,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Vc(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Hd(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Vc(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Hd(e,!0,n,null,s);break;case"together":Hd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function oc(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Tr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ki|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(z(153));if(e.child!==null){for(t=e.child,n=ni(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ni(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function EA(t,e,n){switch(e.tag){case 3:AE(e),Ks();break;case 5:eE(e);break;case 1:tn(e.type)&&bc(e);break;case 4:mm(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Pe(Pc,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Pe($e,$e.current&1),e.flags|=128,null):n&e.child.childLanes?NE(t,e,n):(Pe($e,$e.current&1),t=Tr(t,e,n),t!==null?t.sibling:null);Pe($e,$e.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return xE(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Pe($e,$e.current),r)break;return null;case 22:case 23:return e.lanes=0,IE(t,e,n)}return Tr(t,e,n)}var CE,tf,RE,bE;CE=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};tf=function(){};RE=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Oi(Jn.current);var s=null;switch(n){case"input":i=kh(t,i),r=kh(t,r),s=[];break;case"select":i=Ke({},i,{value:void 0}),r=Ke({},r,{value:void 0}),s=[];break;case"textarea":i=Ah(t,i),r=Ah(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Cc)}xh(n,r);var a;n=null;for(d in i)if(!r.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var l=i[d];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(uo.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in r){var u=r[d];if(l=i!=null?i[d]:void 0,r.hasOwnProperty(d)&&u!==l&&(u!=null||l!=null))if(d==="style")if(l){for(a in l)!l.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&l[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(s||(s=[]),s.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(s=s||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(s=s||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(uo.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&Ve("scroll",t),s||l===u||(s=[])):(s=s||[]).push(d,u))}n&&(s=s||[]).push("style",n);var d=s;(e.updateQueue=d)&&(e.flags|=4)}};bE=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ma(t,e){if(!Be)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ot(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function TA(t,e,n){var r=e.pendingProps;switch(om(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ot(e),null;case 1:return tn(e.type)&&Rc(),Ot(e),null;case 3:return r=e.stateNode,Hs(),Fe(en),Fe(zt),gm(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Vl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Mn!==null&&(uf(Mn),Mn=null))),tf(t,e),Ot(e),null;case 5:pm(e);var i=Oi(ko.current);if(n=e.type,t!==null&&e.stateNode!=null)RE(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(z(166));return Ot(e),null}if(t=Oi(Jn.current),Vl(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Qn]=e,r[Eo]=s,t=(e.mode&1)!==0,n){case"dialog":Ve("cancel",r),Ve("close",r);break;case"iframe":case"object":case"embed":Ve("load",r);break;case"video":case"audio":for(i=0;i<Ba.length;i++)Ve(Ba[i],r);break;case"source":Ve("error",r);break;case"img":case"image":case"link":Ve("error",r),Ve("load",r);break;case"details":Ve("toggle",r);break;case"input":Cg(r,s),Ve("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ve("invalid",r);break;case"textarea":bg(r,s),Ve("invalid",r)}xh(n,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var l=s[a];a==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&Ml(r.textContent,l,t),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&Ml(r.textContent,l,t),i=["children",""+l]):uo.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Ve("scroll",r)}switch(n){case"input":xl(r),Rg(r,s,!0);break;case"textarea":xl(r),Dg(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Cc)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=sw(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Qn]=e,t[Eo]=r,CE(t,e,!1,!1),e.stateNode=t;e:{switch(a=Ch(n,r),n){case"dialog":Ve("cancel",t),Ve("close",t),i=r;break;case"iframe":case"object":case"embed":Ve("load",t),i=r;break;case"video":case"audio":for(i=0;i<Ba.length;i++)Ve(Ba[i],t);i=r;break;case"source":Ve("error",t),i=r;break;case"img":case"image":case"link":Ve("error",t),Ve("load",t),i=r;break;case"details":Ve("toggle",t),i=r;break;case"input":Cg(t,r),i=kh(t,r),Ve("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Ke({},r,{value:void 0}),Ve("invalid",t);break;case"textarea":bg(t,r),i=Ah(t,r),Ve("invalid",t);break;default:i=r}xh(n,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var u=l[s];s==="style"?lw(t,u):s==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&aw(t,u)):s==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&ho(t,u):typeof u=="number"&&ho(t,""+u):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(uo.hasOwnProperty(s)?u!=null&&s==="onScroll"&&Ve("scroll",t):u!=null&&qf(t,s,u,a))}switch(n){case"input":xl(t),Rg(t,r,!1);break;case"textarea":xl(t),Dg(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ai(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?js(t,!!r.multiple,s,!1):r.defaultValue!=null&&js(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Cc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ot(e),null;case 6:if(t&&e.stateNode!=null)bE(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(z(166));if(n=Oi(ko.current),Oi(Jn.current),Vl(e)){if(r=e.stateNode,n=e.memoizedProps,r[Qn]=e,(s=r.nodeValue!==n)&&(t=mn,t!==null))switch(t.tag){case 3:Ml(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ml(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Qn]=e,e.stateNode=r}return Ot(e),null;case 13:if(Fe($e),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Be&&hn!==null&&e.mode&1&&!(e.flags&128))Qw(),Ks(),e.flags|=98560,s=!1;else if(s=Vl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(z(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(z(317));s[Qn]=e}else Ks(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ot(e),s=!1}else Mn!==null&&(uf(Mn),Mn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||$e.current&1?dt===0&&(dt=3):xm())),e.updateQueue!==null&&(e.flags|=4),Ot(e),null);case 4:return Hs(),tf(t,e),t===null&&_o(e.stateNode.containerInfo),Ot(e),null;case 10:return dm(e.type._context),Ot(e),null;case 17:return tn(e.type)&&Rc(),Ot(e),null;case 19:if(Fe($e),s=e.memoizedState,s===null)return Ot(e),null;if(r=(e.flags&128)!==0,a=s.rendering,a===null)if(r)Ma(s,!1);else{if(dt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Vc(t),a!==null){for(e.flags|=128,Ma(s,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Pe($e,$e.current&1|2),e.child}t=t.sibling}s.tail!==null&&et()>Qs&&(e.flags|=128,r=!0,Ma(s,!1),e.lanes=4194304)}else{if(!r)if(t=Vc(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ma(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Be)return Ot(e),null}else 2*et()-s.renderingStartTime>Qs&&n!==1073741824&&(e.flags|=128,r=!0,Ma(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(n=s.last,n!==null?n.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=et(),e.sibling=null,n=$e.current,Pe($e,r?n&1|2:n&1),e):(Ot(e),null);case 22:case 23:return Nm(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?un&1073741824&&(Ot(e),e.subtreeFlags&6&&(e.flags|=8192)):Ot(e),null;case 24:return null;case 25:return null}throw Error(z(156,e.tag))}function kA(t,e){switch(om(e),e.tag){case 1:return tn(e.type)&&Rc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Hs(),Fe(en),Fe(zt),gm(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return pm(e),null;case 13:if(Fe($e),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(z(340));Ks()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Fe($e),null;case 4:return Hs(),null;case 10:return dm(e.type._context),null;case 22:case 23:return Nm(),null;case 24:return null;default:return null}}var Ul=!1,Lt=!1,IA=typeof WeakSet=="function"?WeakSet:Set,Q=null;function Rs(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){We(t,e,r)}else n.current=null}function nf(t,e,n){try{n()}catch(r){We(t,e,r)}}var Ey=!1;function SA(t,e){if(Fh=Ac,t=Mw(),sm(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var a=0,l=-1,u=-1,d=0,m=0,p=t,g=null;t:for(;;){for(var k;p!==n||i!==0&&p.nodeType!==3||(l=a+i),p!==s||r!==0&&p.nodeType!==3||(u=a+r),p.nodeType===3&&(a+=p.nodeValue.length),(k=p.firstChild)!==null;)g=p,p=k;for(;;){if(p===t)break t;if(g===n&&++d===i&&(l=a),g===s&&++m===r&&(u=a),(k=p.nextSibling)!==null)break;p=g,g=p.parentNode}p=k}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Uh={focusedElem:t,selectionRange:n},Ac=!1,Q=e;Q!==null;)if(e=Q,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Q=t;else for(;Q!==null;){e=Q;try{var S=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(S!==null){var R=S.memoizedProps,D=S.memoizedState,w=e.stateNode,y=w.getSnapshotBeforeUpdate(e.elementType===e.type?R:Pn(e.type,R),D);w.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var I=e.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(z(163))}}catch(P){We(e,e.return,P)}if(t=e.sibling,t!==null){t.return=e.return,Q=t;break}Q=e.return}return S=Ey,Ey=!1,S}function eo(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&nf(e,n,s)}i=i.next}while(i!==r)}}function Iu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function rf(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function DE(t){var e=t.alternate;e!==null&&(t.alternate=null,DE(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Qn],delete e[Eo],delete e[$h],delete e[oA],delete e[lA])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function jE(t){return t.tag===5||t.tag===3||t.tag===4}function Ty(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||jE(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function sf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Cc));else if(r!==4&&(t=t.child,t!==null))for(sf(t,e,n),t=t.sibling;t!==null;)sf(t,e,n),t=t.sibling}function af(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(af(t,e,n),t=t.sibling;t!==null;)af(t,e,n),t=t.sibling}var wt=null,On=!1;function Mr(t,e,n){for(n=n.child;n!==null;)PE(t,e,n),n=n.sibling}function PE(t,e,n){if(Yn&&typeof Yn.onCommitFiberUnmount=="function")try{Yn.onCommitFiberUnmount(gu,n)}catch{}switch(n.tag){case 5:Lt||Rs(n,e);case 6:var r=wt,i=On;wt=null,Mr(t,e,n),wt=r,On=i,wt!==null&&(On?(t=wt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):wt.removeChild(n.stateNode));break;case 18:wt!==null&&(On?(t=wt,n=n.stateNode,t.nodeType===8?Ud(t.parentNode,n):t.nodeType===1&&Ud(t,n),go(t)):Ud(wt,n.stateNode));break;case 4:r=wt,i=On,wt=n.stateNode.containerInfo,On=!0,Mr(t,e,n),wt=r,On=i;break;case 0:case 11:case 14:case 15:if(!Lt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&nf(n,e,a),i=i.next}while(i!==r)}Mr(t,e,n);break;case 1:if(!Lt&&(Rs(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){We(n,e,l)}Mr(t,e,n);break;case 21:Mr(t,e,n);break;case 22:n.mode&1?(Lt=(r=Lt)||n.memoizedState!==null,Mr(t,e,n),Lt=r):Mr(t,e,n);break;default:Mr(t,e,n)}}function ky(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new IA),e.forEach(function(r){var i=PA.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function jn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:wt=l.stateNode,On=!1;break e;case 3:wt=l.stateNode.containerInfo,On=!0;break e;case 4:wt=l.stateNode.containerInfo,On=!0;break e}l=l.return}if(wt===null)throw Error(z(160));PE(s,a,i),wt=null,On=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(d){We(i,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)OE(e,t),e=e.sibling}function OE(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(jn(e,t),qn(t),r&4){try{eo(3,t,t.return),Iu(3,t)}catch(R){We(t,t.return,R)}try{eo(5,t,t.return)}catch(R){We(t,t.return,R)}}break;case 1:jn(e,t),qn(t),r&512&&n!==null&&Rs(n,n.return);break;case 5:if(jn(e,t),qn(t),r&512&&n!==null&&Rs(n,n.return),t.flags&32){var i=t.stateNode;try{ho(i,"")}catch(R){We(t,t.return,R)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=n!==null?n.memoizedProps:s,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&rw(i,s),Ch(l,a);var d=Ch(l,s);for(a=0;a<u.length;a+=2){var m=u[a],p=u[a+1];m==="style"?lw(i,p):m==="dangerouslySetInnerHTML"?aw(i,p):m==="children"?ho(i,p):qf(i,m,p,d)}switch(l){case"input":Ih(i,s);break;case"textarea":iw(i,s);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var k=s.value;k!=null?js(i,!!s.multiple,k,!1):g!==!!s.multiple&&(s.defaultValue!=null?js(i,!!s.multiple,s.defaultValue,!0):js(i,!!s.multiple,s.multiple?[]:"",!1))}i[Eo]=s}catch(R){We(t,t.return,R)}}break;case 6:if(jn(e,t),qn(t),r&4){if(t.stateNode===null)throw Error(z(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(R){We(t,t.return,R)}}break;case 3:if(jn(e,t),qn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{go(e.containerInfo)}catch(R){We(t,t.return,R)}break;case 4:jn(e,t),qn(t);break;case 13:jn(e,t),qn(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Sm=et())),r&4&&ky(t);break;case 22:if(m=n!==null&&n.memoizedState!==null,t.mode&1?(Lt=(d=Lt)||m,jn(e,t),Lt=d):jn(e,t),qn(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!m&&t.mode&1)for(Q=t,m=t.child;m!==null;){for(p=Q=m;Q!==null;){switch(g=Q,k=g.child,g.tag){case 0:case 11:case 14:case 15:eo(4,g,g.return);break;case 1:Rs(g,g.return);var S=g.stateNode;if(typeof S.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,S.props=e.memoizedProps,S.state=e.memoizedState,S.componentWillUnmount()}catch(R){We(r,n,R)}}break;case 5:Rs(g,g.return);break;case 22:if(g.memoizedState!==null){Sy(p);continue}}k!==null?(k.return=g,Q=k):Sy(p)}m=m.sibling}e:for(m=null,p=t;;){if(p.tag===5){if(m===null){m=p;try{i=p.stateNode,d?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=p.stateNode,u=p.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=ow("display",a))}catch(R){We(t,t.return,R)}}}else if(p.tag===6){if(m===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(R){We(t,t.return,R)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;m===p&&(m=null),p=p.return}m===p&&(m=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:jn(e,t),qn(t),r&4&&ky(t);break;case 21:break;default:jn(e,t),qn(t)}}function qn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(jE(n)){var r=n;break e}n=n.return}throw Error(z(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(ho(i,""),r.flags&=-33);var s=Ty(t);af(t,s,i);break;case 3:case 4:var a=r.stateNode.containerInfo,l=Ty(t);sf(t,l,a);break;default:throw Error(z(161))}}catch(u){We(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function AA(t,e,n){Q=t,ME(t)}function ME(t,e,n){for(var r=(t.mode&1)!==0;Q!==null;){var i=Q,s=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||Ul;if(!a){var l=i.alternate,u=l!==null&&l.memoizedState!==null||Lt;l=Ul;var d=Lt;if(Ul=a,(Lt=u)&&!d)for(Q=i;Q!==null;)a=Q,u=a.child,a.tag===22&&a.memoizedState!==null?Ay(i):u!==null?(u.return=a,Q=u):Ay(i);for(;s!==null;)Q=s,ME(s),s=s.sibling;Q=i,Ul=l,Lt=d}Iy(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Q=s):Iy(t)}}function Iy(t){for(;Q!==null;){var e=Q;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Lt||Iu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Lt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Pn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&ly(e,s,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}ly(e,a,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var m=d.memoizedState;if(m!==null){var p=m.dehydrated;p!==null&&go(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(z(163))}Lt||e.flags&512&&rf(e)}catch(g){We(e,e.return,g)}}if(e===t){Q=null;break}if(n=e.sibling,n!==null){n.return=e.return,Q=n;break}Q=e.return}}function Sy(t){for(;Q!==null;){var e=Q;if(e===t){Q=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Q=n;break}Q=e.return}}function Ay(t){for(;Q!==null;){var e=Q;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Iu(4,e)}catch(u){We(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(u){We(e,i,u)}}var s=e.return;try{rf(e)}catch(u){We(e,s,u)}break;case 5:var a=e.return;try{rf(e)}catch(u){We(e,a,u)}}}catch(u){We(e,e.return,u)}if(e===t){Q=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Q=l;break}Q=e.return}}var NA=Math.ceil,Uc=Cr.ReactCurrentDispatcher,km=Cr.ReactCurrentOwner,In=Cr.ReactCurrentBatchConfig,Ee=0,gt=null,rt=null,kt=0,un=0,bs=pi(0),dt=0,No=null,Ki=0,Su=0,Im=0,to=null,Yt=null,Sm=0,Qs=1/0,lr=null,Bc=!1,of=null,ei=null,Bl=!1,Hr=null,zc=0,no=0,lf=null,lc=-1,cc=0;function Kt(){return Ee&6?et():lc!==-1?lc:lc=et()}function ti(t){return t.mode&1?Ee&2&&kt!==0?kt&-kt:uA.transition!==null?(cc===0&&(cc=ww()),cc):(t=Ne,t!==0||(t=window.event,t=t===void 0?16:Nw(t.type)),t):1}function Fn(t,e,n,r){if(50<no)throw no=0,lf=null,Error(z(185));Bo(t,n,r),(!(Ee&2)||t!==gt)&&(t===gt&&(!(Ee&2)&&(Su|=n),dt===4&&Br(t,kt)),nn(t,r),n===1&&Ee===0&&!(e.mode&1)&&(Qs=et()+500,Eu&&gi()))}function nn(t,e){var n=t.callbackNode;u0(t,e);var r=Sc(t,t===gt?kt:0);if(r===0)n!==null&&Og(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Og(n),e===1)t.tag===0?cA(Ny.bind(null,t)):qw(Ny.bind(null,t)),sA(function(){!(Ee&6)&&gi()}),n=null;else{switch(Ew(r)){case 1:n=Jf;break;case 4:n=vw;break;case 16:n=Ic;break;case 536870912:n=_w;break;default:n=Ic}n=GE(n,VE.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function VE(t,e){if(lc=-1,cc=0,Ee&6)throw Error(z(327));var n=t.callbackNode;if(Ls()&&t.callbackNode!==n)return null;var r=Sc(t,t===gt?kt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=$c(t,r);else{e=r;var i=Ee;Ee|=2;var s=FE();(gt!==t||kt!==e)&&(lr=null,Qs=et()+500,Li(t,e));do try{RA();break}catch(l){LE(t,l)}while(!0);um(),Uc.current=s,Ee=i,rt!==null?e=0:(gt=null,kt=0,e=dt)}if(e!==0){if(e===2&&(i=Ph(t),i!==0&&(r=i,e=cf(t,i))),e===1)throw n=No,Li(t,0),Br(t,r),nn(t,et()),n;if(e===6)Br(t,r);else{if(i=t.current.alternate,!(r&30)&&!xA(i)&&(e=$c(t,r),e===2&&(s=Ph(t),s!==0&&(r=s,e=cf(t,s))),e===1))throw n=No,Li(t,0),Br(t,r),nn(t,et()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(z(345));case 2:bi(t,Yt,lr);break;case 3:if(Br(t,r),(r&130023424)===r&&(e=Sm+500-et(),10<e)){if(Sc(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Kt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=zh(bi.bind(null,t,Yt,lr),e);break}bi(t,Yt,lr);break;case 4:if(Br(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var a=31-Ln(r);s=1<<a,a=e[a],a>i&&(i=a),r&=~s}if(r=i,r=et()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*NA(r/1960))-r,10<r){t.timeoutHandle=zh(bi.bind(null,t,Yt,lr),r);break}bi(t,Yt,lr);break;case 5:bi(t,Yt,lr);break;default:throw Error(z(329))}}}return nn(t,et()),t.callbackNode===n?VE.bind(null,t):null}function cf(t,e){var n=to;return t.current.memoizedState.isDehydrated&&(Li(t,e).flags|=256),t=$c(t,e),t!==2&&(e=Yt,Yt=n,e!==null&&uf(e)),t}function uf(t){Yt===null?Yt=t:Yt.push.apply(Yt,t)}function xA(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Un(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Br(t,e){for(e&=~Im,e&=~Su,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ln(e),r=1<<n;t[n]=-1,e&=~r}}function Ny(t){if(Ee&6)throw Error(z(327));Ls();var e=Sc(t,0);if(!(e&1))return nn(t,et()),null;var n=$c(t,e);if(t.tag!==0&&n===2){var r=Ph(t);r!==0&&(e=r,n=cf(t,r))}if(n===1)throw n=No,Li(t,0),Br(t,e),nn(t,et()),n;if(n===6)throw Error(z(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,bi(t,Yt,lr),nn(t,et()),null}function Am(t,e){var n=Ee;Ee|=1;try{return t(e)}finally{Ee=n,Ee===0&&(Qs=et()+500,Eu&&gi())}}function qi(t){Hr!==null&&Hr.tag===0&&!(Ee&6)&&Ls();var e=Ee;Ee|=1;var n=In.transition,r=Ne;try{if(In.transition=null,Ne=1,t)return t()}finally{Ne=r,In.transition=n,Ee=e,!(Ee&6)&&gi()}}function Nm(){un=bs.current,Fe(bs)}function Li(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,iA(n)),rt!==null)for(n=rt.return;n!==null;){var r=n;switch(om(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Rc();break;case 3:Hs(),Fe(en),Fe(zt),gm();break;case 5:pm(r);break;case 4:Hs();break;case 13:Fe($e);break;case 19:Fe($e);break;case 10:dm(r.type._context);break;case 22:case 23:Nm()}n=n.return}if(gt=t,rt=t=ni(t.current,null),kt=un=e,dt=0,No=null,Im=Su=Ki=0,Yt=to=null,Pi!==null){for(e=0;e<Pi.length;e++)if(n=Pi[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var a=s.next;s.next=i,r.next=a}n.pending=r}Pi=null}return t}function LE(t,e){do{var n=rt;try{if(um(),sc.current=Fc,Lc){for(var r=Ge.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Lc=!1}if(Gi=0,pt=ut=Ge=null,Za=!1,Io=0,km.current=null,n===null||n.return===null){dt=1,No=e,rt=null;break}e:{var s=t,a=n.return,l=n,u=e;if(e=kt,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,m=l,p=m.tag;if(!(m.mode&1)&&(p===0||p===11||p===15)){var g=m.alternate;g?(m.updateQueue=g.updateQueue,m.memoizedState=g.memoizedState,m.lanes=g.lanes):(m.updateQueue=null,m.memoizedState=null)}var k=my(a);if(k!==null){k.flags&=-257,py(k,a,l,s,e),k.mode&1&&fy(s,d,e),e=k,u=d;var S=e.updateQueue;if(S===null){var R=new Set;R.add(u),e.updateQueue=R}else S.add(u);break e}else{if(!(e&1)){fy(s,d,e),xm();break e}u=Error(z(426))}}else if(Be&&l.mode&1){var D=my(a);if(D!==null){!(D.flags&65536)&&(D.flags|=256),py(D,a,l,s,e),lm(Ws(u,l));break e}}s=u=Ws(u,l),dt!==4&&(dt=2),to===null?to=[s]:to.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var w=EE(s,u,e);oy(s,w);break e;case 1:l=u;var y=s.type,I=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(ei===null||!ei.has(I)))){s.flags|=65536,e&=-e,s.lanes|=e;var P=TE(s,l,e);oy(s,P);break e}}s=s.return}while(s!==null)}BE(n)}catch(F){e=F,rt===n&&n!==null&&(rt=n=n.return);continue}break}while(!0)}function FE(){var t=Uc.current;return Uc.current=Fc,t===null?Fc:t}function xm(){(dt===0||dt===3||dt===2)&&(dt=4),gt===null||!(Ki&268435455)&&!(Su&268435455)||Br(gt,kt)}function $c(t,e){var n=Ee;Ee|=2;var r=FE();(gt!==t||kt!==e)&&(lr=null,Li(t,e));do try{CA();break}catch(i){LE(t,i)}while(!0);if(um(),Ee=n,Uc.current=r,rt!==null)throw Error(z(261));return gt=null,kt=0,dt}function CA(){for(;rt!==null;)UE(rt)}function RA(){for(;rt!==null&&!t0();)UE(rt)}function UE(t){var e=$E(t.alternate,t,un);t.memoizedProps=t.pendingProps,e===null?BE(t):rt=e,km.current=null}function BE(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=kA(n,e),n!==null){n.flags&=32767,rt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{dt=6,rt=null;return}}else if(n=TA(n,e,un),n!==null){rt=n;return}if(e=e.sibling,e!==null){rt=e;return}rt=e=t}while(e!==null);dt===0&&(dt=5)}function bi(t,e,n){var r=Ne,i=In.transition;try{In.transition=null,Ne=1,bA(t,e,n,r)}finally{In.transition=i,Ne=r}return null}function bA(t,e,n,r){do Ls();while(Hr!==null);if(Ee&6)throw Error(z(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(z(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(d0(t,s),t===gt&&(rt=gt=null,kt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Bl||(Bl=!0,GE(Ic,function(){return Ls(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=In.transition,In.transition=null;var a=Ne;Ne=1;var l=Ee;Ee|=4,km.current=null,SA(t,n),OE(n,t),J0(Uh),Ac=!!Fh,Uh=Fh=null,t.current=n,AA(n),n0(),Ee=l,Ne=a,In.transition=s}else t.current=n;if(Bl&&(Bl=!1,Hr=t,zc=i),s=t.pendingLanes,s===0&&(ei=null),s0(n.stateNode),nn(t,et()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Bc)throw Bc=!1,t=of,of=null,t;return zc&1&&t.tag!==0&&Ls(),s=t.pendingLanes,s&1?t===lf?no++:(no=0,lf=t):no=0,gi(),null}function Ls(){if(Hr!==null){var t=Ew(zc),e=In.transition,n=Ne;try{if(In.transition=null,Ne=16>t?16:t,Hr===null)var r=!1;else{if(t=Hr,Hr=null,zc=0,Ee&6)throw Error(z(331));var i=Ee;for(Ee|=4,Q=t.current;Q!==null;){var s=Q,a=s.child;if(Q.flags&16){var l=s.deletions;if(l!==null){for(var u=0;u<l.length;u++){var d=l[u];for(Q=d;Q!==null;){var m=Q;switch(m.tag){case 0:case 11:case 15:eo(8,m,s)}var p=m.child;if(p!==null)p.return=m,Q=p;else for(;Q!==null;){m=Q;var g=m.sibling,k=m.return;if(DE(m),m===d){Q=null;break}if(g!==null){g.return=k,Q=g;break}Q=k}}}var S=s.alternate;if(S!==null){var R=S.child;if(R!==null){S.child=null;do{var D=R.sibling;R.sibling=null,R=D}while(R!==null)}}Q=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,Q=a;else e:for(;Q!==null;){if(s=Q,s.flags&2048)switch(s.tag){case 0:case 11:case 15:eo(9,s,s.return)}var w=s.sibling;if(w!==null){w.return=s.return,Q=w;break e}Q=s.return}}var y=t.current;for(Q=y;Q!==null;){a=Q;var I=a.child;if(a.subtreeFlags&2064&&I!==null)I.return=a,Q=I;else e:for(a=y;Q!==null;){if(l=Q,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Iu(9,l)}}catch(F){We(l,l.return,F)}if(l===a){Q=null;break e}var P=l.sibling;if(P!==null){P.return=l.return,Q=P;break e}Q=l.return}}if(Ee=i,gi(),Yn&&typeof Yn.onPostCommitFiberRoot=="function")try{Yn.onPostCommitFiberRoot(gu,t)}catch{}r=!0}return r}finally{Ne=n,In.transition=e}}return!1}function xy(t,e,n){e=Ws(n,e),e=EE(t,e,1),t=Zr(t,e,1),e=Kt(),t!==null&&(Bo(t,1,e),nn(t,e))}function We(t,e,n){if(t.tag===3)xy(t,t,n);else for(;e!==null;){if(e.tag===3){xy(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ei===null||!ei.has(r))){t=Ws(n,t),t=TE(e,t,1),e=Zr(e,t,1),t=Kt(),e!==null&&(Bo(e,1,t),nn(e,t));break}}e=e.return}}function DA(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Kt(),t.pingedLanes|=t.suspendedLanes&n,gt===t&&(kt&n)===n&&(dt===4||dt===3&&(kt&130023424)===kt&&500>et()-Sm?Li(t,0):Im|=n),nn(t,e)}function zE(t,e){e===0&&(t.mode&1?(e=bl,bl<<=1,!(bl&130023424)&&(bl=4194304)):e=1);var n=Kt();t=Er(t,e),t!==null&&(Bo(t,e,n),nn(t,n))}function jA(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),zE(t,n)}function PA(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(z(314))}r!==null&&r.delete(e),zE(t,n)}var $E;$E=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||en.current)Xt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Xt=!1,EA(t,e,n);Xt=!!(t.flags&131072)}else Xt=!1,Be&&e.flags&1048576&&Hw(e,jc,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;oc(t,e),t=e.pendingProps;var i=Gs(e,zt.current);Vs(e,n),i=vm(null,e,r,t,i,n);var s=_m();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,tn(r)?(s=!0,bc(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,fm(e),i.updater=ku,e.stateNode=i,i._reactInternals=e,Qh(e,r,t,n),e=Xh(null,e,r,!0,s,n)):(e.tag=0,Be&&s&&am(e),Gt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(oc(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=MA(r),t=Pn(r,t),i){case 0:e=Jh(null,e,r,t,n);break e;case 1:e=vy(null,e,r,t,n);break e;case 11:e=gy(null,e,r,t,n);break e;case 14:e=yy(null,e,r,Pn(r.type,t),n);break e}throw Error(z(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Pn(r,i),Jh(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Pn(r,i),vy(t,e,r,i,n);case 3:e:{if(AE(e),t===null)throw Error(z(387));r=e.pendingProps,s=e.memoizedState,i=s.element,Zw(t,e),Mc(e,r,null,n);var a=e.memoizedState;if(r=a.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Ws(Error(z(423)),e),e=_y(t,e,r,n,i);break e}else if(r!==i){i=Ws(Error(z(424)),e),e=_y(t,e,r,n,i);break e}else for(hn=Xr(e.stateNode.containerInfo.firstChild),mn=e,Be=!0,Mn=null,n=Jw(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ks(),r===i){e=Tr(t,e,n);break e}Gt(t,e,r,n)}e=e.child}return e;case 5:return eE(e),t===null&&qh(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,Bh(r,i)?a=null:s!==null&&Bh(r,s)&&(e.flags|=32),SE(t,e),Gt(t,e,a,n),e.child;case 6:return t===null&&qh(e),null;case 13:return NE(t,e,n);case 4:return mm(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=qs(e,null,r,n):Gt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Pn(r,i),gy(t,e,r,i,n);case 7:return Gt(t,e,e.pendingProps,n),e.child;case 8:return Gt(t,e,e.pendingProps.children,n),e.child;case 12:return Gt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,Pe(Pc,r._currentValue),r._currentValue=a,s!==null)if(Un(s.value,a)){if(s.children===i.children&&!en.current){e=Tr(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){a=s.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(s.tag===1){u=pr(-1,n&-n),u.tag=2;var d=s.updateQueue;if(d!==null){d=d.shared;var m=d.pending;m===null?u.next=u:(u.next=m.next,m.next=u),d.pending=u}}s.lanes|=n,u=s.alternate,u!==null&&(u.lanes|=n),Hh(s.return,n,e),l.lanes|=n;break}u=u.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(z(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),Hh(a,n,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Gt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Vs(e,n),i=An(i),r=r(i),e.flags|=1,Gt(t,e,r,n),e.child;case 14:return r=e.type,i=Pn(r,e.pendingProps),i=Pn(r.type,i),yy(t,e,r,i,n);case 15:return kE(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Pn(r,i),oc(t,e),e.tag=1,tn(r)?(t=!0,bc(e)):t=!1,Vs(e,n),wE(e,r,i),Qh(e,r,i,n),Xh(null,e,r,!0,t,n);case 19:return xE(t,e,n);case 22:return IE(t,e,n)}throw Error(z(156,e.tag))};function GE(t,e){return yw(t,e)}function OA(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kn(t,e,n,r){return new OA(t,e,n,r)}function Cm(t){return t=t.prototype,!(!t||!t.isReactComponent)}function MA(t){if(typeof t=="function")return Cm(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Wf)return 11;if(t===Qf)return 14}return 2}function ni(t,e){var n=t.alternate;return n===null?(n=kn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function uc(t,e,n,r,i,s){var a=2;if(r=t,typeof t=="function")Cm(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Es:return Fi(n.children,i,s,e);case Hf:a=8,i|=8;break;case _h:return t=kn(12,n,e,i|2),t.elementType=_h,t.lanes=s,t;case wh:return t=kn(13,n,e,i),t.elementType=wh,t.lanes=s,t;case Eh:return t=kn(19,n,e,i),t.elementType=Eh,t.lanes=s,t;case ew:return Au(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case X_:a=10;break e;case Z_:a=9;break e;case Wf:a=11;break e;case Qf:a=14;break e;case Lr:a=16,r=null;break e}throw Error(z(130,t==null?t:typeof t,""))}return e=kn(a,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Fi(t,e,n,r){return t=kn(7,t,r,e),t.lanes=n,t}function Au(t,e,n,r){return t=kn(22,t,r,e),t.elementType=ew,t.lanes=n,t.stateNode={isHidden:!1},t}function Wd(t,e,n){return t=kn(6,t,null,e),t.lanes=n,t}function Qd(t,e,n){return e=kn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function VA(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Cd(0),this.expirationTimes=Cd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Cd(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Rm(t,e,n,r,i,s,a,l,u){return t=new VA(t,e,n,l,u),e===1?(e=1,s===!0&&(e|=8)):e=0,s=kn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},fm(s),t}function LA(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ws,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function KE(t){if(!t)return oi;t=t._reactInternals;e:{if(ts(t)!==t||t.tag!==1)throw Error(z(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(tn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(z(171))}if(t.tag===1){var n=t.type;if(tn(n))return Kw(t,n,e)}return e}function qE(t,e,n,r,i,s,a,l,u){return t=Rm(n,r,!0,t,i,s,a,l,u),t.context=KE(null),n=t.current,r=Kt(),i=ti(n),s=pr(r,i),s.callback=e??null,Zr(n,s,i),t.current.lanes=i,Bo(t,i,r),nn(t,r),t}function Nu(t,e,n,r){var i=e.current,s=Kt(),a=ti(i);return n=KE(n),e.context===null?e.context=n:e.pendingContext=n,e=pr(s,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Zr(i,e,a),t!==null&&(Fn(t,i,a,s),ic(t,i,a)),a}function Gc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Cy(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function bm(t,e){Cy(t,e),(t=t.alternate)&&Cy(t,e)}function FA(){return null}var HE=typeof reportError=="function"?reportError:function(t){console.error(t)};function Dm(t){this._internalRoot=t}xu.prototype.render=Dm.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(z(409));Nu(t,e,null,null)};xu.prototype.unmount=Dm.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;qi(function(){Nu(null,t,null,null)}),e[wr]=null}};function xu(t){this._internalRoot=t}xu.prototype.unstable_scheduleHydration=function(t){if(t){var e=Iw();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ur.length&&e!==0&&e<Ur[n].priority;n++);Ur.splice(n,0,t),n===0&&Aw(t)}};function jm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Cu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Ry(){}function UA(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var d=Gc(a);s.call(d)}}var a=qE(e,r,t,0,null,!1,!1,"",Ry);return t._reactRootContainer=a,t[wr]=a.current,_o(t.nodeType===8?t.parentNode:t),qi(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var d=Gc(u);l.call(d)}}var u=Rm(t,0,!1,null,null,!1,!1,"",Ry);return t._reactRootContainer=u,t[wr]=u.current,_o(t.nodeType===8?t.parentNode:t),qi(function(){Nu(e,u,n,r)}),u}function Ru(t,e,n,r,i){var s=n._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var l=i;i=function(){var u=Gc(a);l.call(u)}}Nu(e,a,t,i)}else a=UA(n,e,t,i,r);return Gc(a)}Tw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ua(e.pendingLanes);n!==0&&(Xf(e,n|1),nn(e,et()),!(Ee&6)&&(Qs=et()+500,gi()))}break;case 13:qi(function(){var r=Er(t,1);if(r!==null){var i=Kt();Fn(r,t,1,i)}}),bm(t,1)}};Zf=function(t){if(t.tag===13){var e=Er(t,134217728);if(e!==null){var n=Kt();Fn(e,t,134217728,n)}bm(t,134217728)}};kw=function(t){if(t.tag===13){var e=ti(t),n=Er(t,e);if(n!==null){var r=Kt();Fn(n,t,e,r)}bm(t,e)}};Iw=function(){return Ne};Sw=function(t,e){var n=Ne;try{return Ne=t,e()}finally{Ne=n}};bh=function(t,e,n){switch(e){case"input":if(Ih(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=wu(r);if(!i)throw Error(z(90));nw(r),Ih(r,i)}}}break;case"textarea":iw(t,n);break;case"select":e=n.value,e!=null&&js(t,!!n.multiple,e,!1)}};dw=Am;hw=qi;var BA={usingClientEntryPoint:!1,Events:[$o,Ss,wu,cw,uw,Am]},Va={findFiberByHostInstance:ji,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},zA={bundleType:Va.bundleType,version:Va.version,rendererPackageName:Va.rendererPackageName,rendererConfig:Va.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Cr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=pw(t),t===null?null:t.stateNode},findFiberByHostInstance:Va.findFiberByHostInstance||FA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zl.isDisabled&&zl.supportsFiber)try{gu=zl.inject(zA),Yn=zl}catch{}}vn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=BA;vn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!jm(e))throw Error(z(200));return LA(t,e,null,n)};vn.createRoot=function(t,e){if(!jm(t))throw Error(z(299));var n=!1,r="",i=HE;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Rm(t,1,!1,null,null,n,!1,r,i),t[wr]=e.current,_o(t.nodeType===8?t.parentNode:t),new Dm(e)};vn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(z(188)):(t=Object.keys(t).join(","),Error(z(268,t)));return t=pw(e),t=t===null?null:t.stateNode,t};vn.flushSync=function(t){return qi(t)};vn.hydrate=function(t,e,n){if(!Cu(e))throw Error(z(200));return Ru(null,t,e,!0,n)};vn.hydrateRoot=function(t,e,n){if(!jm(t))throw Error(z(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",a=HE;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=qE(e,null,t,1,n??null,i,!1,s,a),t[wr]=e.current,_o(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new xu(e)};vn.render=function(t,e,n){if(!Cu(e))throw Error(z(200));return Ru(null,t,e,!1,n)};vn.unmountComponentAtNode=function(t){if(!Cu(t))throw Error(z(40));return t._reactRootContainer?(qi(function(){Ru(null,null,t,!1,function(){t._reactRootContainer=null,t[wr]=null})}),!0):!1};vn.unstable_batchedUpdates=Am;vn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Cu(n))throw Error(z(200));if(t==null||t._reactInternals===void 0)throw Error(z(38));return Ru(t,e,n,!1,r)};vn.version="18.3.1-next-f1338f8080-20240426";function WE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(WE)}catch(t){console.error(t)}}WE(),W_.exports=vn;var $A=W_.exports,by=$A;yh.createRoot=by.createRoot,yh.hydrateRoot=by.hydrateRoot;const GA=()=>{};var Dy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QE=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},KA=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],a=t[n++],l=t[n++],u=((i&7)<<18|(s&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const s=t[n++],a=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},YE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,l=a?t[i+1]:0,u=i+2<t.length,d=u?t[i+2]:0,m=s>>2,p=(s&3)<<4|l>>4;let g=(l&15)<<2|d>>6,k=d&63;u||(k=64,a||(g=64)),r.push(n[m],n[p],n[g],n[k])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(QE(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):KA(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],l=i<t.length?n[t.charAt(i)]:0;++i;const d=i<t.length?n[t.charAt(i)]:64;++i;const p=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||l==null||d==null||p==null)throw new qA;const g=s<<2|l>>4;if(r.push(g),d!==64){const k=l<<4&240|d>>2;if(r.push(k),p!==64){const S=d<<6&192|p;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class qA extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const HA=function(t){const e=QE(t);return YE.encodeByteArray(e,!0)},Kc=function(t){return HA(t).replace(/\./g,"")},JE=function(t){try{return YE.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WA(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QA=()=>WA().__FIREBASE_DEFAULTS__,YA=()=>{if(typeof process>"u"||typeof Dy>"u")return;const t=Dy.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},JA=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&JE(t[1]);return e&&JSON.parse(e)},bu=()=>{try{return GA()||QA()||YA()||JA()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},XE=t=>{var e,n;return(n=(e=bu())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},ZE=t=>{const e=XE(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},eT=()=>{var t;return(t=bu())==null?void 0:t.config},tT=t=>{var e;return(e=bu())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XA{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ns(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Pm(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZA(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Kc(JSON.stringify(n)),Kc(JSON.stringify(a)),""].join(".")}const ro={};function eN(){const t={prod:[],emulator:[]};for(const e of Object.keys(ro))ro[e]?t.emulator.push(e):t.prod.push(e);return t}function tN(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let jy=!1;function Om(t,e){if(typeof window>"u"||typeof document>"u"||!ns(window.location.host)||ro[t]===e||ro[t]||jy)return;ro[t]=e;function n(g){return`__firebase__banner__${g}`}const r="__firebase__banner",s=eN().prod.length>0;function a(){const g=document.getElementById(r);g&&g.remove()}function l(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function u(g,k){g.setAttribute("width","24"),g.setAttribute("id",k),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function d(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{jy=!0,a()},g}function m(g,k){g.setAttribute("id",k),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function p(){const g=tN(r),k=n("text"),S=document.getElementById(k)||document.createElement("span"),R=n("learnmore"),D=document.getElementById(R)||document.createElement("a"),w=n("preprendIcon"),y=document.getElementById(w)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const I=g.element;l(I),m(D,R);const P=d();u(y,w),I.append(y,S,D,P),document.body.appendChild(I)}s?(S.innerText="Preview backend disconnected.",y.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(y.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",k)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $t(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function nN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test($t())}function rN(){var e;const t=(e=bu())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function iN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Mm(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function sN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function aN(){const t=$t();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function oN(){return!rN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Du(){try{return typeof indexedDB=="object"}catch{return!1}}function ju(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(n){e(n)}})}function Vm(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lN="FirebaseError";class Cn extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=lN,Object.setPrototypeOf(this,Cn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,yi.prototype.create)}}class yi{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?cN(s,r):"Error",l=`${this.serviceName}: ${a} (${i}).`;return new Cn(i,l,r)}}function cN(t,e){return t.replace(uN,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const uN=/\{\$([^}]+)}/g;function dN(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function kr(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],a=e[i];if(Py(s)&&Py(a)){if(!kr(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Py(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ko(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function za(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function $a(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function hN(t,e){const n=new fN(t,e);return n.subscribe.bind(n)}class fN{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");mN(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Yd),i.error===void 0&&(i.error=Yd),i.complete===void 0&&(i.complete=Yd);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function mN(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Yd(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pN=1e3,gN=2,yN=4*60*60*1e3,vN=.5;function Oy(t,e=pN,n=gN){const r=e*Math.pow(n,t),i=Math.round(vN*r*(Math.random()-.5)*2);return Math.min(yN,r+i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Re(t){return t&&t._delegate?t._delegate:t}class an{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Di="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _N{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new XA;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(EN(e))try{this.getOrInitializeService({instanceIdentifier:Di})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Di){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Di){return this.instances.has(e)}getOptions(e=Di){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);r===l&&a.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:wN(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Di){return this.component?this.component.multipleInstances?e:Di:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function wN(t){return t===Di?void 0:t}function EN(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new _N(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var me;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(me||(me={}));const kN={debug:me.DEBUG,verbose:me.VERBOSE,info:me.INFO,warn:me.WARN,error:me.ERROR,silent:me.SILENT},IN=me.INFO,SN={[me.DEBUG]:"log",[me.VERBOSE]:"log",[me.INFO]:"info",[me.WARN]:"warn",[me.ERROR]:"error"},AN=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=SN[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Pu{constructor(e){this.name=e,this._logLevel=IN,this._logHandler=AN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in me))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?kN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,me.DEBUG,...e),this._logHandler(this,me.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,me.VERBOSE,...e),this._logHandler(this,me.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,me.INFO,...e),this._logHandler(this,me.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,me.WARN,...e),this._logHandler(this,me.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,me.ERROR,...e),this._logHandler(this,me.ERROR,...e)}}const NN=(t,e)=>e.some(n=>t instanceof n);let My,Vy;function xN(){return My||(My=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function CN(){return Vy||(Vy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const nT=new WeakMap,df=new WeakMap,rT=new WeakMap,Jd=new WeakMap,Lm=new WeakMap;function RN(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{n(gr(t.result)),i()},a=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&nT.set(n,t)}).catch(()=>{}),Lm.set(e,t),e}function bN(t){if(df.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{n(),i()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});df.set(t,e)}let hf={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return df.get(t);if(e==="objectStoreNames")return t.objectStoreNames||rT.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return gr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function DN(t){hf=t(hf)}function jN(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Xd(this),e,...n);return rT.set(r,e.sort?e.sort():[e]),gr(r)}:CN().includes(t)?function(...e){return t.apply(Xd(this),e),gr(nT.get(this))}:function(...e){return gr(t.apply(Xd(this),e))}}function PN(t){return typeof t=="function"?jN(t):(t instanceof IDBTransaction&&bN(t),NN(t,xN())?new Proxy(t,hf):t)}function gr(t){if(t instanceof IDBRequest)return RN(t);if(Jd.has(t))return Jd.get(t);const e=PN(t);return e!==t&&(Jd.set(t,e),Lm.set(e,t)),e}const Xd=t=>Lm.get(t);function Ou(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),l=gr(a);return r&&a.addEventListener("upgradeneeded",u=>{r(gr(a.result),u.oldVersion,u.newVersion,gr(a.transaction),u)}),n&&a.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{s&&u.addEventListener("close",()=>s()),i&&u.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}function Zd(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",r=>e(r.oldVersion,r)),gr(n).then(()=>{})}const ON=["get","getKey","getAll","getAllKeys","count"],MN=["put","add","delete","clear"],eh=new Map;function Ly(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(eh.get(e))return eh.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=MN.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||ON.includes(n)))return;const s=async function(a,...l){const u=this.transaction(a,i?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(l.shift())),(await Promise.all([d[n](...l),i&&u.done]))[0]};return eh.set(e,s),s}DN(t=>({...t,get:(e,n,r)=>Ly(e,n)||t.get(e,n,r),has:(e,n)=>!!Ly(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(LN(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function LN(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const ff="@firebase/app",Fy="0.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ir=new Pu("@firebase/app"),FN="@firebase/app-compat",UN="@firebase/analytics-compat",BN="@firebase/analytics",zN="@firebase/app-check-compat",$N="@firebase/app-check",GN="@firebase/auth",KN="@firebase/auth-compat",qN="@firebase/database",HN="@firebase/data-connect",WN="@firebase/database-compat",QN="@firebase/functions",YN="@firebase/functions-compat",JN="@firebase/installations",XN="@firebase/installations-compat",ZN="@firebase/messaging",ex="@firebase/messaging-compat",tx="@firebase/performance",nx="@firebase/performance-compat",rx="@firebase/remote-config",ix="@firebase/remote-config-compat",sx="@firebase/storage",ax="@firebase/storage-compat",ox="@firebase/firestore",lx="@firebase/ai",cx="@firebase/firestore-compat",ux="firebase",dx="12.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mf="[DEFAULT]",hx={[ff]:"fire-core",[FN]:"fire-core-compat",[BN]:"fire-analytics",[UN]:"fire-analytics-compat",[$N]:"fire-app-check",[zN]:"fire-app-check-compat",[GN]:"fire-auth",[KN]:"fire-auth-compat",[qN]:"fire-rtdb",[HN]:"fire-data-connect",[WN]:"fire-rtdb-compat",[QN]:"fire-fn",[YN]:"fire-fn-compat",[JN]:"fire-iid",[XN]:"fire-iid-compat",[ZN]:"fire-fcm",[ex]:"fire-fcm-compat",[tx]:"fire-perf",[nx]:"fire-perf-compat",[rx]:"fire-rc",[ix]:"fire-rc-compat",[sx]:"fire-gcs",[ax]:"fire-gcs-compat",[ox]:"fire-fst",[cx]:"fire-fst-compat",[lx]:"fire-vertex","fire-js":"fire-js",[ux]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qc=new Map,fx=new Map,pf=new Map;function Uy(t,e){try{t.container.addComponent(e)}catch(n){Ir.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function yn(t){const e=t.name;if(pf.has(e))return Ir.debug(`There were multiple attempts to register component ${e}.`),!1;pf.set(e,t);for(const n of qc.values())Uy(n,t);for(const n of fx.values())Uy(n,t);return!0}function Rr(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function dn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mx={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ri=new yi("app","Firebase",mx);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class px{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new an("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ri.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oa=dx;function iT(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:mf,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw ri.create("bad-app-name",{appName:String(i)});if(n||(n=eT()),!n)throw ri.create("no-options");const s=qc.get(i);if(s){if(kr(n,s.options)&&kr(r,s.config))return s;throw ri.create("duplicate-app",{appName:i})}const a=new TN(i);for(const u of pf.values())a.addComponent(u);const l=new px(n,r,a);return qc.set(i,l),l}function qo(t=mf){const e=qc.get(t);if(!e&&t===mf&&eT())return iT();if(!e)throw ri.create("no-app",{appName:t});return e}function Ut(t,e,n){let r=hx[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ir.warn(a.join(" "));return}yn(new an(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gx="firebase-heartbeat-database",yx=1,xo="firebase-heartbeat-store";let th=null;function sT(){return th||(th=Ou(gx,yx,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(xo)}catch(n){console.warn(n)}}}}).catch(t=>{throw ri.create("idb-open",{originalErrorMessage:t.message})})),th}async function vx(t){try{const n=(await sT()).transaction(xo),r=await n.objectStore(xo).get(aT(t));return await n.done,r}catch(e){if(e instanceof Cn)Ir.warn(e.message);else{const n=ri.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ir.warn(n.message)}}}async function By(t,e){try{const r=(await sT()).transaction(xo,"readwrite");await r.objectStore(xo).put(e,aT(t)),await r.done}catch(n){if(n instanceof Cn)Ir.warn(n.message);else{const r=ri.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Ir.warn(r.message)}}}function aT(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _x=1024,wx=30;class Ex{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new kx(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=zy();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>wx){const a=Ix(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Ir.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=zy(),{heartbeatsToSend:r,unsentEntries:i}=Tx(this._heartbeatsCache.heartbeats),s=Kc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Ir.warn(n),""}}}function zy(){return new Date().toISOString().substring(0,10)}function Tx(t,e=_x){const n=[];let r=t.slice();for(const i of t){const s=n.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),$y(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),$y(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class kx{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Du()?ju().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await vx(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return By(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return By(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function $y(t){return Kc(JSON.stringify({version:2,heartbeats:t})).length}function Ix(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sx(t){yn(new an("platform-logger",e=>new VN(e),"PRIVATE")),yn(new an("heartbeat",e=>new Ex(e),"PRIVATE")),Ut(ff,Fy,t),Ut(ff,Fy,"esm2020"),Ut("fire-js","")}Sx("");function oT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Ax=oT,lT=new yi("auth","Firebase",oT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hc=new Pu("@firebase/auth");function Nx(t,...e){Hc.logLevel<=me.WARN&&Hc.warn(`Auth (${oa}): ${t}`,...e)}function dc(t,...e){Hc.logLevel<=me.ERROR&&Hc.error(`Auth (${oa}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bn(t,...e){throw Fm(t,...e)}function Xn(t,...e){return Fm(t,...e)}function cT(t,e,n){const r={...Ax(),[e]:n};return new yi("auth","Firebase",r).create(e,{appName:t.name})}function yr(t){return cT(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Fm(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return lT.create(t,...e)}function re(t,e,...n){if(!t)throw Fm(e,...n)}function fr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw dc(e),new Error(e)}function Sr(t,e){t||fr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gf(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function xx(){return Gy()==="http:"||Gy()==="https:"}function Gy(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cx(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(xx()||Mm()||"connection"in navigator)?navigator.onLine:!0}function Rx(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ho{constructor(e,n){this.shortDelay=e,this.longDelay=n,Sr(n>e,"Short delay should be less than long delay!"),this.isMobile=nN()||sN()}get(){return Cx()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Um(t,e){Sr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uT{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;fr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;fr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;fr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bx={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dx=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],jx=new Ho(3e4,6e4);function vi(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function _i(t,e,n,r,i={}){return dT(t,i,async()=>{let s={},a={};r&&(e==="GET"?a=r:s={body:JSON.stringify(r)});const l=Ko({key:t.config.apiKey,...a}).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:u,...s};return iN()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&ns(t.emulatorConfig.host)&&(d.credentials="include"),uT.fetch()(await hT(t,t.config.apiHost,n,l),d)})}async function dT(t,e,n){t._canInitEmulator=!1;const r={...bx,...e};try{const i=new Ox(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw $l(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const l=s.ok?a.errorMessage:a.error.message,[u,d]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw $l(t,"credential-already-in-use",a);if(u==="EMAIL_EXISTS")throw $l(t,"email-already-in-use",a);if(u==="USER_DISABLED")throw $l(t,"user-disabled",a);const m=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw cT(t,m,d);Bn(t,m)}}catch(i){if(i instanceof Cn)throw i;Bn(t,"network-request-failed",{message:String(i)})}}async function Wo(t,e,n,r,i={}){const s=await _i(t,e,n,r,i);return"mfaPendingCredential"in s&&Bn(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function hT(t,e,n,r){const i=`${e}${n}?${r}`,s=t,a=s.config.emulator?Um(t.config,i):`${t.config.apiScheme}://${i}`;return Dx.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(a).toString():a}function Px(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Ox{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Xn(this.auth,"network-request-failed")),jx.get())})}}function $l(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Xn(t,e,r);return i.customData._tokenResponse=n,i}function Ky(t){return t!==void 0&&t.enterprise!==void 0}class Mx{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return Px(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Vx(t,e){return _i(t,"GET","/v2/recaptchaConfig",vi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lx(t,e){return _i(t,"POST","/v1/accounts:delete",e)}async function Wc(t,e){return _i(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function io(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Fx(t,e=!1){const n=Re(t),r=await n.getIdToken(e),i=Bm(r);re(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:io(nh(i.auth_time)),issuedAtTime:io(nh(i.iat)),expirationTime:io(nh(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function nh(t){return Number(t)*1e3}function Bm(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return dc("JWT malformed, contained fewer than 3 sections"),null;try{const i=JE(n);return i?JSON.parse(i):(dc("Failed to decode base64 JWT payload"),null)}catch(i){return dc("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function qy(t){const e=Bm(t);return re(e,"internal-error"),re(typeof e.exp<"u","internal-error"),re(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Co(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Cn&&Ux(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function Ux({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bx{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=io(this.lastLoginAt),this.creationTime=io(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qc(t){var p;const e=t.auth,n=await t.getIdToken(),r=await Co(t,Wc(e,{idToken:n}));re(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const s=(p=i.providerUserInfo)!=null&&p.length?fT(i.providerUserInfo):[],a=$x(t.providerData,s),l=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!(a!=null&&a.length),d=l?u:!1,m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new yf(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,m)}async function zx(t){const e=Re(t);await Qc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function $x(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function fT(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gx(t,e){const n=await dT(t,{},async()=>{const r=Ko({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=await hT(t,i,"/v1/token",`key=${s}`),l=await t._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:l,body:r};return t.emulatorConfig&&ns(t.emulatorConfig.host)&&(u.credentials="include"),uT.fetch()(a,u)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function Kx(t,e){return _i(t,"POST","/v2/accounts:revokeToken",vi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){re(e.idToken,"internal-error"),re(typeof e.idToken<"u","internal-error"),re(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):qy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){re(e.length!==0,"internal-error");const n=qy(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(re(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await Gx(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,a=new Fs;return r&&(re(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(re(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(re(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Fs,this.toJSON())}_performRefresh(){return fr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vr(t,e){re(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Vn{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new Bx(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new yf(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Co(this,this.stsTokenManager.getToken(this.auth,e));return re(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return Fx(this,e)}reload(){return zx(this)}_assign(e){this!==e&&(re(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Vn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){re(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Qc(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(dn(this.auth.app))return Promise.reject(yr(this.auth));const e=await this.getIdToken();return await Co(this,Lx(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,s=n.phoneNumber??void 0,a=n.photoURL??void 0,l=n.tenantId??void 0,u=n._redirectEventId??void 0,d=n.createdAt??void 0,m=n.lastLoginAt??void 0,{uid:p,emailVerified:g,isAnonymous:k,providerData:S,stsTokenManager:R}=n;re(p&&R,e,"internal-error");const D=Fs.fromJSON(this.name,R);re(typeof p=="string",e,"internal-error"),Vr(r,e.name),Vr(i,e.name),re(typeof g=="boolean",e,"internal-error"),re(typeof k=="boolean",e,"internal-error"),Vr(s,e.name),Vr(a,e.name),Vr(l,e.name),Vr(u,e.name),Vr(d,e.name),Vr(m,e.name);const w=new Vn({uid:p,auth:e,email:i,emailVerified:g,displayName:r,isAnonymous:k,photoURL:a,phoneNumber:s,tenantId:l,stsTokenManager:D,createdAt:d,lastLoginAt:m});return S&&Array.isArray(S)&&(w.providerData=S.map(y=>({...y}))),u&&(w._redirectEventId=u),w}static async _fromIdTokenResponse(e,n,r=!1){const i=new Fs;i.updateFromServerResponse(n);const s=new Vn({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Qc(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];re(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?fT(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),l=new Fs;l.updateFromIdToken(r);const u=new Vn({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:a}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new yf(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hy=new Map;function mr(t){Sr(t instanceof Function,"Expected a class definition");let e=Hy.get(t);return e?(Sr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Hy.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}mT.type="NONE";const Wy=mT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hc(t,e,n){return`firebase:${t}:${e}:${n}`}class Us{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=hc(this.userKey,i.apiKey,s),this.fullPersistenceKey=hc("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Wc(this.auth,{idToken:e}).catch(()=>{});return n?Vn._fromGetAccountInfoResponse(this.auth,n,e):null}return Vn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Us(mr(Wy),e,r);const i=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let s=i[0]||mr(Wy);const a=hc(r,e.config.apiKey,e.name);let l=null;for(const d of n)try{const m=await d._get(a);if(m){let p;if(typeof m=="string"){const g=await Wc(e,{idToken:m}).catch(()=>{});if(!g)break;p=await Vn._fromGetAccountInfoResponse(e,g,m)}else p=Vn._fromJSON(e,m);d!==s&&(l=p),s=d;break}}catch{}const u=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new Us(s,e,r):(s=u[0],l&&await s._set(a,l.toJSON()),await Promise.all(n.map(async d=>{if(d!==s)try{await d._remove(a)}catch{}})),new Us(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qy(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(vT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(pT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(wT(e))return"Blackberry";if(ET(e))return"Webos";if(gT(e))return"Safari";if((e.includes("chrome/")||yT(e))&&!e.includes("edge/"))return"Chrome";if(_T(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function pT(t=$t()){return/firefox\//i.test(t)}function gT(t=$t()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function yT(t=$t()){return/crios\//i.test(t)}function vT(t=$t()){return/iemobile/i.test(t)}function _T(t=$t()){return/android/i.test(t)}function wT(t=$t()){return/blackberry/i.test(t)}function ET(t=$t()){return/webos/i.test(t)}function zm(t=$t()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function qx(t=$t()){var e;return zm(t)&&!!((e=window.navigator)!=null&&e.standalone)}function Hx(){return aN()&&document.documentMode===10}function TT(t=$t()){return zm(t)||_T(t)||ET(t)||wT(t)||/windows phone/i.test(t)||vT(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kT(t,e=[]){let n;switch(t){case"Browser":n=Qy($t());break;case"Worker":n=`${Qy($t())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${oa}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wx{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((a,l)=>{try{const u=e(s);a(u)}catch(u){l(u)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qx(t,e={}){return _i(t,"GET","/v2/passwordPolicy",vi(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yx=6;class Jx{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??Yx,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xx{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Yy(this),this.idTokenSubscription=new Yy(this),this.beforeStateQueue=new Wx(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=lT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=mr(n)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await Us.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Wc(this,{idToken:e}),r=await Vn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(dn(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(s=this.redirectUser)==null?void 0:s._redirectEventId,l=r==null?void 0:r._redirectEventId,u=await this.tryRedirectSignIn(e);(!a||a===l)&&(u!=null&&u.user)&&(r=u.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(a){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return re(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Qc(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Rx()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(dn(this.app))return Promise.reject(yr(this));const n=e?Re(e):null;return n&&re(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&re(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return dn(this.app)?Promise.reject(yr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return dn(this.app)?Promise.reject(yr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(mr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Qx(this),n=new Jx(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new yi("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await Kx(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&mr(e)||this._popupRedirectResolver;re(n,this,"argument-error"),this.redirectPersistenceManager=await Us.create(this,[mr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let a=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(re(l,this,"internal-error"),l.then(()=>{a||s(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,i);return()=>{a=!0,u()}}else{const u=e.addObserver(n);return()=>{a=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return re(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=kT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(dn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&Nx(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function rs(t){return Re(t)}class Yy{constructor(e){this.auth=e,this.observer=null,this.addObserver=hN(n=>this.observer=n)}get next(){return re(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Zx(t){Mu=t}function IT(t){return Mu.loadJS(t)}function eC(){return Mu.recaptchaEnterpriseScript}function tC(){return Mu.gapiScript}function nC(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class rC{constructor(){this.enterprise=new iC}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class iC{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const sC="recaptcha-enterprise",ST="NO_RECAPTCHA";class aC{constructor(e){this.type=sC,this.auth=rs(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,l)=>{Vx(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const d=new Mx(u);return s.tenantId==null?s._agentRecaptchaConfig=d:s._tenantRecaptchaConfigs[s.tenantId]=d,a(d.siteKey)}}).catch(u=>{l(u)})})}function i(s,a,l){const u=window.grecaptcha;Ky(u)?u.enterprise.ready(()=>{u.enterprise.execute(s,{action:e}).then(d=>{a(d)}).catch(()=>{a(ST)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new rC().execute("siteKey",{action:"verify"}):new Promise((s,a)=>{r(this.auth).then(l=>{if(!n&&Ky(window.grecaptcha))i(l,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let u=eC();u.length!==0&&(u+=l),IT(u).then(()=>{i(l,s,a)}).catch(d=>{a(d)})}}).catch(l=>{a(l)})})}}async function Jy(t,e,n,r=!1,i=!1){const s=new aC(t);let a;if(i)a=ST;else try{a=await s.verify(n)}catch{a=await s.verify(n,!0)}const l={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const u=l.phoneEnrollmentInfo.phoneNumber,d=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:d,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const u=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return r?Object.assign(l,{captchaResp:a}):Object.assign(l,{captchaResponse:a}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function vf(t,e,n,r,i){var s;if((s=t._getRecaptchaConfig())!=null&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await Jy(t,e,n,n==="getOobCode");return r(t,a)}else return r(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await Jy(t,e,n,n==="getOobCode");return r(t,l)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oC(t,e){const n=Rr(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(kr(s,e??{}))return i;Bn(i,"already-initialized")}return n.initialize({options:e})}function lC(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(mr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function cC(t,e,n){const r=rs(t);re(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=AT(e),{host:a,port:l}=uC(e),u=l===null?"":`:${l}`,d={url:`${s}//${a}${u}/`},m=Object.freeze({host:a,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){re(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),re(kr(d,r.config.emulator)&&kr(m,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=m,r.settings.appVerificationDisabledForTesting=!0,ns(a)?(Pm(`${s}//${a}${u}`),Om("Auth",!0)):dC()}function AT(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function uC(t){const e=AT(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:Xy(r.substr(s.length+1))}}else{const[s,a]=r.split(":");return{host:s,port:Xy(a)}}}function Xy(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function dC(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $m{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return fr("not implemented")}_getIdTokenResponse(e){return fr("not implemented")}_linkToIdToken(e,n){return fr("not implemented")}_getReauthenticationResolver(e){return fr("not implemented")}}async function hC(t,e){return _i(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fC(t,e){return Wo(t,"POST","/v1/accounts:signInWithPassword",vi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mC(t,e){return Wo(t,"POST","/v1/accounts:signInWithEmailLink",vi(t,e))}async function pC(t,e){return Wo(t,"POST","/v1/accounts:signInWithEmailLink",vi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro extends $m{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new Ro(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Ro(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return vf(e,n,"signInWithPassword",fC);case"emailLink":return mC(e,{email:this._email,oobCode:this._password});default:Bn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return vf(e,r,"signUpPassword",hC);case"emailLink":return pC(e,{idToken:n,email:this._email,oobCode:this._password});default:Bn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bs(t,e){return Wo(t,"POST","/v1/accounts:signInWithIdp",vi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gC="http://localhost";class Hi extends $m{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Hi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Bn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=n;if(!r||!i)return null;const a=new Hi(r,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return Bs(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Bs(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Bs(e,n)}buildRequest(){const e={requestUri:gC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Ko(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yC(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function vC(t){const e=za($a(t)).link,n=e?za($a(e)).deep_link_id:null,r=za($a(t)).deep_link_id;return(r?za($a(r)).link:null)||r||n||e||t}class Gm{constructor(e){const n=za($a(e)),r=n.apiKey??null,i=n.oobCode??null,s=yC(n.mode??null);re(r&&i&&s,"argument-error"),this.apiKey=r,this.operation=s,this.code=i,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=vC(e);try{return new Gm(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class la{constructor(){this.providerId=la.PROVIDER_ID}static credential(e,n){return Ro._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Gm.parseLink(n);return re(r,"argument-error"),Ro._fromEmailAndCode(e,r.code,r.tenantId)}}la.PROVIDER_ID="password";la.EMAIL_PASSWORD_SIGN_IN_METHOD="password";la.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NT{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo extends NT{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr extends Qo{constructor(){super("facebook.com")}static credential(e){return Hi._fromParams({providerId:zr.PROVIDER_ID,signInMethod:zr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return zr.credentialFromTaggedObject(e)}static credentialFromError(e){return zr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return zr.credential(e.oauthAccessToken)}catch{return null}}}zr.FACEBOOK_SIGN_IN_METHOD="facebook.com";zr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $r extends Qo{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Hi._fromParams({providerId:$r.PROVIDER_ID,signInMethod:$r.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return $r.credentialFromTaggedObject(e)}static credentialFromError(e){return $r.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return $r.credential(n,r)}catch{return null}}}$r.GOOGLE_SIGN_IN_METHOD="google.com";$r.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr extends Qo{constructor(){super("github.com")}static credential(e){return Hi._fromParams({providerId:Gr.PROVIDER_ID,signInMethod:Gr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Gr.credentialFromTaggedObject(e)}static credentialFromError(e){return Gr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Gr.credential(e.oauthAccessToken)}catch{return null}}}Gr.GITHUB_SIGN_IN_METHOD="github.com";Gr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr extends Qo{constructor(){super("twitter.com")}static credential(e,n){return Hi._fromParams({providerId:Kr.PROVIDER_ID,signInMethod:Kr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Kr.credentialFromTaggedObject(e)}static credentialFromError(e){return Kr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Kr.credential(n,r)}catch{return null}}}Kr.TWITTER_SIGN_IN_METHOD="twitter.com";Kr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _C(t,e){return Wo(t,"POST","/v1/accounts:signUp",vi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await Vn._fromIdTokenResponse(e,r,i),a=Zy(r);return new Wi({user:s,providerId:a,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=Zy(r);return new Wi({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function Zy(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yc extends Cn{constructor(e,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Yc.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new Yc(e,n,r,i)}}function xT(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Yc._fromErrorAndOperation(t,s,e,r):s})}async function wC(t,e,n=!1){const r=await Co(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Wi._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EC(t,e,n=!1){const{auth:r}=t;if(dn(r.app))return Promise.reject(yr(r));const i="reauthenticate";try{const s=await Co(t,xT(r,i,e,t),n);re(s.idToken,r,"internal-error");const a=Bm(s.idToken);re(a,r,"internal-error");const{sub:l}=a;return re(t.uid===l,r,"user-mismatch"),Wi._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Bn(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CT(t,e,n=!1){if(dn(t.app))return Promise.reject(yr(t));const r="signIn",i=await xT(t,r,e),s=await Wi._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function TC(t,e){return CT(rs(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RT(t){const e=rs(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function kC(t,e,n){if(dn(t.app))return Promise.reject(yr(t));const r=rs(t),a=await vf(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",_C).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&RT(t),u}),l=await Wi._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(l.user),l}function IC(t,e,n){return dn(t.app)?Promise.reject(yr(t)):TC(Re(t),la.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&RT(t),r})}function SC(t,e,n,r){return Re(t).onIdTokenChanged(e,n,r)}function AC(t,e,n){return Re(t).beforeAuthStateChanged(e,n)}function NC(t,e,n,r){return Re(t).onAuthStateChanged(e,n,r)}function xC(t){return Re(t).signOut()}const Jc="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bT{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Jc,"1"),this.storage.removeItem(Jc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CC=1e3,RC=10;class DT extends bT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=TT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,l,u)=>{this.notifyListeners(a,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(r);!n&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);Hx()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,RC):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},CC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}DT.type="LOCAL";const bC=DT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jT extends bT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}jT.type="SESSION";const PT=jT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DC(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Vu(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const l=Array.from(a).map(async d=>d(n.origin,s)),u=await DC(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Vu.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Km(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((l,u)=>{const d=Km("",20);i.port1.start();const m=setTimeout(()=>{u(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(p){const g=p;if(g.data.eventId===d)switch(g.data.status){case"ack":clearTimeout(m),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(g.data.response);break;default:clearTimeout(m),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zn(){return window}function PC(t){Zn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OT(){return typeof Zn().WorkerGlobalScope<"u"&&typeof Zn().importScripts=="function"}async function OC(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function MC(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function VC(){return OT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MT="firebaseLocalStorageDb",LC=1,Xc="firebaseLocalStorage",VT="fbase_key";class Yo{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Lu(t,e){return t.transaction([Xc],e?"readwrite":"readonly").objectStore(Xc)}function FC(){const t=indexedDB.deleteDatabase(MT);return new Yo(t).toPromise()}function _f(){const t=indexedDB.open(MT,LC);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Xc,{keyPath:VT})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Xc)?e(r):(r.close(),await FC(),e(await _f()))})})}async function ev(t,e,n){const r=Lu(t,!0).put({[VT]:e,value:n});return new Yo(r).toPromise()}async function UC(t,e){const n=Lu(t,!1).get(e),r=await new Yo(n).toPromise();return r===void 0?null:r.value}function tv(t,e){const n=Lu(t,!0).delete(e);return new Yo(n).toPromise()}const BC=800,zC=3;class LT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await _f(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>zC)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return OT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Vu._getInstance(VC()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await OC(),!this.activeServiceWorker)return;this.sender=new jC(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||MC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await _f();return await ev(e,Jc,"1"),await tv(e,Jc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>ev(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>UC(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>tv(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Lu(i,!1).getAll();return new Yo(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),BC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}LT.type="LOCAL";const $C=LT;new Ho(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GC(t,e){return e?mr(e):(re(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qm extends $m{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Bs(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Bs(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Bs(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function KC(t){return CT(t.auth,new qm(t),t.bypassAuthState)}function qC(t){const{auth:e,user:n}=t;return re(n,e,"internal-error"),EC(n,new qm(t),t.bypassAuthState)}async function HC(t){const{auth:e,user:n}=t;return re(n,e,"internal-error"),wC(n,new qm(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FT{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:a,type:l}=e;if(a){this.reject(a);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return KC;case"linkViaPopup":case"linkViaRedirect":return HC;case"reauthViaPopup":case"reauthViaRedirect":return qC;default:Bn(this.auth,"internal-error")}}resolve(e){Sr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Sr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WC=new Ho(2e3,1e4);class Ds extends FT{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Ds.currentPopupAction&&Ds.currentPopupAction.cancel(),Ds.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return re(e,this.auth,"internal-error"),e}async onExecution(){Sr(this.filter.length===1,"Popup operations only handle one event");const e=Km();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Xn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Xn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ds.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Xn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,WC.get())};e()}}Ds.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QC="pendingRedirect",fc=new Map;class YC extends FT{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=fc.get(this.auth._key());if(!e){try{const r=await JC(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}fc.set(this.auth._key(),e)}return this.bypassAuthState||fc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function JC(t,e){const n=e1(e),r=ZC(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function XC(t,e){fc.set(t._key(),e)}function ZC(t){return mr(t._redirectPersistence)}function e1(t){return hc(QC,t.config.apiKey,t.name)}async function t1(t,e,n=!1){if(dn(t.app))return Promise.reject(yr(t));const r=rs(t),i=GC(r,e),a=await new YC(r,i,n).execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n1=10*60*1e3;class r1{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!i1(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!UT(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Xn(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=n1&&this.cachedEventUids.clear(),this.cachedEventUids.has(nv(e))}saveEventToCache(e){this.cachedEventUids.add(nv(e)),this.lastProcessedEventTime=Date.now()}}function nv(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function UT({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function i1(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return UT(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s1(t,e={}){return _i(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a1=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,o1=/^https?/;async function l1(t){if(t.config.emulator)return;const{authorizedDomains:e}=await s1(t);for(const n of e)try{if(c1(n))return}catch{}Bn(t,"unauthorized-domain")}function c1(t){const e=gf(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===r}if(!o1.test(n))return!1;if(a1.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u1=new Ho(3e4,6e4);function rv(){const t=Zn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function d1(t){return new Promise((e,n)=>{var i,s,a;function r(){rv(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{rv(),n(Xn(t,"network-request-failed"))},timeout:u1.get()})}if((s=(i=Zn().gapi)==null?void 0:i.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((a=Zn().gapi)!=null&&a.load)r();else{const l=nC("iframefcb");return Zn()[l]=()=>{gapi.load?r():n(Xn(t,"network-request-failed"))},IT(`${tC()}?onload=${l}`).catch(u=>n(u))}}).catch(e=>{throw mc=null,e})}let mc=null;function h1(t){return mc=mc||d1(t),mc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f1=new Ho(5e3,15e3),m1="__/auth/iframe",p1="emulator/auth/iframe",g1={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},y1=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function v1(t){const e=t.config;re(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Um(e,p1):`https://${t.config.authDomain}/${m1}`,r={apiKey:e.apiKey,appName:t.name,v:oa},i=y1.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Ko(r).slice(1)}`}async function _1(t){const e=await h1(t),n=Zn().gapi;return re(n,t,"internal-error"),e.open({where:document.body,url:v1(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:g1,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const a=Xn(t,"network-request-failed"),l=Zn().setTimeout(()=>{s(a)},f1.get());function u(){Zn().clearTimeout(l),i(r)}r.ping(u).then(u,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w1={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},E1=500,T1=600,k1="_blank",I1="http://localhost";class iv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function S1(t,e,n,r=E1,i=T1){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const u={...w1,width:r.toString(),height:i.toString(),top:s,left:a},d=$t().toLowerCase();n&&(l=yT(d)?k1:n),pT(d)&&(e=e||I1,u.scrollbars="yes");const m=Object.entries(u).reduce((g,[k,S])=>`${g}${k}=${S},`,"");if(qx(d)&&l!=="_self")return A1(e||"",l),new iv(null);const p=window.open(e||"",l,m);re(p,t,"popup-blocked");try{p.focus()}catch{}return new iv(p)}function A1(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N1="__/auth/handler",x1="emulator/auth/handler",C1=encodeURIComponent("fac");async function sv(t,e,n,r,i,s){re(t.config.authDomain,t,"auth-domain-config-required"),re(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:oa,eventId:i};if(e instanceof NT){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",dN(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,p]of Object.entries({}))a[m]=p}if(e instanceof Qo){const m=e.getScopes().filter(p=>p!=="");m.length>0&&(a.scopes=m.join(","))}t.tenantId&&(a.tid=t.tenantId);const l=a;for(const m of Object.keys(l))l[m]===void 0&&delete l[m];const u=await t._getAppCheckToken(),d=u?`#${C1}=${encodeURIComponent(u)}`:"";return`${R1(t)}?${Ko(l).slice(1)}${d}`}function R1({config:t}){return t.emulator?Um(t,x1):`https://${t.authDomain}/${N1}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rh="webStorageSupport";class b1{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=PT,this._completeRedirectFn=t1,this._overrideRedirectResult=XC}async _openPopup(e,n,r,i){var a;Sr((a=this.eventManagers[e._key()])==null?void 0:a.manager,"_initialize() not called before _openPopup()");const s=await sv(e,n,r,gf(),i);return S1(e,s,Km())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await sv(e,n,r,gf(),i);return PC(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(Sr(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await _1(e),r=new r1(e);return n.register("authEvent",i=>(re(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(rh,{type:rh},i=>{var a;const s=(a=i==null?void 0:i[0])==null?void 0:a[rh];s!==void 0&&n(!!s),Bn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=l1(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return TT()||gT()||zm()}}const D1=b1;var av="@firebase/auth",ov="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j1{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){re(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P1(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function O1(t){yn(new an("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:l}=r.options;re(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:a,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:kT(t)},d=new Xx(r,i,s,u);return lC(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),yn(new an("auth-internal",e=>{const n=rs(e.getProvider("auth").getImmediate());return(r=>new j1(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ut(av,ov,P1(t)),Ut(av,ov,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M1=5*60,V1=tT("authIdTokenMaxAge")||M1;let lv=null;const L1=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>V1)return;const i=n==null?void 0:n.token;lv!==i&&(lv=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function F1(t=qo()){const e=Rr(t,"auth");if(e.isInitialized())return e.getImmediate();const n=oC(t,{popupRedirectResolver:D1,persistence:[$C,bC,PT]}),r=tT("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const a=L1(s.toString());AC(n,a,()=>a(n.currentUser)),SC(n,l=>a(l))}}const i=XE("auth");return i&&cC(n,`http://${i}`),n}function U1(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}Zx({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=Xn("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",U1().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});O1("Browser");var B1="firebase",z1="12.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ut(B1,z1,"app");var cv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ii,BT;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(N,v){function E(){}E.prototype=v.prototype,N.D=v.prototype,N.prototype=new E,N.prototype.constructor=N,N.C=function(x,A,b){for(var C=Array(arguments.length-2),ye=2;ye<arguments.length;ye++)C[ye-2]=arguments[ye];return v.prototype[A].apply(x,C)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(N,v,E){E||(E=0);var x=Array(16);if(typeof v=="string")for(var A=0;16>A;++A)x[A]=v.charCodeAt(E++)|v.charCodeAt(E++)<<8|v.charCodeAt(E++)<<16|v.charCodeAt(E++)<<24;else for(A=0;16>A;++A)x[A]=v[E++]|v[E++]<<8|v[E++]<<16|v[E++]<<24;v=N.g[0],E=N.g[1],A=N.g[2];var b=N.g[3],C=v+(b^E&(A^b))+x[0]+3614090360&4294967295;v=E+(C<<7&4294967295|C>>>25),C=b+(A^v&(E^A))+x[1]+3905402710&4294967295,b=v+(C<<12&4294967295|C>>>20),C=A+(E^b&(v^E))+x[2]+606105819&4294967295,A=b+(C<<17&4294967295|C>>>15),C=E+(v^A&(b^v))+x[3]+3250441966&4294967295,E=A+(C<<22&4294967295|C>>>10),C=v+(b^E&(A^b))+x[4]+4118548399&4294967295,v=E+(C<<7&4294967295|C>>>25),C=b+(A^v&(E^A))+x[5]+1200080426&4294967295,b=v+(C<<12&4294967295|C>>>20),C=A+(E^b&(v^E))+x[6]+2821735955&4294967295,A=b+(C<<17&4294967295|C>>>15),C=E+(v^A&(b^v))+x[7]+4249261313&4294967295,E=A+(C<<22&4294967295|C>>>10),C=v+(b^E&(A^b))+x[8]+1770035416&4294967295,v=E+(C<<7&4294967295|C>>>25),C=b+(A^v&(E^A))+x[9]+2336552879&4294967295,b=v+(C<<12&4294967295|C>>>20),C=A+(E^b&(v^E))+x[10]+4294925233&4294967295,A=b+(C<<17&4294967295|C>>>15),C=E+(v^A&(b^v))+x[11]+2304563134&4294967295,E=A+(C<<22&4294967295|C>>>10),C=v+(b^E&(A^b))+x[12]+1804603682&4294967295,v=E+(C<<7&4294967295|C>>>25),C=b+(A^v&(E^A))+x[13]+4254626195&4294967295,b=v+(C<<12&4294967295|C>>>20),C=A+(E^b&(v^E))+x[14]+2792965006&4294967295,A=b+(C<<17&4294967295|C>>>15),C=E+(v^A&(b^v))+x[15]+1236535329&4294967295,E=A+(C<<22&4294967295|C>>>10),C=v+(A^b&(E^A))+x[1]+4129170786&4294967295,v=E+(C<<5&4294967295|C>>>27),C=b+(E^A&(v^E))+x[6]+3225465664&4294967295,b=v+(C<<9&4294967295|C>>>23),C=A+(v^E&(b^v))+x[11]+643717713&4294967295,A=b+(C<<14&4294967295|C>>>18),C=E+(b^v&(A^b))+x[0]+3921069994&4294967295,E=A+(C<<20&4294967295|C>>>12),C=v+(A^b&(E^A))+x[5]+3593408605&4294967295,v=E+(C<<5&4294967295|C>>>27),C=b+(E^A&(v^E))+x[10]+38016083&4294967295,b=v+(C<<9&4294967295|C>>>23),C=A+(v^E&(b^v))+x[15]+3634488961&4294967295,A=b+(C<<14&4294967295|C>>>18),C=E+(b^v&(A^b))+x[4]+3889429448&4294967295,E=A+(C<<20&4294967295|C>>>12),C=v+(A^b&(E^A))+x[9]+568446438&4294967295,v=E+(C<<5&4294967295|C>>>27),C=b+(E^A&(v^E))+x[14]+3275163606&4294967295,b=v+(C<<9&4294967295|C>>>23),C=A+(v^E&(b^v))+x[3]+4107603335&4294967295,A=b+(C<<14&4294967295|C>>>18),C=E+(b^v&(A^b))+x[8]+1163531501&4294967295,E=A+(C<<20&4294967295|C>>>12),C=v+(A^b&(E^A))+x[13]+2850285829&4294967295,v=E+(C<<5&4294967295|C>>>27),C=b+(E^A&(v^E))+x[2]+4243563512&4294967295,b=v+(C<<9&4294967295|C>>>23),C=A+(v^E&(b^v))+x[7]+1735328473&4294967295,A=b+(C<<14&4294967295|C>>>18),C=E+(b^v&(A^b))+x[12]+2368359562&4294967295,E=A+(C<<20&4294967295|C>>>12),C=v+(E^A^b)+x[5]+4294588738&4294967295,v=E+(C<<4&4294967295|C>>>28),C=b+(v^E^A)+x[8]+2272392833&4294967295,b=v+(C<<11&4294967295|C>>>21),C=A+(b^v^E)+x[11]+1839030562&4294967295,A=b+(C<<16&4294967295|C>>>16),C=E+(A^b^v)+x[14]+4259657740&4294967295,E=A+(C<<23&4294967295|C>>>9),C=v+(E^A^b)+x[1]+2763975236&4294967295,v=E+(C<<4&4294967295|C>>>28),C=b+(v^E^A)+x[4]+1272893353&4294967295,b=v+(C<<11&4294967295|C>>>21),C=A+(b^v^E)+x[7]+4139469664&4294967295,A=b+(C<<16&4294967295|C>>>16),C=E+(A^b^v)+x[10]+3200236656&4294967295,E=A+(C<<23&4294967295|C>>>9),C=v+(E^A^b)+x[13]+681279174&4294967295,v=E+(C<<4&4294967295|C>>>28),C=b+(v^E^A)+x[0]+3936430074&4294967295,b=v+(C<<11&4294967295|C>>>21),C=A+(b^v^E)+x[3]+3572445317&4294967295,A=b+(C<<16&4294967295|C>>>16),C=E+(A^b^v)+x[6]+76029189&4294967295,E=A+(C<<23&4294967295|C>>>9),C=v+(E^A^b)+x[9]+3654602809&4294967295,v=E+(C<<4&4294967295|C>>>28),C=b+(v^E^A)+x[12]+3873151461&4294967295,b=v+(C<<11&4294967295|C>>>21),C=A+(b^v^E)+x[15]+530742520&4294967295,A=b+(C<<16&4294967295|C>>>16),C=E+(A^b^v)+x[2]+3299628645&4294967295,E=A+(C<<23&4294967295|C>>>9),C=v+(A^(E|~b))+x[0]+4096336452&4294967295,v=E+(C<<6&4294967295|C>>>26),C=b+(E^(v|~A))+x[7]+1126891415&4294967295,b=v+(C<<10&4294967295|C>>>22),C=A+(v^(b|~E))+x[14]+2878612391&4294967295,A=b+(C<<15&4294967295|C>>>17),C=E+(b^(A|~v))+x[5]+4237533241&4294967295,E=A+(C<<21&4294967295|C>>>11),C=v+(A^(E|~b))+x[12]+1700485571&4294967295,v=E+(C<<6&4294967295|C>>>26),C=b+(E^(v|~A))+x[3]+2399980690&4294967295,b=v+(C<<10&4294967295|C>>>22),C=A+(v^(b|~E))+x[10]+4293915773&4294967295,A=b+(C<<15&4294967295|C>>>17),C=E+(b^(A|~v))+x[1]+2240044497&4294967295,E=A+(C<<21&4294967295|C>>>11),C=v+(A^(E|~b))+x[8]+1873313359&4294967295,v=E+(C<<6&4294967295|C>>>26),C=b+(E^(v|~A))+x[15]+4264355552&4294967295,b=v+(C<<10&4294967295|C>>>22),C=A+(v^(b|~E))+x[6]+2734768916&4294967295,A=b+(C<<15&4294967295|C>>>17),C=E+(b^(A|~v))+x[13]+1309151649&4294967295,E=A+(C<<21&4294967295|C>>>11),C=v+(A^(E|~b))+x[4]+4149444226&4294967295,v=E+(C<<6&4294967295|C>>>26),C=b+(E^(v|~A))+x[11]+3174756917&4294967295,b=v+(C<<10&4294967295|C>>>22),C=A+(v^(b|~E))+x[2]+718787259&4294967295,A=b+(C<<15&4294967295|C>>>17),C=E+(b^(A|~v))+x[9]+3951481745&4294967295,N.g[0]=N.g[0]+v&4294967295,N.g[1]=N.g[1]+(A+(C<<21&4294967295|C>>>11))&4294967295,N.g[2]=N.g[2]+A&4294967295,N.g[3]=N.g[3]+b&4294967295}r.prototype.u=function(N,v){v===void 0&&(v=N.length);for(var E=v-this.blockSize,x=this.B,A=this.h,b=0;b<v;){if(A==0)for(;b<=E;)i(this,N,b),b+=this.blockSize;if(typeof N=="string"){for(;b<v;)if(x[A++]=N.charCodeAt(b++),A==this.blockSize){i(this,x),A=0;break}}else for(;b<v;)if(x[A++]=N[b++],A==this.blockSize){i(this,x),A=0;break}}this.h=A,this.o+=v},r.prototype.v=function(){var N=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);N[0]=128;for(var v=1;v<N.length-8;++v)N[v]=0;var E=8*this.o;for(v=N.length-8;v<N.length;++v)N[v]=E&255,E/=256;for(this.u(N),N=Array(16),v=E=0;4>v;++v)for(var x=0;32>x;x+=8)N[E++]=this.g[v]>>>x&255;return N};function s(N,v){var E=l;return Object.prototype.hasOwnProperty.call(E,N)?E[N]:E[N]=v(N)}function a(N,v){this.h=v;for(var E=[],x=!0,A=N.length-1;0<=A;A--){var b=N[A]|0;x&&b==v||(E[A]=b,x=!1)}this.g=E}var l={};function u(N){return-128<=N&&128>N?s(N,function(v){return new a([v|0],0>v?-1:0)}):new a([N|0],0>N?-1:0)}function d(N){if(isNaN(N)||!isFinite(N))return p;if(0>N)return D(d(-N));for(var v=[],E=1,x=0;N>=E;x++)v[x]=N/E|0,E*=4294967296;return new a(v,0)}function m(N,v){if(N.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(N.charAt(0)=="-")return D(m(N.substring(1),v));if(0<=N.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=d(Math.pow(v,8)),x=p,A=0;A<N.length;A+=8){var b=Math.min(8,N.length-A),C=parseInt(N.substring(A,A+b),v);8>b?(b=d(Math.pow(v,b)),x=x.j(b).add(d(C))):(x=x.j(E),x=x.add(d(C)))}return x}var p=u(0),g=u(1),k=u(16777216);t=a.prototype,t.m=function(){if(R(this))return-D(this).m();for(var N=0,v=1,E=0;E<this.g.length;E++){var x=this.i(E);N+=(0<=x?x:4294967296+x)*v,v*=4294967296}return N},t.toString=function(N){if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(S(this))return"0";if(R(this))return"-"+D(this).toString(N);for(var v=d(Math.pow(N,6)),E=this,x="";;){var A=P(E,v).g;E=w(E,A.j(v));var b=((0<E.g.length?E.g[0]:E.h)>>>0).toString(N);if(E=A,S(E))return b+x;for(;6>b.length;)b="0"+b;x=b+x}},t.i=function(N){return 0>N?0:N<this.g.length?this.g[N]:this.h};function S(N){if(N.h!=0)return!1;for(var v=0;v<N.g.length;v++)if(N.g[v]!=0)return!1;return!0}function R(N){return N.h==-1}t.l=function(N){return N=w(this,N),R(N)?-1:S(N)?0:1};function D(N){for(var v=N.g.length,E=[],x=0;x<v;x++)E[x]=~N.g[x];return new a(E,~N.h).add(g)}t.abs=function(){return R(this)?D(this):this},t.add=function(N){for(var v=Math.max(this.g.length,N.g.length),E=[],x=0,A=0;A<=v;A++){var b=x+(this.i(A)&65535)+(N.i(A)&65535),C=(b>>>16)+(this.i(A)>>>16)+(N.i(A)>>>16);x=C>>>16,b&=65535,C&=65535,E[A]=C<<16|b}return new a(E,E[E.length-1]&-2147483648?-1:0)};function w(N,v){return N.add(D(v))}t.j=function(N){if(S(this)||S(N))return p;if(R(this))return R(N)?D(this).j(D(N)):D(D(this).j(N));if(R(N))return D(this.j(D(N)));if(0>this.l(k)&&0>N.l(k))return d(this.m()*N.m());for(var v=this.g.length+N.g.length,E=[],x=0;x<2*v;x++)E[x]=0;for(x=0;x<this.g.length;x++)for(var A=0;A<N.g.length;A++){var b=this.i(x)>>>16,C=this.i(x)&65535,ye=N.i(A)>>>16,Ue=N.i(A)&65535;E[2*x+2*A]+=C*Ue,y(E,2*x+2*A),E[2*x+2*A+1]+=b*Ue,y(E,2*x+2*A+1),E[2*x+2*A+1]+=C*ye,y(E,2*x+2*A+1),E[2*x+2*A+2]+=b*ye,y(E,2*x+2*A+2)}for(x=0;x<v;x++)E[x]=E[2*x+1]<<16|E[2*x];for(x=v;x<2*v;x++)E[x]=0;return new a(E,0)};function y(N,v){for(;(N[v]&65535)!=N[v];)N[v+1]+=N[v]>>>16,N[v]&=65535,v++}function I(N,v){this.g=N,this.h=v}function P(N,v){if(S(v))throw Error("division by zero");if(S(N))return new I(p,p);if(R(N))return v=P(D(N),v),new I(D(v.g),D(v.h));if(R(v))return v=P(N,D(v)),new I(D(v.g),v.h);if(30<N.g.length){if(R(N)||R(v))throw Error("slowDivide_ only works with positive integers.");for(var E=g,x=v;0>=x.l(N);)E=F(E),x=F(x);var A=B(E,1),b=B(x,1);for(x=B(x,2),E=B(E,2);!S(x);){var C=b.add(x);0>=C.l(N)&&(A=A.add(E),b=C),x=B(x,1),E=B(E,1)}return v=w(N,A.j(v)),new I(A,v)}for(A=p;0<=N.l(v);){for(E=Math.max(1,Math.floor(N.m()/v.m())),x=Math.ceil(Math.log(E)/Math.LN2),x=48>=x?1:Math.pow(2,x-48),b=d(E),C=b.j(v);R(C)||0<C.l(N);)E-=x,b=d(E),C=b.j(v);S(b)&&(b=g),A=A.add(b),N=w(N,C)}return new I(A,N)}t.A=function(N){return P(this,N).h},t.and=function(N){for(var v=Math.max(this.g.length,N.g.length),E=[],x=0;x<v;x++)E[x]=this.i(x)&N.i(x);return new a(E,this.h&N.h)},t.or=function(N){for(var v=Math.max(this.g.length,N.g.length),E=[],x=0;x<v;x++)E[x]=this.i(x)|N.i(x);return new a(E,this.h|N.h)},t.xor=function(N){for(var v=Math.max(this.g.length,N.g.length),E=[],x=0;x<v;x++)E[x]=this.i(x)^N.i(x);return new a(E,this.h^N.h)};function F(N){for(var v=N.g.length+1,E=[],x=0;x<v;x++)E[x]=N.i(x)<<1|N.i(x-1)>>>31;return new a(E,N.h)}function B(N,v){var E=v>>5;v%=32;for(var x=N.g.length-E,A=[],b=0;b<x;b++)A[b]=0<v?N.i(b+E)>>>v|N.i(b+E+1)<<32-v:N.i(b+E);return new a(A,N.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,BT=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=m,ii=a}).apply(typeof cv<"u"?cv:typeof self<"u"?self:typeof window<"u"?window:{});var Gl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var zT,Ga,$T,pc,wf,GT,KT,qT;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,h,f){return o==Array.prototype||o==Object.prototype||(o[h]=f.value),o};function n(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof Gl=="object"&&Gl];for(var h=0;h<o.length;++h){var f=o[h];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=n(this);function i(o,h){if(h)e:{var f=r;o=o.split(".");for(var _=0;_<o.length-1;_++){var j=o[_];if(!(j in f))break e;f=f[j]}o=o[o.length-1],_=f[o],h=h(_),h!=_&&h!=null&&e(f,o,{configurable:!0,writable:!0,value:h})}}function s(o,h){o instanceof String&&(o+="");var f=0,_=!1,j={next:function(){if(!_&&f<o.length){var O=f++;return{value:h(O,o[O]),done:!1}}return _=!0,{done:!0,value:void 0}}};return j[Symbol.iterator]=function(){return j},j}i("Array.prototype.values",function(o){return o||function(){return s(this,function(h,f){return f})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},l=this||self;function u(o){var h=typeof o;return h=h!="object"?h:o?Array.isArray(o)?"array":h:"null",h=="array"||h=="object"&&typeof o.length=="number"}function d(o){var h=typeof o;return h=="object"&&o!=null||h=="function"}function m(o,h,f){return o.call.apply(o.bind,arguments)}function p(o,h,f){if(!o)throw Error();if(2<arguments.length){var _=Array.prototype.slice.call(arguments,2);return function(){var j=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(j,_),o.apply(h,j)}}return function(){return o.apply(h,arguments)}}function g(o,h,f){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?m:p,g.apply(null,arguments)}function k(o,h){var f=Array.prototype.slice.call(arguments,1);return function(){var _=f.slice();return _.push.apply(_,arguments),o.apply(this,_)}}function S(o,h){function f(){}f.prototype=h.prototype,o.aa=h.prototype,o.prototype=new f,o.prototype.constructor=o,o.Qb=function(_,j,O){for(var G=Array(arguments.length-2),Ce=2;Ce<arguments.length;Ce++)G[Ce-2]=arguments[Ce];return h.prototype[j].apply(_,G)}}function R(o){const h=o.length;if(0<h){const f=Array(h);for(let _=0;_<h;_++)f[_]=o[_];return f}return[]}function D(o,h){for(let f=1;f<arguments.length;f++){const _=arguments[f];if(u(_)){const j=o.length||0,O=_.length||0;o.length=j+O;for(let G=0;G<O;G++)o[j+G]=_[G]}else o.push(_)}}class w{constructor(h,f){this.i=h,this.j=f,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function y(o){return/^[\s\xa0]*$/.test(o)}function I(){var o=l.navigator;return o&&(o=o.userAgent)?o:""}function P(o){return P[" "](o),o}P[" "]=function(){};var F=I().indexOf("Gecko")!=-1&&!(I().toLowerCase().indexOf("webkit")!=-1&&I().indexOf("Edge")==-1)&&!(I().indexOf("Trident")!=-1||I().indexOf("MSIE")!=-1)&&I().indexOf("Edge")==-1;function B(o,h,f){for(const _ in o)h.call(f,o[_],_,o)}function N(o,h){for(const f in o)h.call(void 0,o[f],f,o)}function v(o){const h={};for(const f in o)h[f]=o[f];return h}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function x(o,h){let f,_;for(let j=1;j<arguments.length;j++){_=arguments[j];for(f in _)o[f]=_[f];for(let O=0;O<E.length;O++)f=E[O],Object.prototype.hasOwnProperty.call(_,f)&&(o[f]=_[f])}}function A(o){var h=1;o=o.split(":");const f=[];for(;0<h&&o.length;)f.push(o.shift()),h--;return o.length&&f.push(o.join(":")),f}function b(o){l.setTimeout(()=>{throw o},0)}function C(){var o=K;let h=null;return o.g&&(h=o.g,o.g=o.g.next,o.g||(o.h=null),h.next=null),h}class ye{constructor(){this.h=this.g=null}add(h,f){const _=Ue.get();_.set(h,f),this.h?this.h.next=_:this.g=_,this.h=_}}var Ue=new w(()=>new be,o=>o.reset());class be{constructor(){this.next=this.g=this.h=null}set(h,f){this.h=h,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let ze,$=!1,K=new ye,Y=()=>{const o=l.Promise.resolve(void 0);ze=()=>{o.then(ve)}};var ve=()=>{for(var o;o=C();){try{o.h.call(o.g)}catch(f){b(f)}var h=Ue;h.j(o),100>h.h&&(h.h++,o.next=h.g,h.g=o)}$=!1};function ue(){this.s=this.s,this.C=this.C}ue.prototype.s=!1,ue.prototype.ma=function(){this.s||(this.s=!0,this.N())},ue.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ie(o,h){this.type=o,this.g=this.target=h,this.defaultPrevented=!1}Ie.prototype.h=function(){this.defaultPrevented=!0};var lt=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var o=!1,h=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const f=()=>{};l.addEventListener("test",f,h),l.removeEventListener("test",f,h)}catch{}return o}();function Ae(o,h){if(Ie.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var f=this.type=o.type,_=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=h,h=o.relatedTarget){if(F){e:{try{P(h.nodeName);var j=!0;break e}catch{}j=!1}j||(h=null)}}else f=="mouseover"?h=o.fromElement:f=="mouseout"&&(h=o.toElement);this.relatedTarget=h,_?(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:xt[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&Ae.aa.h.call(this)}}S(Ae,Ie);var xt={2:"touch",3:"pen",4:"mouse"};Ae.prototype.h=function(){Ae.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var Ye="closure_listenable_"+(1e6*Math.random()|0),yt=0;function $n(o,h,f,_,j){this.listener=o,this.proxy=null,this.src=h,this.type=f,this.capture=!!_,this.ha=j,this.key=++yt,this.da=this.fa=!1}function on(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function ne(o){this.src=o,this.g={},this.h=0}ne.prototype.add=function(o,h,f,_,j){var O=o.toString();o=this.g[O],o||(o=this.g[O]=[],this.h++);var G=de(o,h,_,j);return-1<G?(h=o[G],f||(h.fa=!1)):(h=new $n(h,this.src,O,!!_,j),h.fa=f,o.push(h)),h};function _e(o,h){var f=h.type;if(f in o.g){var _=o.g[f],j=Array.prototype.indexOf.call(_,h,void 0),O;(O=0<=j)&&Array.prototype.splice.call(_,j,1),O&&(on(h),o.g[f].length==0&&(delete o.g[f],o.h--))}}function de(o,h,f,_){for(var j=0;j<o.length;++j){var O=o[j];if(!O.da&&O.listener==h&&O.capture==!!f&&O.ha==_)return j}return-1}var se="closure_lm_"+(1e6*Math.random()|0),Te={};function X(o,h,f,_,j){if(Array.isArray(h)){for(var O=0;O<h.length;O++)X(o,h[O],f,_,j);return null}return f=bt(f),o&&o[Ye]?o.K(h,f,d(_)?!!_.capture:!1,j):ce(o,h,f,!1,_,j)}function ce(o,h,f,_,j,O){if(!h)throw Error("Invalid event type");var G=d(j)?!!j.capture:!!j,Ce=Ct(o);if(Ce||(o[se]=Ce=new ne(o)),f=Ce.add(h,f,_,G,O),f.proxy)return f;if(_=fe(),f.proxy=_,_.src=o,_.listener=f,o.addEventListener)lt||(j=G),j===void 0&&(j=!1),o.addEventListener(h.toString(),_,j);else if(o.attachEvent)o.attachEvent(De(h.toString()),_);else if(o.addListener&&o.removeListener)o.addListener(_);else throw Error("addEventListener and attachEvent are unavailable.");return f}function fe(){function o(f){return h.call(o.src,o.listener,f)}const h=ln;return o}function Je(o,h,f,_,j){if(Array.isArray(h))for(var O=0;O<h.length;O++)Je(o,h[O],f,_,j);else _=d(_)?!!_.capture:!!_,f=bt(f),o&&o[Ye]?(o=o.i,h=String(h).toString(),h in o.g&&(O=o.g[h],f=de(O,f,_,j),-1<f&&(on(O[f]),Array.prototype.splice.call(O,f,1),O.length==0&&(delete o.g[h],o.h--)))):o&&(o=Ct(o))&&(h=o.g[h.toString()],o=-1,h&&(o=de(h,f,_,j)),(f=-1<o?h[o]:null)&&ct(f))}function ct(o){if(typeof o!="number"&&o&&!o.da){var h=o.src;if(h&&h[Ye])_e(h.i,o);else{var f=o.type,_=o.proxy;h.removeEventListener?h.removeEventListener(f,_,o.capture):h.detachEvent?h.detachEvent(De(f),_):h.addListener&&h.removeListener&&h.removeListener(_),(f=Ct(h))?(_e(f,o),f.h==0&&(f.src=null,h[se]=null)):on(o)}}}function De(o){return o in Te?Te[o]:Te[o]="on"+o}function ln(o,h){if(o.da)o=!0;else{h=new Ae(h,this);var f=o.listener,_=o.ha||o.src;o.fa&&ct(o),o=f.call(_,h)}return o}function Ct(o){return o=o[se],o instanceof ne?o:null}var Rt="__closure_events_fn_"+(1e9*Math.random()>>>0);function bt(o){return typeof o=="function"?o:(o[Rt]||(o[Rt]=function(h){return o.handleEvent(h)}),o[Rt])}function Oe(){ue.call(this),this.i=new ne(this),this.M=this,this.F=null}S(Oe,ue),Oe.prototype[Ye]=!0,Oe.prototype.removeEventListener=function(o,h,f,_){Je(this,o,h,f,_)};function Xe(o,h){var f,_=o.F;if(_)for(f=[];_;_=_.F)f.push(_);if(o=o.M,_=h.type||h,typeof h=="string")h=new Ie(h,o);else if(h instanceof Ie)h.target=h.target||o;else{var j=h;h=new Ie(_,o),x(h,j)}if(j=!0,f)for(var O=f.length-1;0<=O;O--){var G=h.g=f[O];j=Gn(G,_,!0,h)&&j}if(G=h.g=o,j=Gn(G,_,!0,h)&&j,j=Gn(G,_,!1,h)&&j,f)for(O=0;O<f.length;O++)G=h.g=f[O],j=Gn(G,_,!1,h)&&j}Oe.prototype.N=function(){if(Oe.aa.N.call(this),this.i){var o=this.i,h;for(h in o.g){for(var f=o.g[h],_=0;_<f.length;_++)on(f[_]);delete o.g[h],o.h--}}this.F=null},Oe.prototype.K=function(o,h,f,_){return this.i.add(String(o),h,!1,f,_)},Oe.prototype.L=function(o,h,f,_){return this.i.add(String(o),h,!0,f,_)};function Gn(o,h,f,_){if(h=o.i.g[String(h)],!h)return!0;h=h.concat();for(var j=!0,O=0;O<h.length;++O){var G=h[O];if(G&&!G.da&&G.capture==f){var Ce=G.listener,_t=G.ha||G.src;G.fa&&_e(o.i,G),j=Ce.call(_t,_)!==!1&&j}}return j&&!_.defaultPrevented}function il(o,h,f){if(typeof o=="function")f&&(o=g(o,f));else if(o&&typeof o.handleEvent=="function")o=g(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:l.setTimeout(o,h||0)}function sl(o){o.g=il(()=>{o.g=null,o.i&&(o.i=!1,sl(o))},o.l);const h=o.h;o.h=null,o.m.apply(null,h)}class dd extends ue{constructor(h,f){super(),this.m=h,this.l=f,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:sl(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ki(o){ue.call(this),this.h=o,this.g={}}S(ki,ue);var ya=[];function al(o){B(o.g,function(h,f){this.g.hasOwnProperty(f)&&ct(h)},o),o.g={}}ki.prototype.N=function(){ki.aa.N.call(this),al(this)},ki.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var va=l.JSON.stringify,_a=l.JSON.parse,ol=class{stringify(o){return l.JSON.stringify(o,void 0)}parse(o){return l.JSON.parse(o,void 0)}};function wa(){}wa.prototype.h=null;function ll(o){return o.h||(o.h=o.i())}function cl(){}var Dr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function os(){Ie.call(this,"d")}S(os,Ie);function Ii(){Ie.call(this,"c")}S(Ii,Ie);var Wt={},jr=null;function ls(){return jr=jr||new Oe}Wt.La="serverreachability";function cs(o){Ie.call(this,Wt.La,o)}S(cs,Ie);function sr(o){const h=ls();Xe(h,new cs(h))}Wt.STAT_EVENT="statevent";function ul(o,h){Ie.call(this,Wt.STAT_EVENT,o),this.stat=h}S(ul,Ie);function vt(o){const h=ls();Xe(h,new ul(h,o))}Wt.Ma="timingevent";function dl(o,h){Ie.call(this,Wt.Ma,o),this.size=h}S(dl,Ie);function Si(o,h){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){o()},h)}function Ai(){this.g=!0}Ai.prototype.xa=function(){this.g=!1};function hd(o,h,f,_,j,O){o.info(function(){if(o.g)if(O)for(var G="",Ce=O.split("&"),_t=0;_t<Ce.length;_t++){var ke=Ce[_t].split("=");if(1<ke.length){var Dt=ke[0];ke=ke[1];var jt=Dt.split("_");G=2<=jt.length&&jt[1]=="type"?G+(Dt+"="+ke+"&"):G+(Dt+"=redacted&")}}else G=null;else G=O;return"XMLHTTP REQ ("+_+") [attempt "+j+"]: "+h+`
`+f+`
`+G})}function fd(o,h,f,_,j,O,G){o.info(function(){return"XMLHTTP RESP ("+_+") [ attempt "+j+"]: "+h+`
`+f+`
`+O+" "+G})}function Rn(o,h,f,_){o.info(function(){return"XMLHTTP TEXT ("+h+"): "+md(o,f)+(_?" "+_:"")})}function hl(o,h){o.info(function(){return"TIMEOUT: "+h})}Ai.prototype.info=function(){};function md(o,h){if(!o.g)return h;if(!h)return null;try{var f=JSON.parse(h);if(f){for(o=0;o<f.length;o++)if(Array.isArray(f[o])){var _=f[o];if(!(2>_.length)){var j=_[1];if(Array.isArray(j)&&!(1>j.length)){var O=j[0];if(O!="noop"&&O!="stop"&&O!="close")for(var G=1;G<j.length;G++)j[G]=""}}}}return va(f)}catch{return h}}var Kn={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ea={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},us;function T(){}S(T,wa),T.prototype.g=function(){return new XMLHttpRequest},T.prototype.i=function(){return{}},us=new T;function U(o,h,f,_){this.j=o,this.i=h,this.l=f,this.R=_||1,this.U=new ki(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new J}function J(){this.i=null,this.g="",this.h=!1}var Z={},q={};function ee(o,h,f){o.L=1,o.v=yl(ar(h)),o.m=f,o.P=!0,ft(o,null)}function ft(o,h){o.F=Date.now(),ml(o),o.A=ar(o.v);var f=o.A,_=o.R;Array.isArray(_)||(_=[String(_)]),tg(f.i,"t",_),o.C=0,f=o.j.J,o.h=new J,o.g=_g(o.j,f?h:null,!o.m),0<o.O&&(o.M=new dd(g(o.Y,o,o.g),o.O)),h=o.U,f=o.g,_=o.ca;var j="readystatechange";Array.isArray(j)||(j&&(ya[0]=j.toString()),j=ya);for(var O=0;O<j.length;O++){var G=X(f,j[O],_||h.handleEvent,!1,h.h||h);if(!G)break;h.g[G.key]=G}h=o.H?v(o.H):{},o.m?(o.u||(o.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,h)):(o.u="GET",o.g.ea(o.A,o.u,null,h)),sr(),hd(o.i,o.u,o.A,o.l,o.R,o.m)}U.prototype.ca=function(o){o=o.target;const h=this.M;h&&or(o)==3?h.j():this.Y(o)},U.prototype.Y=function(o){try{if(o==this.g)e:{const jt=or(this.g);var h=this.g.Ba();const fs=this.g.Z();if(!(3>jt)&&(jt!=3||this.g&&(this.h.h||this.g.oa()||lg(this.g)))){this.J||jt!=4||h==7||(h==8||0>=fs?sr(3):sr(2)),pd(this);var f=this.g.Z();this.X=f;t:if(bn(this)){var _=lg(this.g);o="";var j=_.length,O=or(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ni(this),Ta(this);var G="";break t}this.h.i=new l.TextDecoder}for(h=0;h<j;h++)this.h.h=!0,o+=this.h.i.decode(_[h],{stream:!(O&&h==j-1)});_.length=0,this.h.g+=o,this.C=0,G=this.h.g}else G=this.g.oa();if(this.o=f==200,fd(this.i,this.u,this.A,this.l,this.R,jt,f),this.o){if(this.T&&!this.K){t:{if(this.g){var Ce,_t=this.g;if((Ce=_t.g?_t.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(Ce)){var ke=Ce;break t}}ke=null}if(f=ke)Rn(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,gd(this,f);else{this.o=!1,this.s=3,vt(12),Ni(this),Ta(this);break e}}if(this.P){f=!0;let Dn;for(;!this.J&&this.C<G.length;)if(Dn=fl(this,G),Dn==q){jt==4&&(this.s=4,vt(14),f=!1),Rn(this.i,this.l,null,"[Incomplete Response]");break}else if(Dn==Z){this.s=4,vt(15),Rn(this.i,this.l,G,"[Invalid Chunk]"),f=!1;break}else Rn(this.i,this.l,Dn,null),gd(this,Dn);if(bn(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),jt!=4||G.length!=0||this.h.h||(this.s=1,vt(16),f=!1),this.o=this.o&&f,!f)Rn(this.i,this.l,G,"[Invalid Chunked Response]"),Ni(this),Ta(this);else if(0<G.length&&!this.W){this.W=!0;var Dt=this.j;Dt.g==this&&Dt.ba&&!Dt.M&&(Dt.j.info("Great, no buffering proxy detected. Bytes received: "+G.length),Td(Dt),Dt.M=!0,vt(11))}}else Rn(this.i,this.l,G,null),gd(this,G);jt==4&&Ni(this),this.o&&!this.J&&(jt==4?pg(this.j,this):(this.o=!1,ml(this)))}else pS(this.g),f==400&&0<G.indexOf("Unknown SID")?(this.s=3,vt(12)):(this.s=0,vt(13)),Ni(this),Ta(this)}}}catch{}finally{}};function bn(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function fl(o,h){var f=o.C,_=h.indexOf(`
`,f);return _==-1?q:(f=Number(h.substring(f,_)),isNaN(f)?Z:(_+=1,_+f>h.length?q:(h=h.slice(_,_+f),o.C=_+f,h)))}U.prototype.cancel=function(){this.J=!0,Ni(this)};function ml(o){o.S=Date.now()+o.I,$p(o,o.I)}function $p(o,h){if(o.B!=null)throw Error("WatchDog timer not null");o.B=Si(g(o.ba,o),h)}function pd(o){o.B&&(l.clearTimeout(o.B),o.B=null)}U.prototype.ba=function(){this.B=null;const o=Date.now();0<=o-this.S?(hl(this.i,this.A),this.L!=2&&(sr(),vt(17)),Ni(this),this.s=2,Ta(this)):$p(this,this.S-o)};function Ta(o){o.j.G==0||o.J||pg(o.j,o)}function Ni(o){pd(o);var h=o.M;h&&typeof h.ma=="function"&&h.ma(),o.M=null,al(o.U),o.g&&(h=o.g,o.g=null,h.abort(),h.ma())}function gd(o,h){try{var f=o.j;if(f.G!=0&&(f.g==o||yd(f.h,o))){if(!o.K&&yd(f.h,o)&&f.G==3){try{var _=f.Da.g.parse(h)}catch{_=null}if(Array.isArray(_)&&_.length==3){var j=_;if(j[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<o.F)kl(f),El(f);else break e;Ed(f),vt(18)}}else f.za=j[1],0<f.za-f.T&&37500>j[2]&&f.F&&f.v==0&&!f.C&&(f.C=Si(g(f.Za,f),6e3));if(1>=qp(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else Ci(f,11)}else if((o.K||f.g==o)&&kl(f),!y(h))for(j=f.Da.g.parse(h),h=0;h<j.length;h++){let ke=j[h];if(f.T=ke[0],ke=ke[1],f.G==2)if(ke[0]=="c"){f.K=ke[1],f.ia=ke[2];const Dt=ke[3];Dt!=null&&(f.la=Dt,f.j.info("VER="+f.la));const jt=ke[4];jt!=null&&(f.Aa=jt,f.j.info("SVER="+f.Aa));const fs=ke[5];fs!=null&&typeof fs=="number"&&0<fs&&(_=1.5*fs,f.L=_,f.j.info("backChannelRequestTimeoutMs_="+_)),_=f;const Dn=o.g;if(Dn){const Sl=Dn.g?Dn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Sl){var O=_.h;O.g||Sl.indexOf("spdy")==-1&&Sl.indexOf("quic")==-1&&Sl.indexOf("h2")==-1||(O.j=O.l,O.g=new Set,O.h&&(vd(O,O.h),O.h=null))}if(_.D){const kd=Dn.g?Dn.g.getResponseHeader("X-HTTP-Session-Id"):null;kd&&(_.ya=kd,Me(_.I,_.D,kd))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-o.F,f.j.info("Handshake RTT: "+f.R+"ms")),_=f;var G=o;if(_.qa=vg(_,_.J?_.ia:null,_.W),G.K){Hp(_.h,G);var Ce=G,_t=_.L;_t&&(Ce.I=_t),Ce.B&&(pd(Ce),ml(Ce)),_.g=G}else fg(_);0<f.i.length&&Tl(f)}else ke[0]!="stop"&&ke[0]!="close"||Ci(f,7);else f.G==3&&(ke[0]=="stop"||ke[0]=="close"?ke[0]=="stop"?Ci(f,7):wd(f):ke[0]!="noop"&&f.l&&f.l.ta(ke),f.v=0)}}sr(4)}catch{}}var ZI=class{constructor(o,h){this.g=o,this.map=h}};function Gp(o){this.l=o||10,l.PerformanceNavigationTiming?(o=l.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Kp(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function qp(o){return o.h?1:o.g?o.g.size:0}function yd(o,h){return o.h?o.h==h:o.g?o.g.has(h):!1}function vd(o,h){o.g?o.g.add(h):o.h=h}function Hp(o,h){o.h&&o.h==h?o.h=null:o.g&&o.g.has(h)&&o.g.delete(h)}Gp.prototype.cancel=function(){if(this.i=Wp(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function Wp(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let h=o.i;for(const f of o.g.values())h=h.concat(f.D);return h}return R(o.i)}function eS(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(u(o)){for(var h=[],f=o.length,_=0;_<f;_++)h.push(o[_]);return h}h=[],f=0;for(_ in o)h[f++]=o[_];return h}function tS(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(u(o)||typeof o=="string"){var h=[];o=o.length;for(var f=0;f<o;f++)h.push(f);return h}h=[],f=0;for(const _ in o)h[f++]=_;return h}}}function Qp(o,h){if(o.forEach&&typeof o.forEach=="function")o.forEach(h,void 0);else if(u(o)||typeof o=="string")Array.prototype.forEach.call(o,h,void 0);else for(var f=tS(o),_=eS(o),j=_.length,O=0;O<j;O++)h.call(void 0,_[O],f&&f[O],o)}var Yp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function nS(o,h){if(o){o=o.split("&");for(var f=0;f<o.length;f++){var _=o[f].indexOf("="),j=null;if(0<=_){var O=o[f].substring(0,_);j=o[f].substring(_+1)}else O=o[f];h(O,j?decodeURIComponent(j.replace(/\+/g," ")):"")}}}function xi(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof xi){this.h=o.h,pl(this,o.j),this.o=o.o,this.g=o.g,gl(this,o.s),this.l=o.l;var h=o.i,f=new Sa;f.i=h.i,h.g&&(f.g=new Map(h.g),f.h=h.h),Jp(this,f),this.m=o.m}else o&&(h=String(o).match(Yp))?(this.h=!1,pl(this,h[1]||"",!0),this.o=ka(h[2]||""),this.g=ka(h[3]||"",!0),gl(this,h[4]),this.l=ka(h[5]||"",!0),Jp(this,h[6]||"",!0),this.m=ka(h[7]||"")):(this.h=!1,this.i=new Sa(null,this.h))}xi.prototype.toString=function(){var o=[],h=this.j;h&&o.push(Ia(h,Xp,!0),":");var f=this.g;return(f||h=="file")&&(o.push("//"),(h=this.o)&&o.push(Ia(h,Xp,!0),"@"),o.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&o.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&o.push("/"),o.push(Ia(f,f.charAt(0)=="/"?sS:iS,!0))),(f=this.i.toString())&&o.push("?",f),(f=this.m)&&o.push("#",Ia(f,oS)),o.join("")};function ar(o){return new xi(o)}function pl(o,h,f){o.j=f?ka(h,!0):h,o.j&&(o.j=o.j.replace(/:$/,""))}function gl(o,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);o.s=h}else o.s=null}function Jp(o,h,f){h instanceof Sa?(o.i=h,lS(o.i,o.h)):(f||(h=Ia(h,aS)),o.i=new Sa(h,o.h))}function Me(o,h,f){o.i.set(h,f)}function yl(o){return Me(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function ka(o,h){return o?h?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function Ia(o,h,f){return typeof o=="string"?(o=encodeURI(o).replace(h,rS),f&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function rS(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var Xp=/[#\/\?@]/g,iS=/[#\?:]/g,sS=/[#\?]/g,aS=/[#\?@]/g,oS=/#/g;function Sa(o,h){this.h=this.g=null,this.i=o||null,this.j=!!h}function Pr(o){o.g||(o.g=new Map,o.h=0,o.i&&nS(o.i,function(h,f){o.add(decodeURIComponent(h.replace(/\+/g," ")),f)}))}t=Sa.prototype,t.add=function(o,h){Pr(this),this.i=null,o=ds(this,o);var f=this.g.get(o);return f||this.g.set(o,f=[]),f.push(h),this.h+=1,this};function Zp(o,h){Pr(o),h=ds(o,h),o.g.has(h)&&(o.i=null,o.h-=o.g.get(h).length,o.g.delete(h))}function eg(o,h){return Pr(o),h=ds(o,h),o.g.has(h)}t.forEach=function(o,h){Pr(this),this.g.forEach(function(f,_){f.forEach(function(j){o.call(h,j,_,this)},this)},this)},t.na=function(){Pr(this);const o=Array.from(this.g.values()),h=Array.from(this.g.keys()),f=[];for(let _=0;_<h.length;_++){const j=o[_];for(let O=0;O<j.length;O++)f.push(h[_])}return f},t.V=function(o){Pr(this);let h=[];if(typeof o=="string")eg(this,o)&&(h=h.concat(this.g.get(ds(this,o))));else{o=Array.from(this.g.values());for(let f=0;f<o.length;f++)h=h.concat(o[f])}return h},t.set=function(o,h){return Pr(this),this.i=null,o=ds(this,o),eg(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[h]),this.h+=1,this},t.get=function(o,h){return o?(o=this.V(o),0<o.length?String(o[0]):h):h};function tg(o,h,f){Zp(o,h),0<f.length&&(o.i=null,o.g.set(ds(o,h),R(f)),o.h+=f.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],h=Array.from(this.g.keys());for(var f=0;f<h.length;f++){var _=h[f];const O=encodeURIComponent(String(_)),G=this.V(_);for(_=0;_<G.length;_++){var j=O;G[_]!==""&&(j+="="+encodeURIComponent(String(G[_]))),o.push(j)}}return this.i=o.join("&")};function ds(o,h){return h=String(h),o.j&&(h=h.toLowerCase()),h}function lS(o,h){h&&!o.j&&(Pr(o),o.i=null,o.g.forEach(function(f,_){var j=_.toLowerCase();_!=j&&(Zp(this,_),tg(this,j,f))},o)),o.j=h}function cS(o,h){const f=new Ai;if(l.Image){const _=new Image;_.onload=k(Or,f,"TestLoadImage: loaded",!0,h,_),_.onerror=k(Or,f,"TestLoadImage: error",!1,h,_),_.onabort=k(Or,f,"TestLoadImage: abort",!1,h,_),_.ontimeout=k(Or,f,"TestLoadImage: timeout",!1,h,_),l.setTimeout(function(){_.ontimeout&&_.ontimeout()},1e4),_.src=o}else h(!1)}function uS(o,h){const f=new Ai,_=new AbortController,j=setTimeout(()=>{_.abort(),Or(f,"TestPingServer: timeout",!1,h)},1e4);fetch(o,{signal:_.signal}).then(O=>{clearTimeout(j),O.ok?Or(f,"TestPingServer: ok",!0,h):Or(f,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(j),Or(f,"TestPingServer: error",!1,h)})}function Or(o,h,f,_,j){try{j&&(j.onload=null,j.onerror=null,j.onabort=null,j.ontimeout=null),_(f)}catch{}}function dS(){this.g=new ol}function hS(o,h,f){const _=f||"";try{Qp(o,function(j,O){let G=j;d(j)&&(G=va(j)),h.push(_+O+"="+encodeURIComponent(G))})}catch(j){throw h.push(_+"type="+encodeURIComponent("_badmap")),j}}function vl(o){this.l=o.Ub||null,this.j=o.eb||!1}S(vl,wa),vl.prototype.g=function(){return new _l(this.l,this.j)},vl.prototype.i=function(o){return function(){return o}}({});function _l(o,h){Oe.call(this),this.D=o,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}S(_l,Oe),t=_l.prototype,t.open=function(o,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=h,this.readyState=1,Na(this)},t.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(h.body=o),(this.D||l).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Aa(this)),this.readyState=0},t.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,Na(this)),this.g&&(this.readyState=3,Na(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ng(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function ng(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}t.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var h=o.value?o.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!o.done}))&&(this.response=this.responseText+=h)}o.done?Aa(this):Na(this),this.readyState==3&&ng(this)}},t.Ra=function(o){this.g&&(this.response=this.responseText=o,Aa(this))},t.Qa=function(o){this.g&&(this.response=o,Aa(this))},t.ga=function(){this.g&&Aa(this)};function Aa(o){o.readyState=4,o.l=null,o.j=null,o.v=null,Na(o)}t.setRequestHeader=function(o,h){this.u.append(o,h)},t.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],h=this.h.entries();for(var f=h.next();!f.done;)f=f.value,o.push(f[0]+": "+f[1]),f=h.next();return o.join(`\r
`)};function Na(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(_l.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function rg(o){let h="";return B(o,function(f,_){h+=_,h+=":",h+=f,h+=`\r
`}),h}function _d(o,h,f){e:{for(_ in f){var _=!1;break e}_=!0}_||(f=rg(f),typeof o=="string"?f!=null&&encodeURIComponent(String(f)):Me(o,h,f))}function He(o){Oe.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}S(He,Oe);var fS=/^https?$/i,mS=["POST","PUT"];t=He.prototype,t.Ha=function(o){this.J=o},t.ea=function(o,h,f,_){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);h=h?h.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():us.g(),this.v=this.o?ll(this.o):ll(us),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(h,String(o),!0),this.B=!1}catch(O){ig(this,O);return}if(o=f||"",f=new Map(this.headers),_)if(Object.getPrototypeOf(_)===Object.prototype)for(var j in _)f.set(j,_[j]);else if(typeof _.keys=="function"&&typeof _.get=="function")for(const O of _.keys())f.set(O,_.get(O));else throw Error("Unknown input type for opt_headers: "+String(_));_=Array.from(f.keys()).find(O=>O.toLowerCase()=="content-type"),j=l.FormData&&o instanceof l.FormData,!(0<=Array.prototype.indexOf.call(mS,h,void 0))||_||j||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[O,G]of f)this.g.setRequestHeader(O,G);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{og(this),this.u=!0,this.g.send(o),this.u=!1}catch(O){ig(this,O)}};function ig(o,h){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=h,o.m=5,sg(o),wl(o)}function sg(o){o.A||(o.A=!0,Xe(o,"complete"),Xe(o,"error"))}t.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,Xe(this,"complete"),Xe(this,"abort"),wl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),wl(this,!0)),He.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?ag(this):this.bb())},t.bb=function(){ag(this)};function ag(o){if(o.h&&typeof a<"u"&&(!o.v[1]||or(o)!=4||o.Z()!=2)){if(o.u&&or(o)==4)il(o.Ea,0,o);else if(Xe(o,"readystatechange"),or(o)==4){o.h=!1;try{const G=o.Z();e:switch(G){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var f;if(!(f=h)){var _;if(_=G===0){var j=String(o.D).match(Yp)[1]||null;!j&&l.self&&l.self.location&&(j=l.self.location.protocol.slice(0,-1)),_=!fS.test(j?j.toLowerCase():"")}f=_}if(f)Xe(o,"complete"),Xe(o,"success");else{o.m=6;try{var O=2<or(o)?o.g.statusText:""}catch{O=""}o.l=O+" ["+o.Z()+"]",sg(o)}}finally{wl(o)}}}}function wl(o,h){if(o.g){og(o);const f=o.g,_=o.v[0]?()=>{}:null;o.g=null,o.v=null,h||Xe(o,"ready");try{f.onreadystatechange=_}catch{}}}function og(o){o.I&&(l.clearTimeout(o.I),o.I=null)}t.isActive=function(){return!!this.g};function or(o){return o.g?o.g.readyState:0}t.Z=function(){try{return 2<or(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(o){if(this.g){var h=this.g.responseText;return o&&h.indexOf(o)==0&&(h=h.substring(o.length)),_a(h)}};function lg(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function pS(o){const h={};o=(o.g&&2<=or(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let _=0;_<o.length;_++){if(y(o[_]))continue;var f=A(o[_]);const j=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const O=h[j]||[];h[j]=O,O.push(f)}N(h,function(_){return _.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function xa(o,h,f){return f&&f.internalChannelParams&&f.internalChannelParams[o]||h}function cg(o){this.Aa=0,this.i=[],this.j=new Ai,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=xa("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=xa("baseRetryDelayMs",5e3,o),this.cb=xa("retryDelaySeedMs",1e4,o),this.Wa=xa("forwardChannelMaxRetries",2,o),this.wa=xa("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Gp(o&&o.concurrentRequestLimit),this.Da=new dS,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=cg.prototype,t.la=8,t.G=1,t.connect=function(o,h,f,_){vt(0),this.W=o,this.H=h||{},f&&_!==void 0&&(this.H.OSID=f,this.H.OAID=_),this.F=this.X,this.I=vg(this,null,this.W),Tl(this)};function wd(o){if(ug(o),o.G==3){var h=o.U++,f=ar(o.I);if(Me(f,"SID",o.K),Me(f,"RID",h),Me(f,"TYPE","terminate"),Ca(o,f),h=new U(o,o.j,h),h.L=2,h.v=yl(ar(f)),f=!1,l.navigator&&l.navigator.sendBeacon)try{f=l.navigator.sendBeacon(h.v.toString(),"")}catch{}!f&&l.Image&&(new Image().src=h.v,f=!0),f||(h.g=_g(h.j,null),h.g.ea(h.v)),h.F=Date.now(),ml(h)}yg(o)}function El(o){o.g&&(Td(o),o.g.cancel(),o.g=null)}function ug(o){El(o),o.u&&(l.clearTimeout(o.u),o.u=null),kl(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&l.clearTimeout(o.s),o.s=null)}function Tl(o){if(!Kp(o.h)&&!o.s){o.s=!0;var h=o.Ga;ze||Y(),$||(ze(),$=!0),K.add(h,o),o.B=0}}function gS(o,h){return qp(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=h.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=Si(g(o.Ga,o,h),gg(o,o.B)),o.B++,!0)}t.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;const j=new U(this,this.j,o);let O=this.o;if(this.S&&(O?(O=v(O),x(O,this.S)):O=this.S),this.m!==null||this.O||(j.H=O,O=null),this.P)e:{for(var h=0,f=0;f<this.i.length;f++){t:{var _=this.i[f];if("__data__"in _.map&&(_=_.map.__data__,typeof _=="string")){_=_.length;break t}_=void 0}if(_===void 0)break;if(h+=_,4096<h){h=f;break e}if(h===4096||f===this.i.length-1){h=f+1;break e}}h=1e3}else h=1e3;h=hg(this,j,h),f=ar(this.I),Me(f,"RID",o),Me(f,"CVER",22),this.D&&Me(f,"X-HTTP-Session-Id",this.D),Ca(this,f),O&&(this.O?h="headers="+encodeURIComponent(String(rg(O)))+"&"+h:this.m&&_d(f,this.m,O)),vd(this.h,j),this.Ua&&Me(f,"TYPE","init"),this.P?(Me(f,"$req",h),Me(f,"SID","null"),j.T=!0,ee(j,f,null)):ee(j,f,h),this.G=2}}else this.G==3&&(o?dg(this,o):this.i.length==0||Kp(this.h)||dg(this))};function dg(o,h){var f;h?f=h.l:f=o.U++;const _=ar(o.I);Me(_,"SID",o.K),Me(_,"RID",f),Me(_,"AID",o.T),Ca(o,_),o.m&&o.o&&_d(_,o.m,o.o),f=new U(o,o.j,f,o.B+1),o.m===null&&(f.H=o.o),h&&(o.i=h.D.concat(o.i)),h=hg(o,f,1e3),f.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),vd(o.h,f),ee(f,_,h)}function Ca(o,h){o.H&&B(o.H,function(f,_){Me(h,_,f)}),o.l&&Qp({},function(f,_){Me(h,_,f)})}function hg(o,h,f){f=Math.min(o.i.length,f);var _=o.l?g(o.l.Na,o.l,o):null;e:{var j=o.i;let O=-1;for(;;){const G=["count="+f];O==-1?0<f?(O=j[0].g,G.push("ofs="+O)):O=0:G.push("ofs="+O);let Ce=!0;for(let _t=0;_t<f;_t++){let ke=j[_t].g;const Dt=j[_t].map;if(ke-=O,0>ke)O=Math.max(0,j[_t].g-100),Ce=!1;else try{hS(Dt,G,"req"+ke+"_")}catch{_&&_(Dt)}}if(Ce){_=G.join("&");break e}}}return o=o.i.splice(0,f),h.D=o,_}function fg(o){if(!o.g&&!o.u){o.Y=1;var h=o.Fa;ze||Y(),$||(ze(),$=!0),K.add(h,o),o.v=0}}function Ed(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=Si(g(o.Fa,o),gg(o,o.v)),o.v++,!0)}t.Fa=function(){if(this.u=null,mg(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=Si(g(this.ab,this),o)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,vt(10),El(this),mg(this))};function Td(o){o.A!=null&&(l.clearTimeout(o.A),o.A=null)}function mg(o){o.g=new U(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var h=ar(o.qa);Me(h,"RID","rpc"),Me(h,"SID",o.K),Me(h,"AID",o.T),Me(h,"CI",o.F?"0":"1"),!o.F&&o.ja&&Me(h,"TO",o.ja),Me(h,"TYPE","xmlhttp"),Ca(o,h),o.m&&o.o&&_d(h,o.m,o.o),o.L&&(o.g.I=o.L);var f=o.g;o=o.ia,f.L=1,f.v=yl(ar(h)),f.m=null,f.P=!0,ft(f,o)}t.Za=function(){this.C!=null&&(this.C=null,El(this),Ed(this),vt(19))};function kl(o){o.C!=null&&(l.clearTimeout(o.C),o.C=null)}function pg(o,h){var f=null;if(o.g==h){kl(o),Td(o),o.g=null;var _=2}else if(yd(o.h,h))f=h.D,Hp(o.h,h),_=1;else return;if(o.G!=0){if(h.o)if(_==1){f=h.m?h.m.length:0,h=Date.now()-h.F;var j=o.B;_=ls(),Xe(_,new dl(_,f)),Tl(o)}else fg(o);else if(j=h.s,j==3||j==0&&0<h.X||!(_==1&&gS(o,h)||_==2&&Ed(o)))switch(f&&0<f.length&&(h=o.h,h.i=h.i.concat(f)),j){case 1:Ci(o,5);break;case 4:Ci(o,10);break;case 3:Ci(o,6);break;default:Ci(o,2)}}}function gg(o,h){let f=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(f*=2),f*h}function Ci(o,h){if(o.j.info("Error code "+h),h==2){var f=g(o.fb,o),_=o.Xa;const j=!_;_=new xi(_||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||pl(_,"https"),yl(_),j?cS(_.toString(),f):uS(_.toString(),f)}else vt(2);o.G=0,o.l&&o.l.sa(h),yg(o),ug(o)}t.fb=function(o){o?(this.j.info("Successfully pinged google.com"),vt(2)):(this.j.info("Failed to ping google.com"),vt(1))};function yg(o){if(o.G=0,o.ka=[],o.l){const h=Wp(o.h);(h.length!=0||o.i.length!=0)&&(D(o.ka,h),D(o.ka,o.i),o.h.i.length=0,R(o.i),o.i.length=0),o.l.ra()}}function vg(o,h,f){var _=f instanceof xi?ar(f):new xi(f);if(_.g!="")h&&(_.g=h+"."+_.g),gl(_,_.s);else{var j=l.location;_=j.protocol,h=h?h+"."+j.hostname:j.hostname,j=+j.port;var O=new xi(null);_&&pl(O,_),h&&(O.g=h),j&&gl(O,j),f&&(O.l=f),_=O}return f=o.D,h=o.ya,f&&h&&Me(_,f,h),Me(_,"VER",o.la),Ca(o,_),_}function _g(o,h,f){if(h&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=o.Ca&&!o.pa?new He(new vl({eb:f})):new He(o.pa),h.Ha(o.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function wg(){}t=wg.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Il(){}Il.prototype.g=function(o,h){return new cn(o,h)};function cn(o,h){Oe.call(this),this.g=new cg(h),this.l=o,this.h=h&&h.messageUrlParams||null,o=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(o?o["X-WebChannel-Content-Type"]=h.messageContentType:o={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(o?o["X-WebChannel-Client-Profile"]=h.va:o={"X-WebChannel-Client-Profile":h.va}),this.g.S=o,(o=h&&h.Sb)&&!y(o)&&(this.g.m=o),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!y(h)&&(this.g.D=h,o=this.h,o!==null&&h in o&&(o=this.h,h in o&&delete o[h])),this.j=new hs(this)}S(cn,Oe),cn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},cn.prototype.close=function(){wd(this.g)},cn.prototype.o=function(o){var h=this.g;if(typeof o=="string"){var f={};f.__data__=o,o=f}else this.u&&(f={},f.__data__=va(o),o=f);h.i.push(new ZI(h.Ya++,o)),h.G==3&&Tl(h)},cn.prototype.N=function(){this.g.l=null,delete this.j,wd(this.g),delete this.g,cn.aa.N.call(this)};function Eg(o){os.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var h=o.__sm__;if(h){e:{for(const f in h){o=f;break e}o=void 0}(this.i=o)&&(o=this.i,h=h!==null&&o in h?h[o]:void 0),this.data=h}else this.data=o}S(Eg,os);function Tg(){Ii.call(this),this.status=1}S(Tg,Ii);function hs(o){this.g=o}S(hs,wg),hs.prototype.ua=function(){Xe(this.g,"a")},hs.prototype.ta=function(o){Xe(this.g,new Eg(o))},hs.prototype.sa=function(o){Xe(this.g,new Tg)},hs.prototype.ra=function(){Xe(this.g,"b")},Il.prototype.createWebChannel=Il.prototype.g,cn.prototype.send=cn.prototype.o,cn.prototype.open=cn.prototype.m,cn.prototype.close=cn.prototype.close,qT=function(){return new Il},KT=function(){return ls()},GT=Wt,wf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Kn.NO_ERROR=0,Kn.TIMEOUT=8,Kn.HTTP_ERROR=6,pc=Kn,Ea.COMPLETE="complete",$T=Ea,cl.EventType=Dr,Dr.OPEN="a",Dr.CLOSE="b",Dr.ERROR="c",Dr.MESSAGE="d",Oe.prototype.listen=Oe.prototype.K,Ga=cl,He.prototype.listenOnce=He.prototype.L,He.prototype.getLastError=He.prototype.Ka,He.prototype.getLastErrorCode=He.prototype.Ba,He.prototype.getStatus=He.prototype.Z,He.prototype.getResponseJson=He.prototype.Oa,He.prototype.getResponseText=He.prototype.oa,He.prototype.send=He.prototype.ea,He.prototype.setWithCredentials=He.prototype.Ha,zT=He}).apply(typeof Gl<"u"?Gl:typeof self<"u"?self:typeof window<"u"?window:{});const uv="@firebase/firestore",dv="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Vt.UNAUTHENTICATED=new Vt(null),Vt.GOOGLE_CREDENTIALS=new Vt("google-credentials-uid"),Vt.FIRST_PARTY=new Vt("first-party-uid"),Vt.MOCK_USER=new Vt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ca="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qi=new Pu("@firebase/firestore");function ps(){return Qi.logLevel}function W(t,...e){if(Qi.logLevel<=me.DEBUG){const n=e.map(Hm);Qi.debug(`Firestore (${ca}): ${t}`,...n)}}function Ar(t,...e){if(Qi.logLevel<=me.ERROR){const n=e.map(Hm);Qi.error(`Firestore (${ca}): ${t}`,...n)}}function Ys(t,...e){if(Qi.logLevel<=me.WARN){const n=e.map(Hm);Qi.warn(`Firestore (${ca}): ${t}`,...n)}}function Hm(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ie(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,HT(t,r,n)}function HT(t,e,n){let r=`FIRESTORE (${ca}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Ar(r),new Error(r)}function Se(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||HT(e,i,r)}function le(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class H extends Cn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class $1{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Vt.UNAUTHENTICATED))}shutdown(){}}class G1{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class K1{constructor(e){this.t=e,this.currentUser=Vt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Se(this.o===void 0,42304);let r=this.i;const i=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let s=new vr;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new vr,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const u=s;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},l=u=>{W("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(W("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new vr)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(W("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Se(typeof r.accessToken=="string",31837,{l:r}),new WT(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Se(e===null||typeof e=="string",2055,{h:e}),new Vt(e)}}class q1{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Vt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class H1{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new q1(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Vt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class hv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class W1{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,dn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Se(this.o===void 0,3512);const r=s=>{s.error!=null&&W("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.m;return this.m=s.token,W("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{W("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):W("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new hv(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Se(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new hv(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q1(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wm{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=Q1(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%62))}return r}}function pe(t,e){return t<e?-1:t>e?1:0}function Ef(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),s=e.charAt(r);if(i!==s)return ih(i)===ih(s)?pe(i,s):ih(i)?1:-1}return pe(t.length,e.length)}const Y1=55296,J1=57343;function ih(t){const e=t.charCodeAt(0);return e>=Y1&&e<=J1}function Js(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fv="__name__";class Wn{constructor(e,n,r){n===void 0?n=0:n>e.length&&ie(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&ie(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Wn.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Wn?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=Wn.compareSegments(e.get(i),n.get(i));if(s!==0)return s}return pe(e.length,n.length)}static compareSegments(e,n){const r=Wn.isNumericId(e),i=Wn.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?Wn.extractNumericId(e).compare(Wn.extractNumericId(n)):Ef(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ii.fromString(e.substring(4,e.length-2))}}class je extends Wn{construct(e,n,r){return new je(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new H(V.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new je(n)}static emptyPath(){return new je([])}}const X1=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Tt extends Wn{construct(e,n,r){return new Tt(e,n,r)}static isValidIdentifier(e){return X1.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Tt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===fv}static keyField(){return new Tt([fv])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new H(V.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new H(V.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new H(V.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else l==="`"?(a=!a,i++):l!=="."||a?(r+=l,i++):(s(),i++)}if(s(),a)throw new H(V.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Tt(n)}static emptyPath(){return new Tt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{constructor(e){this.path=e}static fromPath(e){return new te(je.fromString(e))}static fromName(e){return new te(je.fromString(e).popFirst(5))}static empty(){return new te(je.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&je.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return je.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new te(new je(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QT(t,e,n){if(!n)throw new H(V.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Z1(t,e,n,r){if(e===!0&&r===!0)throw new H(V.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function mv(t){if(!te.isDocumentKey(t))throw new H(V.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function pv(t){if(te.isDocumentKey(t))throw new H(V.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function YT(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Fu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ie(12329,{type:typeof t})}function rn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new H(V.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Fu(t);throw new H(V.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function st(t,e){const n={typeString:t};return e&&(n.value=e),n}function Jo(t,e){if(!YT(t))throw new H(V.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const a=t[r];if(i&&typeof a!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&a!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new H(V.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gv=-62135596800,yv=1e6;class Le{static now(){return Le.fromMillis(Date.now())}static fromDate(e){return Le.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*yv);return new Le(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new H(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new H(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<gv)throw new H(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new H(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/yv}_compareTo(e){return this.seconds===e.seconds?pe(this.nanoseconds,e.nanoseconds):pe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Le._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Jo(e,Le._jsonSchema))return new Le(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-gv;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Le._jsonSchemaVersion="firestore/timestamp/1.0",Le._jsonSchema={type:st("string",Le._jsonSchemaVersion),seconds:st("number"),nanoseconds:st("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{static fromTimestamp(e){return new ae(e)}static min(){return new ae(new Le(0,0))}static max(){return new ae(new Le(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bo=-1;function eR(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=ae.fromTimestamp(r===1e9?new Le(n+1,0):new Le(n,r));return new li(i,te.empty(),e)}function tR(t){return new li(t.readTime,t.key,bo)}class li{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new li(ae.min(),te.empty(),bo)}static max(){return new li(ae.max(),te.empty(),bo)}}function nR(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=te.comparator(t.documentKey,e.documentKey),n!==0?n:pe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class iR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ua(t){if(t.code!==V.FAILED_PRECONDITION||t.message!==rR)throw t;W("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ie(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new L((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof L?n:L.resolve(n)}catch(n){return L.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):L.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):L.reject(n)}static resolve(e){return new L((n,r)=>{n(e)})}static reject(e){return new L((n,r)=>{r(e)})}static waitFor(e){return new L((n,r)=>{let i=0,s=0,a=!1;e.forEach(l=>{++i,l.next(()=>{++s,a&&s===i&&n()},u=>r(u))}),a=!0,s===i&&n()})}static or(e){let n=L.resolve(!1);for(const r of e)n=n.next(i=>i?L.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new L((r,i)=>{const s=e.length,a=new Array(s);let l=0;for(let u=0;u<s;u++){const d=u;n(e[d]).next(m=>{a[d]=m,++l,l===s&&r(a)},m=>i(m))}})}static doWhile(e,n){return new L((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}function sR(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function da(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uu{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Uu.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qm=-1;function Bu(t){return t==null}function Zc(t){return t===0&&1/t==-1/0}function aR(t){return typeof t=="number"&&Number.isInteger(t)&&!Zc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JT="";function oR(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=vv(e)),e=lR(t.get(n),e);return vv(e)}function lR(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case JT:n+="";break;default:n+=s}}return n}function vv(t){return t+JT+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _v(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function wi(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function XT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qe{constructor(e,n){this.comparator=e,this.root=n||Et.EMPTY}insert(e,n){return new qe(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Et.BLACK,null,null))}remove(e){return new qe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Et.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Kl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Kl(this.root,e,this.comparator,!1)}getReverseIterator(){return new Kl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Kl(this.root,e,this.comparator,!0)}}class Kl{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Et{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Et.RED,this.left=i??Et.EMPTY,this.right=s??Et.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Et(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Et.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Et.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Et.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Et.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ie(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ie(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ie(27949);return e+(this.isRed()?0:1)}}Et.EMPTY=null,Et.RED=!0,Et.BLACK=!1;Et.EMPTY=new class{constructor(){this.size=0}get key(){throw ie(57766)}get value(){throw ie(16141)}get color(){throw ie(16727)}get left(){throw ie(29726)}get right(){throw ie(36894)}copy(e,n,r,i,s){return this}insert(e,n,r){return new Et(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e){this.comparator=e,this.data=new qe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new wv(this.data.getIterator())}getIteratorFrom(e){return new wv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof ht)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new ht(this.comparator);return n.data=e,n}}class wv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e){this.fields=e,e.sort(Tt.comparator)}static empty(){return new fn([])}unionWith(e){let n=new ht(Tt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new fn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Js(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new ZT("Invalid base64 string: "+s):s}}(e);return new At(n)}static fromUint8Array(e){const n=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new At(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return pe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}At.EMPTY_BYTE_STRING=new At("");const cR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ci(t){if(Se(!!t,39018),typeof t=="string"){let e=0;const n=cR.exec(t);if(Se(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ze(t.seconds),nanos:Ze(t.nanos)}}function Ze(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ui(t){return typeof t=="string"?At.fromBase64String(t):At.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ek="server_timestamp",tk="__type__",nk="__previous_value__",rk="__local_write_time__";function Ym(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[tk])==null?void 0:r.stringValue)===ek}function zu(t){const e=t.mapValue.fields[nk];return Ym(e)?zu(e):e}function Do(t){const e=ci(t.mapValue.fields[rk].timestampValue);return new Le(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uR{constructor(e,n,r,i,s,a,l,u,d,m){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=m}}const eu="(default)";class jo{constructor(e,n){this.projectId=e,this.database=n||eu}static empty(){return new jo("","")}get isDefaultDatabase(){return this.database===eu}isEqual(e){return e instanceof jo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ik="__type__",dR="__max__",ql={mapValue:{}},sk="__vector__",tu="value";function di(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ym(t)?4:fR(t)?9007199254740991:hR(t)?10:11:ie(28295,{value:t})}function ir(t,e){if(t===e)return!0;const n=di(t);if(n!==di(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Do(t).isEqual(Do(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=ci(i.timestampValue),l=ci(s.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return ui(i.bytesValue).isEqual(ui(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Ze(i.geoPointValue.latitude)===Ze(s.geoPointValue.latitude)&&Ze(i.geoPointValue.longitude)===Ze(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Ze(i.integerValue)===Ze(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=Ze(i.doubleValue),l=Ze(s.doubleValue);return a===l?Zc(a)===Zc(l):isNaN(a)&&isNaN(l)}return!1}(t,e);case 9:return Js(t.arrayValue.values||[],e.arrayValue.values||[],ir);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},l=s.mapValue.fields||{};if(_v(a)!==_v(l))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(l[u]===void 0||!ir(a[u],l[u])))return!1;return!0}(t,e);default:return ie(52216,{left:t})}}function Po(t,e){return(t.values||[]).find(n=>ir(n,e))!==void 0}function Xs(t,e){if(t===e)return 0;const n=di(t),r=di(e);if(n!==r)return pe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return pe(t.booleanValue,e.booleanValue);case 2:return function(s,a){const l=Ze(s.integerValue||s.doubleValue),u=Ze(a.integerValue||a.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return Ev(t.timestampValue,e.timestampValue);case 4:return Ev(Do(t),Do(e));case 5:return Ef(t.stringValue,e.stringValue);case 6:return function(s,a){const l=ui(s),u=ui(a);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const l=s.split("/"),u=a.split("/");for(let d=0;d<l.length&&d<u.length;d++){const m=pe(l[d],u[d]);if(m!==0)return m}return pe(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const l=pe(Ze(s.latitude),Ze(a.latitude));return l!==0?l:pe(Ze(s.longitude),Ze(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Tv(t.arrayValue,e.arrayValue);case 10:return function(s,a){var g,k,S,R;const l=s.fields||{},u=a.fields||{},d=(g=l[tu])==null?void 0:g.arrayValue,m=(k=u[tu])==null?void 0:k.arrayValue,p=pe(((S=d==null?void 0:d.values)==null?void 0:S.length)||0,((R=m==null?void 0:m.values)==null?void 0:R.length)||0);return p!==0?p:Tv(d,m)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===ql.mapValue&&a===ql.mapValue)return 0;if(s===ql.mapValue)return 1;if(a===ql.mapValue)return-1;const l=s.fields||{},u=Object.keys(l),d=a.fields||{},m=Object.keys(d);u.sort(),m.sort();for(let p=0;p<u.length&&p<m.length;++p){const g=Ef(u[p],m[p]);if(g!==0)return g;const k=Xs(l[u[p]],d[m[p]]);if(k!==0)return k}return pe(u.length,m.length)}(t.mapValue,e.mapValue);default:throw ie(23264,{he:n})}}function Ev(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return pe(t,e);const n=ci(t),r=ci(e),i=pe(n.seconds,r.seconds);return i!==0?i:pe(n.nanos,r.nanos)}function Tv(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=Xs(n[i],r[i]);if(s)return s}return pe(n.length,r.length)}function Zs(t){return Tf(t)}function Tf(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=ci(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ui(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return te.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Tf(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${Tf(n.fields[a])}`;return i+"}"}(t.mapValue):ie(61005,{value:t})}function gc(t){switch(di(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=zu(t);return e?16+gc(e):16;case 5:return 2*t.stringValue.length;case 6:return ui(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+gc(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return wi(r.fields,(s,a)=>{i+=s.length+gc(a)}),i}(t.mapValue);default:throw ie(13486,{value:t})}}function kv(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function kf(t){return!!t&&"integerValue"in t}function Jm(t){return!!t&&"arrayValue"in t}function Iv(t){return!!t&&"nullValue"in t}function Sv(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function yc(t){return!!t&&"mapValue"in t}function hR(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[ik])==null?void 0:r.stringValue)===sk}function so(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return wi(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=so(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=so(t.arrayValue.values[n]);return e}return{...t}}function fR(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===dR}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e){this.value=e}static empty(){return new Jt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!yc(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=so(n)}setAll(e){let n=Tt.emptyPath(),r={},i=[];e.forEach((a,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=l.popLast()}a?r[l.lastSegment()]=so(a):i.push(l.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());yc(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ir(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];yc(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){wi(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Jt(so(this.value))}}function ak(t){const e=[];return wi(t.fields,(n,r)=>{const i=new Tt([n]);if(yc(r)){const s=ak(r.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new fn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(e,n,r,i,s,a,l){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=l}static newInvalidDocument(e){return new Ft(e,0,ae.min(),ae.min(),ae.min(),Jt.empty(),0)}static newFoundDocument(e,n,r,i){return new Ft(e,1,n,ae.min(),r,i,0)}static newNoDocument(e,n){return new Ft(e,2,n,ae.min(),ae.min(),Jt.empty(),0)}static newUnknownDocument(e,n){return new Ft(e,3,n,ae.min(),ae.min(),Jt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ae.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Jt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Jt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ae.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ft&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ft(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nu{constructor(e,n){this.position=e,this.inclusive=n}}function Av(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?r=te.comparator(te.fromName(a.referenceValue),n.key):r=Xs(a,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Nv(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ir(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo{constructor(e,n="asc"){this.field=e,this.dir=n}}function mR(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok{}class it extends ok{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new gR(e,n,r):n==="array-contains"?new _R(e,r):n==="in"?new wR(e,r):n==="not-in"?new ER(e,r):n==="array-contains-any"?new TR(e,r):new it(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new yR(e,r):new vR(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Xs(n,this.value)):n!==null&&di(this.value)===di(n)&&this.matchesComparison(Xs(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ie(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class zn extends ok{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new zn(e,n)}matches(e){return lk(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function lk(t){return t.op==="and"}function ck(t){return pR(t)&&lk(t)}function pR(t){for(const e of t.filters)if(e instanceof zn)return!1;return!0}function If(t){if(t instanceof it)return t.field.canonicalString()+t.op.toString()+Zs(t.value);if(ck(t))return t.filters.map(e=>If(e)).join(",");{const e=t.filters.map(n=>If(n)).join(",");return`${t.op}(${e})`}}function uk(t,e){return t instanceof it?function(r,i){return i instanceof it&&r.op===i.op&&r.field.isEqual(i.field)&&ir(r.value,i.value)}(t,e):t instanceof zn?function(r,i){return i instanceof zn&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,l)=>s&&uk(a,i.filters[l]),!0):!1}(t,e):void ie(19439)}function dk(t){return t instanceof it?function(n){return`${n.field.canonicalString()} ${n.op} ${Zs(n.value)}`}(t):t instanceof zn?function(n){return n.op.toString()+" {"+n.getFilters().map(dk).join(" ,")+"}"}(t):"Filter"}class gR extends it{constructor(e,n,r){super(e,n,r),this.key=te.fromName(r.referenceValue)}matches(e){const n=te.comparator(e.key,this.key);return this.matchesComparison(n)}}class yR extends it{constructor(e,n){super(e,"in",n),this.keys=hk("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class vR extends it{constructor(e,n){super(e,"not-in",n),this.keys=hk("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function hk(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>te.fromName(r.referenceValue))}class _R extends it{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Jm(n)&&Po(n.arrayValue,this.value)}}class wR extends it{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Po(this.value.arrayValue,n)}}class ER extends it{constructor(e,n){super(e,"not-in",n)}matches(e){if(Po(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Po(this.value.arrayValue,n)}}class TR extends it{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Jm(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Po(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kR{constructor(e,n=null,r=[],i=[],s=null,a=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=l,this.Te=null}}function xv(t,e=null,n=[],r=[],i=null,s=null,a=null){return new kR(t,e,n,r,i,s,a)}function Xm(t){const e=le(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>If(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Bu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Zs(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Zs(r)).join(",")),e.Te=n}return e.Te}function Zm(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!mR(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!uk(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Nv(t.startAt,e.startAt)&&Nv(t.endAt,e.endAt)}function Sf(t){return te.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ha{constructor(e,n=null,r=[],i=[],s=null,a="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function IR(t,e,n,r,i,s,a,l){return new ha(t,e,n,r,i,s,a,l)}function $u(t){return new ha(t)}function Cv(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function fk(t){return t.collectionGroup!==null}function ao(t){const e=le(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new ht(Tt.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new Oo(s,r))}),n.has(Tt.keyField().canonicalString())||e.Ie.push(new Oo(Tt.keyField(),r))}return e.Ie}function er(t){const e=le(t);return e.Ee||(e.Ee=SR(e,ao(t))),e.Ee}function SR(t,e){if(t.limitType==="F")return xv(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Oo(i.field,s)});const n=t.endAt?new nu(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new nu(t.startAt.position,t.startAt.inclusive):null;return xv(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Af(t,e){const n=t.filters.concat([e]);return new ha(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function ru(t,e,n){return new ha(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Gu(t,e){return Zm(er(t),er(e))&&t.limitType===e.limitType}function mk(t){return`${Xm(er(t))}|lt:${t.limitType}`}function gs(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>dk(i)).join(", ")}]`),Bu(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Zs(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Zs(i)).join(",")),`Target(${r})`}(er(t))}; limitType=${t.limitType})`}function Ku(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):te.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of ao(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(a,l,u){const d=Av(a,l,u);return a.inclusive?d<=0:d<0}(r.startAt,ao(r),i)||r.endAt&&!function(a,l,u){const d=Av(a,l,u);return a.inclusive?d>=0:d>0}(r.endAt,ao(r),i))}(t,e)}function AR(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function pk(t){return(e,n)=>{let r=!1;for(const i of ao(t)){const s=NR(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function NR(t,e,n){const r=t.field.isKeyField()?te.comparator(e.key,n.key):function(s,a,l){const u=a.data.field(s),d=l.data.field(s);return u!==null&&d!==null?Xs(u,d):ie(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ie(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){wi(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return XT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xR=new qe(te.comparator);function Nr(){return xR}const gk=new qe(te.comparator);function Ka(...t){let e=gk;for(const n of t)e=e.insert(n.key,n);return e}function yk(t){let e=gk;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Mi(){return oo()}function vk(){return oo()}function oo(){return new is(t=>t.toString(),(t,e)=>t.isEqual(e))}const CR=new qe(te.comparator),RR=new ht(te.comparator);function ge(...t){let e=RR;for(const n of t)e=e.add(n);return e}const bR=new ht(pe);function DR(){return bR}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ep(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Zc(e)?"-0":e}}function _k(t){return{integerValue:""+t}}function jR(t,e){return aR(e)?_k(e):ep(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qu{constructor(){this._=void 0}}function PR(t,e,n){return t instanceof Mo?function(i,s){const a={fields:{[tk]:{stringValue:ek},[rk]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Ym(s)&&(s=zu(s)),s&&(a.fields[nk]=s),{mapValue:a}}(n,e):t instanceof ea?Ek(t,e):t instanceof Vo?Tk(t,e):function(i,s){const a=wk(i,s),l=Rv(a)+Rv(i.Ae);return kf(a)&&kf(i.Ae)?_k(l):ep(i.serializer,l)}(t,e)}function OR(t,e,n){return t instanceof ea?Ek(t,e):t instanceof Vo?Tk(t,e):n}function wk(t,e){return t instanceof iu?function(r){return kf(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Mo extends qu{}class ea extends qu{constructor(e){super(),this.elements=e}}function Ek(t,e){const n=kk(e);for(const r of t.elements)n.some(i=>ir(i,r))||n.push(r);return{arrayValue:{values:n}}}class Vo extends qu{constructor(e){super(),this.elements=e}}function Tk(t,e){let n=kk(e);for(const r of t.elements)n=n.filter(i=>!ir(i,r));return{arrayValue:{values:n}}}class iu extends qu{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function Rv(t){return Ze(t.integerValue||t.doubleValue)}function kk(t){return Jm(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ik{constructor(e,n){this.field=e,this.transform=n}}function MR(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof ea&&i instanceof ea||r instanceof Vo&&i instanceof Vo?Js(r.elements,i.elements,ir):r instanceof iu&&i instanceof iu?ir(r.Ae,i.Ae):r instanceof Mo&&i instanceof Mo}(t.transform,e.transform)}class VR{constructor(e,n){this.version=e,this.transformResults=n}}class Sn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Sn}static exists(e){return new Sn(void 0,e)}static updateTime(e){return new Sn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function vc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Hu{}function Sk(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new tp(t.key,Sn.none()):new Xo(t.key,t.data,Sn.none());{const n=t.data,r=Jt.empty();let i=new ht(Tt.comparator);for(let s of e.fields)if(!i.has(s)){let a=n.field(s);a===null&&s.length>1&&(s=s.popLast(),a=n.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new Ei(t.key,r,new fn(i.toArray()),Sn.none())}}function LR(t,e,n){t instanceof Xo?function(i,s,a){const l=i.value.clone(),u=Dv(i.fieldTransforms,s,a.transformResults);l.setAll(u),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,n):t instanceof Ei?function(i,s,a){if(!vc(i.precondition,s))return void s.convertToUnknownDocument(a.version);const l=Dv(i.fieldTransforms,s,a.transformResults),u=s.data;u.setAll(Ak(i)),u.setAll(l),s.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,n):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function lo(t,e,n,r){return t instanceof Xo?function(s,a,l,u){if(!vc(s.precondition,a))return l;const d=s.value.clone(),m=jv(s.fieldTransforms,u,a);return d.setAll(m),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof Ei?function(s,a,l,u){if(!vc(s.precondition,a))return l;const d=jv(s.fieldTransforms,u,a),m=a.data;return m.setAll(Ak(s)),m.setAll(d),a.convertToFoundDocument(a.version,m).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(s,a,l){return vc(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(t,e,n)}function FR(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=wk(r.transform,i||null);s!=null&&(n===null&&(n=Jt.empty()),n.set(r.field,s))}return n||null}function bv(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Js(r,i,(s,a)=>MR(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Xo extends Hu{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ei extends Hu{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Ak(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Dv(t,e,n){const r=new Map;Se(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let i=0;i<n.length;i++){const s=t[i],a=s.transform,l=e.data.field(s.field);r.set(s.field,OR(a,l,n[i]))}return r}function jv(t,e,n){const r=new Map;for(const i of t){const s=i.transform,a=n.data.field(i.field);r.set(i.field,PR(s,a,e))}return r}class tp extends Hu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class UR extends Hu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BR{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&LR(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=lo(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=lo(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=vk();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let l=this.applyToLocalView(a,s.mutatedFields);l=n.has(i.key)?null:l;const u=Sk(a,l);u!==null&&r.set(i.key,u),a.isValidDocument()||a.convertToNoDocument(ae.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ge())}isEqual(e){return this.batchId===e.batchId&&Js(this.mutations,e.mutations,(n,r)=>bv(n,r))&&Js(this.baseMutations,e.baseMutations,(n,r)=>bv(n,r))}}class np{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Se(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=function(){return CR}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new np(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zR{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $R{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nt,we;function GR(t){switch(t){case V.OK:return ie(64938);case V.CANCELLED:case V.UNKNOWN:case V.DEADLINE_EXCEEDED:case V.RESOURCE_EXHAUSTED:case V.INTERNAL:case V.UNAVAILABLE:case V.UNAUTHENTICATED:return!1;case V.INVALID_ARGUMENT:case V.NOT_FOUND:case V.ALREADY_EXISTS:case V.PERMISSION_DENIED:case V.FAILED_PRECONDITION:case V.ABORTED:case V.OUT_OF_RANGE:case V.UNIMPLEMENTED:case V.DATA_LOSS:return!0;default:return ie(15467,{code:t})}}function Nk(t){if(t===void 0)return Ar("GRPC error has no .code"),V.UNKNOWN;switch(t){case nt.OK:return V.OK;case nt.CANCELLED:return V.CANCELLED;case nt.UNKNOWN:return V.UNKNOWN;case nt.DEADLINE_EXCEEDED:return V.DEADLINE_EXCEEDED;case nt.RESOURCE_EXHAUSTED:return V.RESOURCE_EXHAUSTED;case nt.INTERNAL:return V.INTERNAL;case nt.UNAVAILABLE:return V.UNAVAILABLE;case nt.UNAUTHENTICATED:return V.UNAUTHENTICATED;case nt.INVALID_ARGUMENT:return V.INVALID_ARGUMENT;case nt.NOT_FOUND:return V.NOT_FOUND;case nt.ALREADY_EXISTS:return V.ALREADY_EXISTS;case nt.PERMISSION_DENIED:return V.PERMISSION_DENIED;case nt.FAILED_PRECONDITION:return V.FAILED_PRECONDITION;case nt.ABORTED:return V.ABORTED;case nt.OUT_OF_RANGE:return V.OUT_OF_RANGE;case nt.UNIMPLEMENTED:return V.UNIMPLEMENTED;case nt.DATA_LOSS:return V.DATA_LOSS;default:return ie(39323,{code:t})}}(we=nt||(nt={}))[we.OK=0]="OK",we[we.CANCELLED=1]="CANCELLED",we[we.UNKNOWN=2]="UNKNOWN",we[we.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",we[we.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",we[we.NOT_FOUND=5]="NOT_FOUND",we[we.ALREADY_EXISTS=6]="ALREADY_EXISTS",we[we.PERMISSION_DENIED=7]="PERMISSION_DENIED",we[we.UNAUTHENTICATED=16]="UNAUTHENTICATED",we[we.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",we[we.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",we[we.ABORTED=10]="ABORTED",we[we.OUT_OF_RANGE=11]="OUT_OF_RANGE",we[we.UNIMPLEMENTED=12]="UNIMPLEMENTED",we[we.INTERNAL=13]="INTERNAL",we[we.UNAVAILABLE=14]="UNAVAILABLE",we[we.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KR(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qR=new ii([4294967295,4294967295],0);function Pv(t){const e=KR().encode(t),n=new BT;return n.update(e),new Uint8Array(n.digest())}function Ov(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new ii([n,r],0),new ii([i,s],0)]}class rp{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new qa(`Invalid padding: ${n}`);if(r<0)throw new qa(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new qa(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new qa(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=ii.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply(ii.fromNumber(r)));return i.compare(qR)===1&&(i=new ii([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=Pv(e),[r,i]=Ov(n);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);if(!this.we(a))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new rp(s,i,n);return r.forEach(l=>a.insert(l)),a}insert(e){if(this.ge===0)return;const n=Pv(e),[r,i]=Ov(n);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);this.Se(a)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class qa extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wu{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Zo.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Wu(ae.min(),i,new qe(pe),Nr(),ge())}}class Zo{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Zo(r,n,ge(),ge(),ge())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c{constructor(e,n,r,i){this.be=e,this.removedTargetIds=n,this.key=r,this.De=i}}class xk{constructor(e,n){this.targetId=e,this.Ce=n}}class Ck{constructor(e,n,r=At.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class Mv{constructor(){this.ve=0,this.Fe=Vv(),this.Me=At.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ge(),n=ge(),r=ge();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:ie(38017,{changeType:s})}}),new Zo(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=Vv()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Se(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class HR{constructor(e){this.Ge=e,this.ze=new Map,this.je=Nr(),this.Je=Hl(),this.He=Hl(),this.Ye=new qe(pe)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:ie(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,i)=>{this.rt(i)&&n(i)})}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const s=i.target;if(Sf(s))if(r===0){const a=new te(s.path);this.et(n,a,Ft.newNoDocument(a,ae.min()))}else Se(r===1,20013,{expectedCount:r});else{const a=this._t(n);if(a!==r){const l=this.ut(e),u=l?this.ct(l,e,a):1;if(u!==0){this.it(n);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let a,l;try{a=ui(r).toUint8Array()}catch(u){if(u instanceof ZT)return Ys("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new rp(a,i,s)}catch(u){return Ys(u instanceof qa?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.ge===0?null:l}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const a=this.Ge.ht(),l=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.et(n,s,null),i++)}),i}Tt(e){const n=new Map;this.ze.forEach((s,a)=>{const l=this.ot(a);if(l){if(s.current&&Sf(l.target)){const u=new te(l.target.path);this.It(u).has(a)||this.Et(a,u)||this.et(a,u,Ft.newNoDocument(u,e))}s.Be&&(n.set(a,s.ke()),s.qe())}});let r=ge();this.He.forEach((s,a)=>{let l=!0;a.forEachWhile(u=>{const d=this.ot(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(s))}),this.je.forEach((s,a)=>a.setReadTime(e));const i=new Wu(e,n,this.Ye,this.je,r);return this.je=Nr(),this.Je=Hl(),this.He=Hl(),this.Ye=new qe(pe),i}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.Qe(n,1):i.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new Mv,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new ht(pe),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new ht(pe),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||W("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Mv),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Hl(){return new qe(te.comparator)}function Vv(){return new qe(te.comparator)}const WR={asc:"ASCENDING",desc:"DESCENDING"},QR={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},YR={and:"AND",or:"OR"};class JR{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Nf(t,e){return t.useProto3Json||Bu(e)?e:{value:e}}function su(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Rk(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function XR(t,e){return su(t,e.toTimestamp())}function tr(t){return Se(!!t,49232),ae.fromTimestamp(function(n){const r=ci(n);return new Le(r.seconds,r.nanos)}(t))}function ip(t,e){return xf(t,e).canonicalString()}function xf(t,e){const n=function(i){return new je(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function bk(t){const e=je.fromString(t);return Se(Mk(e),10190,{key:e.toString()}),e}function Cf(t,e){return ip(t.databaseId,e.path)}function sh(t,e){const n=bk(e);if(n.get(1)!==t.databaseId.projectId)throw new H(V.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new H(V.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new te(jk(n))}function Dk(t,e){return ip(t.databaseId,e)}function ZR(t){const e=bk(t);return e.length===4?je.emptyPath():jk(e)}function Rf(t){return new je(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function jk(t){return Se(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Lv(t,e,n){return{name:Cf(t,e),fields:n.value.mapValue.fields}}function eb(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:ie(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(d,m){return d.useProto3Json?(Se(m===void 0||typeof m=="string",58123),At.fromBase64String(m||"")):(Se(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),At.fromUint8Array(m||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(d){const m=d.code===void 0?V.UNKNOWN:Nk(d.code);return new H(m,d.message||"")}(a);n=new Ck(r,i,s,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=sh(t,r.document.name),s=tr(r.document.updateTime),a=r.document.createTime?tr(r.document.createTime):ae.min(),l=new Jt({mapValue:{fields:r.document.fields}}),u=Ft.newFoundDocument(i,s,a,l),d=r.targetIds||[],m=r.removedTargetIds||[];n=new _c(d,m,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=sh(t,r.document),s=r.readTime?tr(r.readTime):ae.min(),a=Ft.newNoDocument(i,s),l=r.removedTargetIds||[];n=new _c([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=sh(t,r.document),s=r.removedTargetIds||[];n=new _c([],s,i,null)}else{if(!("filter"in e))return ie(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new $R(i,s),l=r.targetId;n=new xk(l,a)}}return n}function tb(t,e){let n;if(e instanceof Xo)n={update:Lv(t,e.key,e.value)};else if(e instanceof tp)n={delete:Cf(t,e.key)};else if(e instanceof Ei)n={update:Lv(t,e.key,e.data),updateMask:ub(e.fieldMask)};else{if(!(e instanceof UR))return ie(16599,{Vt:e.type});n={verify:Cf(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,a){const l=a.transform;if(l instanceof Mo)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof ea)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Vo)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof iu)return{fieldPath:a.field.canonicalString(),increment:l.Ae};throw ie(20930,{transform:a.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:XR(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ie(27497)}(t,e.precondition)),n}function nb(t,e){return t&&t.length>0?(Se(e!==void 0,14353),t.map(n=>function(i,s){let a=i.updateTime?tr(i.updateTime):tr(s);return a.isEqual(ae.min())&&(a=tr(s)),new VR(a,i.transformResults||[])}(n,e))):[]}function rb(t,e){return{documents:[Dk(t,e.path)]}}function ib(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Dk(t,i);const s=function(d){if(d.length!==0)return Ok(zn.create(d,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const a=function(d){if(d.length!==0)return d.map(m=>function(g){return{field:ys(g.field),direction:ob(g.dir)}}(m))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const l=Nf(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:i}}function sb(t){let e=ZR(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Se(r===1,65062);const m=n.from[0];m.allDescendants?i=m.collectionId:e=e.child(m.collectionId)}let s=[];n.where&&(s=function(p){const g=Pk(p);return g instanceof zn&&ck(g)?g.getFilters():[g]}(n.where));let a=[];n.orderBy&&(a=function(p){return p.map(g=>function(S){return new Oo(vs(S.field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction))}(g))}(n.orderBy));let l=null;n.limit&&(l=function(p){let g;return g=typeof p=="object"?p.value:p,Bu(g)?null:g}(n.limit));let u=null;n.startAt&&(u=function(p){const g=!!p.before,k=p.values||[];return new nu(k,g)}(n.startAt));let d=null;return n.endAt&&(d=function(p){const g=!p.before,k=p.values||[];return new nu(k,g)}(n.endAt)),IR(e,i,a,s,l,"F",u,d)}function ab(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ie(28987,{purpose:i})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Pk(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=vs(n.unaryFilter.field);return it.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=vs(n.unaryFilter.field);return it.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=vs(n.unaryFilter.field);return it.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=vs(n.unaryFilter.field);return it.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ie(61313);default:return ie(60726)}}(t):t.fieldFilter!==void 0?function(n){return it.create(vs(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ie(58110);default:return ie(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return zn.create(n.compositeFilter.filters.map(r=>Pk(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ie(1026)}}(n.compositeFilter.op))}(t):ie(30097,{filter:t})}function ob(t){return WR[t]}function lb(t){return QR[t]}function cb(t){return YR[t]}function ys(t){return{fieldPath:t.canonicalString()}}function vs(t){return Tt.fromServerFormat(t.fieldPath)}function Ok(t){return t instanceof it?function(n){if(n.op==="=="){if(Sv(n.value))return{unaryFilter:{field:ys(n.field),op:"IS_NAN"}};if(Iv(n.value))return{unaryFilter:{field:ys(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Sv(n.value))return{unaryFilter:{field:ys(n.field),op:"IS_NOT_NAN"}};if(Iv(n.value))return{unaryFilter:{field:ys(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ys(n.field),op:lb(n.op),value:n.value}}}(t):t instanceof zn?function(n){const r=n.getFilters().map(i=>Ok(i));return r.length===1?r[0]:{compositeFilter:{op:cb(n.op),filters:r}}}(t):ie(54877,{filter:t})}function ub(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Mk(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr{constructor(e,n,r,i,s=ae.min(),a=ae.min(),l=At.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Wr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Wr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Wr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Wr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class db{constructor(e){this.yt=e}}function hb(t){const e=sb({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?ru(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fb{constructor(){this.Cn=new mb}addToCollectionParentIndex(e,n){return this.Cn.add(n),L.resolve()}getCollectionParents(e,n){return L.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return L.resolve()}deleteFieldIndex(e,n){return L.resolve()}deleteAllFieldIndexes(e){return L.resolve()}createTargetIndexes(e,n){return L.resolve()}getDocumentsMatchingTarget(e,n){return L.resolve(null)}getIndexType(e,n){return L.resolve(0)}getFieldIndexes(e,n){return L.resolve([])}getNextCollectionGroupToUpdate(e){return L.resolve(null)}getMinOffset(e,n){return L.resolve(li.min())}getMinOffsetFromCollectionGroup(e,n){return L.resolve(li.min())}updateCollectionGroup(e,n,r){return L.resolve()}updateIndexEntries(e,n){return L.resolve()}}class mb{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new ht(je.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new ht(je.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Vk=41943040;class Qt{static withCacheSize(e){return new Qt(e,Qt.DEFAULT_COLLECTION_PERCENTILE,Qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Qt.DEFAULT_COLLECTION_PERCENTILE=10,Qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Qt.DEFAULT=new Qt(Vk,Qt.DEFAULT_COLLECTION_PERCENTILE,Qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Qt.DISABLED=new Qt(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ta{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new ta(0)}static cr(){return new ta(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uv="LruGarbageCollector",pb=1048576;function Bv([t,e],[n,r]){const i=pe(t,n);return i===0?pe(e,r):i}class gb{constructor(e){this.Ir=e,this.buffer=new ht(Bv),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Bv(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class yb{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){W(Uv,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){da(n)?W(Uv,"Ignoring IndexedDB error during garbage collection: ",n):await ua(n)}await this.Vr(3e5)})}}class vb{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return L.resolve(Uu.ce);const r=new gb(n);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(W("LruGarbageCollector","Garbage collection skipped; disabled"),L.resolve(Fv)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(W("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Fv):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,i,s,a,l,u,d;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(W("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,a=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,l=Date.now(),this.removeTargets(e,r,n))).next(p=>(s=p,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(d=Date.now(),ps()<=me.DEBUG&&W("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-m}ms
	Determined least recently used ${i} in `+(l-a)+`ms
	Removed ${s} targets in `+(u-l)+`ms
	Removed ${p} documents in `+(d-u)+`ms
Total Duration: ${d-m}ms`),L.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p})))}}function _b(t,e){return new vb(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wb{constructor(){this.changes=new is(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ft.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?L.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eb{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tb{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&lo(r.mutation,i,fn.empty(),Le.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ge()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ge()){const i=Mi();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let a=Ka();return s.forEach((l,u)=>{a=a.insert(l,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=Mi();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ge()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,l)=>{n.set(a,l)})})}computeViews(e,n,r,i){let s=Nr();const a=oo(),l=function(){return oo()}();return n.forEach((u,d)=>{const m=r.get(d.key);i.has(d.key)&&(m===void 0||m.mutation instanceof Ei)?s=s.insert(d.key,d):m!==void 0?(a.set(d.key,m.mutation.getFieldMask()),lo(m.mutation,d,m.mutation.getFieldMask(),Le.now())):a.set(d.key,fn.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((d,m)=>a.set(d,m)),n.forEach((d,m)=>l.set(d,new Eb(m,a.get(d)??null))),l))}recalculateAndSaveOverlays(e,n){const r=oo();let i=new qe((a,l)=>a-l),s=ge();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const l of a)l.keys().forEach(u=>{const d=n.get(u);if(d===null)return;let m=r.get(u)||fn.empty();m=l.applyToLocalView(d,m),r.set(u,m);const p=(i.get(l.batchId)||ge()).add(u);i=i.insert(l.batchId,p)})}).next(()=>{const a=[],l=i.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),d=u.key,m=u.value,p=vk();m.forEach(g=>{if(!s.has(g)){const k=Sk(n.get(g),r.get(g));k!==null&&p.set(g,k),s=s.add(g)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,p))}return L.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(a){return te.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):fk(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):L.resolve(Mi());let l=bo,u=s;return a.next(d=>L.forEach(d,(m,p)=>(l<p.largestBatchId&&(l=p.largestBatchId),s.get(m)?L.resolve():this.remoteDocumentCache.getEntry(e,m).next(g=>{u=u.insert(m,g)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,u,d,ge())).next(m=>({batchId:l,changes:yk(m)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new te(n)).next(r=>{let i=Ka();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let a=Ka();return this.indexManager.getCollectionParents(e,s).next(l=>L.forEach(l,u=>{const d=function(p,g){return new ha(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(m=>{m.forEach((p,g)=>{a=a.insert(p,g)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(a=>{s.forEach((u,d)=>{const m=d.getKey();a.get(m)===null&&(a=a.insert(m,Ft.newInvalidDocument(m)))});let l=Ka();return a.forEach((u,d)=>{const m=s.get(u);m!==void 0&&lo(m.mutation,d,fn.empty(),Le.now()),Ku(n,d)&&(l=l.insert(u,d))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kb{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return L.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:tr(i.createTime)}}(n)),L.resolve()}getNamedQuery(e,n){return L.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(i){return{name:i.name,query:hb(i.bundledQuery),readTime:tr(i.readTime)}}(n)),L.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ib{constructor(){this.overlays=new qe(te.comparator),this.qr=new Map}getOverlay(e,n){return L.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Mi();return L.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.St(e,n,s)}),L.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(r)),L.resolve()}getOverlaysForCollection(e,n,r){const i=Mi(),s=n.length+1,a=new te(n.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const u=l.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return L.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new qe((d,m)=>d-m);const a=this.overlays.getIterator();for(;a.hasNext();){const d=a.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let m=s.get(d.largestBatchId);m===null&&(m=Mi(),s=s.insert(d.largestBatchId,m)),m.set(d.getKey(),d)}}const l=Mi(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,m)=>l.set(d,m)),!(l.size()>=i)););return L.resolve(l)}St(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new zR(n,r));let s=this.qr.get(n);s===void 0&&(s=ge(),this.qr.set(n,s)),this.qr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sb{constructor(){this.sessionToken=At.EMPTY_BYTE_STRING}getSessionToken(e){return L.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,L.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp{constructor(){this.Qr=new ht(mt.$r),this.Ur=new ht(mt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new mt(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new mt(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new te(new je([])),r=new mt(n,e),i=new mt(n,e+1),s=[];return this.Ur.forEachInRange([r,i],a=>{this.Gr(a),s.push(a.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new te(new je([])),r=new mt(n,e),i=new mt(n,e+1);let s=ge();return this.Ur.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){const n=new mt(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class mt{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return te.comparator(e.key,n.key)||pe(e.Yr,n.Yr)}static Kr(e,n){return pe(e.Yr,n.Yr)||te.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ab{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new ht(mt.$r)}checkEmpty(e){return L.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new BR(s,n,r,i);this.mutationQueue.push(a);for(const l of i)this.Zr=this.Zr.add(new mt(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return L.resolve(a)}lookupMutationBatch(e,n){return L.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.ei(r),s=i<0?0:i;return L.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return L.resolve(this.mutationQueue.length===0?Qm:this.tr-1)}getAllMutationBatches(e){return L.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new mt(n,0),i=new mt(n,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],a=>{const l=this.Xr(a.Yr);s.push(l)}),L.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new ht(pe);return n.forEach(i=>{const s=new mt(i,0),a=new mt(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,a],l=>{r=r.add(l.Yr)})}),L.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;te.isDocumentKey(s)||(s=s.child(""));const a=new mt(new te(s),0);let l=new ht(pe);return this.Zr.forEachWhile(u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(l=l.add(u.Yr)),!0)},a),L.resolve(this.ti(l))}ti(e){const n=[];return e.forEach(r=>{const i=this.Xr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){Se(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return L.forEach(n.mutations,i=>{const s=new mt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new mt(n,0),i=this.Zr.firstAfterOrEqual(r);return L.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,L.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nb{constructor(e){this.ri=e,this.docs=function(){return new qe(te.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,a=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return L.resolve(r?r.document.mutableCopy():Ft.newInvalidDocument(n))}getEntries(e,n){let r=Nr();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Ft.newInvalidDocument(i))}),L.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Nr();const a=n.path,l=new te(a.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:d,value:{document:m}}=u.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||nR(tR(m),r)<=0||(i.has(m.key)||Ku(n,m))&&(s=s.insert(m.key,m.mutableCopy()))}return L.resolve(s)}getAllFromCollectionGroup(e,n,r,i){ie(9500)}ii(e,n){return L.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new xb(this)}getSize(e){return L.resolve(this.size)}}class xb extends wb{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),L.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cb{constructor(e){this.persistence=e,this.si=new is(n=>Xm(n),Zm),this.lastRemoteSnapshotVersion=ae.min(),this.highestTargetId=0,this.oi=0,this._i=new sp,this.targetCount=0,this.ai=ta.ur()}forEachTarget(e,n){return this.si.forEach((r,i)=>n(i)),L.resolve()}getLastRemoteSnapshotVersion(e){return L.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return L.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),L.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),L.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new ta(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,L.resolve()}updateTargetData(e,n){return this.Pr(n),L.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,L.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.si.forEach((a,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.si.delete(a),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),L.waitFor(s).next(()=>i)}getTargetCount(e){return L.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return L.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),L.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),L.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),L.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return L.resolve(r)}containsKey(e,n){return L.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk{constructor(e,n){this.ui={},this.overlays={},this.ci=new Uu(0),this.li=!1,this.li=!0,this.hi=new Sb,this.referenceDelegate=e(this),this.Pi=new Cb(this),this.indexManager=new fb,this.remoteDocumentCache=function(i){return new Nb(i)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new db(n),this.Ii=new kb(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Ib,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new Ab(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){W("MemoryPersistence","Starting transaction:",e);const i=new Rb(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,n){return L.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class Rb extends iR{constructor(e){super(),this.currentSequenceNumber=e}}class ap{constructor(e){this.persistence=e,this.Ri=new sp,this.Vi=null}static mi(e){return new ap(e)}get fi(){if(this.Vi)return this.Vi;throw ie(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),L.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),L.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),L.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(i=>this.fi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return L.forEach(this.fi,r=>{const i=te.fromPath(r);return this.gi(e,i).next(s=>{s||n.removeEntry(i,ae.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return L.or([()=>L.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class au{constructor(e,n){this.persistence=e,this.pi=new is(r=>oR(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=_b(this,n)}static mi(e,n){return new au(e,n)}Ei(){}di(e){return L.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return L.forEach(this.pi,(r,i)=>this.br(e,r,i).next(s=>s?L.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,a=>this.br(e,a,n).next(l=>{l||(r++,s.removeEntry(a,ae.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),L.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),L.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),L.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),L.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=gc(e.data.value)),n}br(e,n,r){return L.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.pi.get(n);return L.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class op{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=i}static As(e,n){let r=ge(),i=ge();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new op(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bb{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Db{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return oN()?8:sR($t())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.ys(e,n).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ws(e,n,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new bb;return this.Ss(e,n,a).next(l=>{if(s.result=l,this.Vs)return this.bs(e,n,a,l.size)})}).next(()=>s.result)}bs(e,n,r,i){return r.documentReadCount<this.fs?(ps()<=me.DEBUG&&W("QueryEngine","SDK will not create cache indexes for query:",gs(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),L.resolve()):(ps()<=me.DEBUG&&W("QueryEngine","Query:",gs(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(ps()<=me.DEBUG&&W("QueryEngine","The SDK decides to create cache indexes for query:",gs(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,er(n))):L.resolve())}ys(e,n){if(Cv(n))return L.resolve(null);let r=er(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=ru(n,null,"F"),r=er(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const a=ge(...s);return this.ps.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const d=this.Ds(n,l);return this.Cs(n,d,a,u.readTime)?this.ys(e,ru(n,null,"F")):this.vs(e,d,n,u)}))})))}ws(e,n,r,i){return Cv(n)||i.isEqual(ae.min())?L.resolve(null):this.ps.getDocuments(e,r).next(s=>{const a=this.Ds(n,s);return this.Cs(n,a,r,i)?L.resolve(null):(ps()<=me.DEBUG&&W("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),gs(n)),this.vs(e,a,n,eR(i,bo)).next(l=>l))})}Ds(e,n){let r=new ht(pk(e));return n.forEach((i,s)=>{Ku(e,s)&&(r=r.add(s))}),r}Cs(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,n,r){return ps()<=me.DEBUG&&W("QueryEngine","Using full collection scan to execute query:",gs(n)),this.ps.getDocumentsMatchingQuery(e,n,li.min(),r)}vs(e,n,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lp="LocalStore",jb=3e8;class Pb{constructor(e,n,r,i){this.persistence=e,this.Fs=n,this.serializer=i,this.Ms=new qe(pe),this.xs=new is(s=>Xm(s),Zm),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Tb(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function Ob(t,e,n,r){return new Pb(t,e,n,r)}async function Fk(t,e){const n=le(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const a=[],l=[];let u=ge();for(const d of i){a.push(d.batchId);for(const m of d.mutations)u=u.add(m.key)}for(const d of s){l.push(d.batchId);for(const m of d.mutations)u=u.add(m.key)}return n.localDocuments.getDocuments(r,u).next(d=>({Ls:d,removedBatchIds:a,addedBatchIds:l}))})})}function Mb(t,e){const n=le(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.Ns.newChangeBuffer({trackRemovals:!0});return function(l,u,d,m){const p=d.batch,g=p.keys();let k=L.resolve();return g.forEach(S=>{k=k.next(()=>m.getEntry(u,S)).next(R=>{const D=d.docVersions.get(S);Se(D!==null,48541),R.version.compareTo(D)<0&&(p.applyToRemoteDocument(R,d),R.isValidDocument()&&(R.setReadTime(d.commitVersion),m.addEntry(R)))})}),k.next(()=>l.mutationQueue.removeMutationBatch(u,p))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=ge();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(u=u.add(l.batch.mutations[d].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function Uk(t){const e=le(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function Vb(t,e){const n=le(t),r=e.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const l=[];e.targetChanges.forEach((m,p)=>{const g=i.get(p);if(!g)return;l.push(n.Pi.removeMatchingKeys(s,m.removedDocuments,p).next(()=>n.Pi.addMatchingKeys(s,m.addedDocuments,p)));let k=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?k=k.withResumeToken(At.EMPTY_BYTE_STRING,ae.min()).withLastLimboFreeSnapshotVersion(ae.min()):m.resumeToken.approximateByteSize()>0&&(k=k.withResumeToken(m.resumeToken,r)),i=i.insert(p,k),function(R,D,w){return R.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=jb?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(g,k,m)&&l.push(n.Pi.updateTargetData(s,k))});let u=Nr(),d=ge();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(s,m))}),l.push(Lb(s,a,e.documentUpdates).next(m=>{u=m.ks,d=m.qs})),!r.isEqual(ae.min())){const m=n.Pi.getLastRemoteSnapshotVersion(s).next(p=>n.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r));l.push(m)}return L.waitFor(l).next(()=>a.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,u,d)).next(()=>u)}).then(s=>(n.Ms=i,s))}function Lb(t,e,n){let r=ge(),i=ge();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let a=Nr();return n.forEach((l,u)=>{const d=s.get(l);u.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(l)),u.isNoDocument()&&u.version.isEqual(ae.min())?(e.removeEntry(l,u.readTime),a=a.insert(l,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),a=a.insert(l,u)):W(lp,"Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",u.version)}),{ks:a,qs:i}})}function Fb(t,e){const n=le(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Qm),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Ub(t,e){const n=le(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Pi.getTargetData(r,e).next(s=>s?(i=s,L.resolve(i)):n.Pi.allocateTargetId(r).next(a=>(i=new Wr(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function bf(t,e,n){const r=le(t),i=r.Ms.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!da(a))throw a;W(lp,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function zv(t,e,n){const r=le(t);let i=ae.min(),s=ge();return r.persistence.runTransaction("Execute query","readwrite",a=>function(u,d,m){const p=le(u),g=p.xs.get(m);return g!==void 0?L.resolve(p.Ms.get(g)):p.Pi.getTargetData(d,m)}(r,a,er(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,l.targetId).next(u=>{s=u})}).next(()=>r.Fs.getDocumentsMatchingQuery(a,e,n?i:ae.min(),n?s:ge())).next(l=>(Bb(r,AR(e),l),{documents:l,Qs:s})))}function Bb(t,e,n){let r=t.Os.get(e)||ae.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Os.set(e,r)}class $v{constructor(){this.activeTargetIds=DR()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class zb{constructor(){this.Mo=new $v,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new $v,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $b{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gv="ConnectivityMonitor";class Kv{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){W(Gv,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){W(Gv,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wl=null;function Df(){return Wl===null?Wl=function(){return 268435456+Math.round(2147483648*Math.random())}():Wl++,"0x"+Wl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ah="RestConnection",Gb={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Kb{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===eu?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,n,r,i,s){const a=Df(),l=this.zo(e,n.toUriEncodedString());W(ah,`Sending RPC '${e}' ${a}:`,l,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,i,s);const{host:d}=new URL(l),m=ns(d);return this.Jo(e,l,u,r,m).then(p=>(W(ah,`Received RPC '${e}' ${a}: `,p),p),p=>{throw Ys(ah,`RPC '${e}' ${a} failed with error: `,p,"url: ",l,"request:",r),p})}Ho(e,n,r,i,s,a){return this.Go(e,n,r,i,s)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ca}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}zo(e,n){const r=Gb[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qb{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mt="WebChannelConnection";class Hb extends Kb{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,i,s){const a=Df();return new Promise((l,u)=>{const d=new zT;d.setWithCredentials(!0),d.listenOnce($T.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case pc.NO_ERROR:const p=d.getResponseJson();W(Mt,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(p)),l(p);break;case pc.TIMEOUT:W(Mt,`RPC '${e}' ${a} timed out`),u(new H(V.DEADLINE_EXCEEDED,"Request time out"));break;case pc.HTTP_ERROR:const g=d.getStatus();if(W(Mt,`RPC '${e}' ${a} failed with status:`,g,"response text:",d.getResponseText()),g>0){let k=d.getResponseJson();Array.isArray(k)&&(k=k[0]);const S=k==null?void 0:k.error;if(S&&S.status&&S.message){const R=function(w){const y=w.toLowerCase().replace(/_/g,"-");return Object.values(V).indexOf(y)>=0?y:V.UNKNOWN}(S.status);u(new H(R,S.message))}else u(new H(V.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new H(V.UNAVAILABLE,"Connection failed."));break;default:ie(9055,{l_:e,streamId:a,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{W(Mt,`RPC '${e}' ${a} completed.`)}});const m=JSON.stringify(i);W(Mt,`RPC '${e}' ${a} sending request:`,i),d.send(n,"POST",m,r,15)})}T_(e,n,r){const i=Df(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=qT(),l=KT(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const m=s.join("");W(Mt,`Creating RPC '${e}' stream ${i}: ${m}`,u);const p=a.createWebChannel(m,u);this.I_(p);let g=!1,k=!1;const S=new qb({Yo:D=>{k?W(Mt,`Not sending because RPC '${e}' stream ${i} is closed:`,D):(g||(W(Mt,`Opening RPC '${e}' stream ${i} transport.`),p.open(),g=!0),W(Mt,`RPC '${e}' stream ${i} sending:`,D),p.send(D))},Zo:()=>p.close()}),R=(D,w,y)=>{D.listen(w,I=>{try{y(I)}catch(P){setTimeout(()=>{throw P},0)}})};return R(p,Ga.EventType.OPEN,()=>{k||(W(Mt,`RPC '${e}' stream ${i} transport opened.`),S.o_())}),R(p,Ga.EventType.CLOSE,()=>{k||(k=!0,W(Mt,`RPC '${e}' stream ${i} transport closed`),S.a_(),this.E_(p))}),R(p,Ga.EventType.ERROR,D=>{k||(k=!0,Ys(Mt,`RPC '${e}' stream ${i} transport errored. Name:`,D.name,"Message:",D.message),S.a_(new H(V.UNAVAILABLE,"The operation could not be completed")))}),R(p,Ga.EventType.MESSAGE,D=>{var w;if(!k){const y=D.data[0];Se(!!y,16349);const I=y,P=(I==null?void 0:I.error)||((w=I[0])==null?void 0:w.error);if(P){W(Mt,`RPC '${e}' stream ${i} received error:`,P);const F=P.status;let B=function(E){const x=nt[E];if(x!==void 0)return Nk(x)}(F),N=P.message;B===void 0&&(B=V.INTERNAL,N="Unknown error status: "+F+" with message "+P.message),k=!0,S.a_(new H(B,N)),p.close()}else W(Mt,`RPC '${e}' stream ${i} received:`,y),S.u_(y)}}),R(l,GT.STAT_EVENT,D=>{D.stat===wf.PROXY?W(Mt,`RPC '${e}' stream ${i} detected buffering proxy`):D.stat===wf.NOPROXY&&W(Mt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{S.__()},0),S}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function oh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qu(t){return new JR(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bk{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&W("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qv="PersistentStream";class zk{constructor(e,n,r,i,s,a,l,u){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Bk(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===V.RESOURCE_EXHAUSTED?(Ar(n.toString()),Ar("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===V.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===n&&this.G_(r,i)},r=>{e(()=>{const i=new H(V.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return W(qv,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(W(qv,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Wb extends zk{constructor(e,n,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,a),this.serializer=s}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=eb(this.serializer,e),r=function(s){if(!("targetChange"in s))return ae.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?ae.min():a.readTime?tr(a.readTime):ae.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=Rf(this.serializer),n.addTarget=function(s,a){let l;const u=a.target;if(l=Sf(u)?{documents:rb(s,u)}:{query:ib(s,u).ft},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=Rk(s,a.resumeToken);const d=Nf(s,a.expectedCount);d!==null&&(l.expectedCount=d)}else if(a.snapshotVersion.compareTo(ae.min())>0){l.readTime=su(s,a.snapshotVersion.toTimestamp());const d=Nf(s,a.expectedCount);d!==null&&(l.expectedCount=d)}return l}(this.serializer,e);const r=ab(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=Rf(this.serializer),n.removeTarget=e,this.q_(n)}}class Qb extends zk{constructor(e,n,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,a),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return Se(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Se(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Se(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=nb(e.writeResults,e.commitTime),r=tr(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Rf(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>tb(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yb{}class Jb extends Yb{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new H(V.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Go(e,xf(n,r),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new H(V.UNKNOWN,s.toString())})}Ho(e,n,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Ho(e,xf(n,r),i,a,l,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new H(V.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class Xb{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ar(n),this.aa=!1):W("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yi="RemoteStore";class Zb{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(a=>{r.enqueueAndForget(async()=>{ss(this)&&(W(Yi,"Restarting streams for network reachability change."),await async function(u){const d=le(u);d.Ea.add(4),await el(d),d.Ra.set("Unknown"),d.Ea.delete(4),await Yu(d)}(this))})}),this.Ra=new Xb(r,i)}}async function Yu(t){if(ss(t))for(const e of t.da)await e(!0)}async function el(t){for(const e of t.da)await e(!1)}function $k(t,e){const n=le(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),hp(n)?dp(n):fa(n).O_()&&up(n,e))}function cp(t,e){const n=le(t),r=fa(n);n.Ia.delete(e),r.O_()&&Gk(n,e),n.Ia.size===0&&(r.O_()?r.L_():ss(n)&&n.Ra.set("Unknown"))}function up(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ae.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}fa(t).Y_(e)}function Gk(t,e){t.Va.Ue(e),fa(t).Z_(e)}function dp(t){t.Va=new HR({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),fa(t).start(),t.Ra.ua()}function hp(t){return ss(t)&&!fa(t).x_()&&t.Ia.size>0}function ss(t){return le(t).Ea.size===0}function Kk(t){t.Va=void 0}async function eD(t){t.Ra.set("Online")}async function tD(t){t.Ia.forEach((e,n)=>{up(t,e)})}async function nD(t,e){Kk(t),hp(t)?(t.Ra.ha(e),dp(t)):t.Ra.set("Unknown")}async function rD(t,e,n){if(t.Ra.set("Online"),e instanceof Ck&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const l of s.targetIds)i.Ia.has(l)&&(await i.remoteSyncer.rejectListen(l,a),i.Ia.delete(l),i.Va.removeTarget(l))}(t,e)}catch(r){W(Yi,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await ou(t,r)}else if(e instanceof _c?t.Va.Ze(e):e instanceof xk?t.Va.st(e):t.Va.tt(e),!n.isEqual(ae.min()))try{const r=await Uk(t.localStore);n.compareTo(r)>=0&&await function(s,a){const l=s.Va.Tt(a);return l.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const m=s.Ia.get(d);m&&s.Ia.set(d,m.withResumeToken(u.resumeToken,a))}}),l.targetMismatches.forEach((u,d)=>{const m=s.Ia.get(u);if(!m)return;s.Ia.set(u,m.withResumeToken(At.EMPTY_BYTE_STRING,m.snapshotVersion)),Gk(s,u);const p=new Wr(m.target,u,d,m.sequenceNumber);up(s,p)}),s.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){W(Yi,"Failed to raise snapshot:",r),await ou(t,r)}}async function ou(t,e,n){if(!da(e))throw e;t.Ea.add(1),await el(t),t.Ra.set("Offline"),n||(n=()=>Uk(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{W(Yi,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Yu(t)})}function qk(t,e){return e().catch(n=>ou(t,n,e))}async function Ju(t){const e=le(t),n=hi(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Qm;for(;iD(e);)try{const i=await Fb(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,sD(e,i)}catch(i){await ou(e,i)}Hk(e)&&Wk(e)}function iD(t){return ss(t)&&t.Ta.length<10}function sD(t,e){t.Ta.push(e);const n=hi(t);n.O_()&&n.X_&&n.ea(e.mutations)}function Hk(t){return ss(t)&&!hi(t).x_()&&t.Ta.length>0}function Wk(t){hi(t).start()}async function aD(t){hi(t).ra()}async function oD(t){const e=hi(t);for(const n of t.Ta)e.ea(n.mutations)}async function lD(t,e,n){const r=t.Ta.shift(),i=np.from(r,e,n);await qk(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Ju(t)}async function cD(t,e){e&&hi(t).X_&&await async function(r,i){if(function(a){return GR(a)&&a!==V.ABORTED}(i.code)){const s=r.Ta.shift();hi(r).B_(),await qk(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Ju(r)}}(t,e),Hk(t)&&Wk(t)}async function Hv(t,e){const n=le(t);n.asyncQueue.verifyOperationInProgress(),W(Yi,"RemoteStore received new credentials");const r=ss(n);n.Ea.add(3),await el(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Yu(n)}async function uD(t,e){const n=le(t);e?(n.Ea.delete(2),await Yu(n)):e||(n.Ea.add(2),await el(n),n.Ra.set("Unknown"))}function fa(t){return t.ma||(t.ma=function(n,r,i){const s=le(n);return s.sa(),new Wb(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:eD.bind(null,t),t_:tD.bind(null,t),r_:nD.bind(null,t),H_:rD.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),hp(t)?dp(t):t.Ra.set("Unknown")):(await t.ma.stop(),Kk(t))})),t.ma}function hi(t){return t.fa||(t.fa=function(n,r,i){const s=le(n);return s.sa(),new Qb(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:aD.bind(null,t),r_:cD.bind(null,t),ta:oD.bind(null,t),na:lD.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Ju(t)):(await t.fa.stop(),t.Ta.length>0&&(W(Yi,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fp{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new vr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const a=Date.now()+r,l=new fp(e,n,a,i,s);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new H(V.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function mp(t,e){if(Ar("AsyncQueue",`${e}: ${t}`),da(t))return new H(V.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{static emptySet(e){return new zs(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||te.comparator(n.key,r.key):(n,r)=>te.comparator(n.key,r.key),this.keyedMap=Ka(),this.sortedSet=new qe(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof zs)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new zs;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wv{constructor(){this.ga=new qe(te.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):ie(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class na{constructor(e,n,r,i,s,a,l,u,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,i,s){const a=[];return n.forEach(l=>{a.push({type:0,doc:l})}),new na(e,n,zs.emptySet(n),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Gu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dD{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class hD{constructor(){this.queries=Qv(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=le(n),s=i.queries;i.queries=Qv(),s.forEach((a,l)=>{for(const u of l.Sa)u.onError(r)})})(this,new H(V.ABORTED,"Firestore shutting down"))}}function Qv(){return new is(t=>mk(t),Gu)}async function pp(t,e){const n=le(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new dD,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(a){const l=mp(a,`Initialization of query '${gs(e.query)}' failed`);return void e.onError(l)}n.queries.set(i,s),s.Sa.push(e),e.va(n.onlineState),s.wa&&e.Fa(s.wa)&&yp(n)}async function gp(t,e){const n=le(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const a=s.Sa.indexOf(e);a>=0&&(s.Sa.splice(a,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function fD(t,e){const n=le(t);let r=!1;for(const i of e){const s=i.query,a=n.queries.get(s);if(a){for(const l of a.Sa)l.Fa(i)&&(r=!0);a.wa=i}}r&&yp(n)}function mD(t,e,n){const r=le(t),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(e)}function yp(t){t.Ca.forEach(e=>{e.next()})}var jf,Yv;(Yv=jf||(jf={})).Ma="default",Yv.Cache="cache";class vp{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new na(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=na.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==jf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qk{constructor(e){this.key=e}}class Yk{constructor(e){this.key=e}}class pD{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=ge(),this.mutatedKeys=ge(),this.eu=pk(e),this.tu=new zs(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new Wv,i=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,a=i,l=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((m,p)=>{const g=i.get(m),k=Ku(this.query,p)?p:null,S=!!g&&this.mutatedKeys.has(g.key),R=!!k&&(k.hasLocalMutations||this.mutatedKeys.has(k.key)&&k.hasCommittedMutations);let D=!1;g&&k?g.data.isEqual(k.data)?S!==R&&(r.track({type:3,doc:k}),D=!0):this.su(g,k)||(r.track({type:2,doc:k}),D=!0,(u&&this.eu(k,u)>0||d&&this.eu(k,d)<0)&&(l=!0)):!g&&k?(r.track({type:0,doc:k}),D=!0):g&&!k&&(r.track({type:1,doc:g}),D=!0,(u||d)&&(l=!0)),D&&(k?(a=a.add(k),s=R?s.add(m):s.delete(m)):(a=a.delete(m),s=s.delete(m)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const m=this.query.limitType==="F"?a.last():a.first();a=a.delete(m.key),s=s.delete(m.key),r.track({type:1,doc:m})}return{tu:a,iu:r,Cs:l,mutatedKeys:s}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((m,p)=>function(k,S){const R=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ie(20277,{Rt:D})}};return R(k)-R(S)}(m.type,p.type)||this.eu(m.doc,p.doc)),this.ou(r),i=i??!1;const l=n&&!i?this._u():[],u=this.Xa.size===0&&this.current&&!i?1:0,d=u!==this.Za;return this.Za=u,a.length!==0||d?{snapshot:new na(this.query,e.tu,s,a,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Wv,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=ge(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new Yk(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new Qk(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=ge();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return na.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const _p="SyncEngine";class gD{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class yD{constructor(e){this.key=e,this.hu=!1}}class vD{constructor(e,n,r,i,s,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new is(l=>mk(l),Gu),this.Iu=new Map,this.Eu=new Set,this.du=new qe(te.comparator),this.Au=new Map,this.Ru=new sp,this.Vu={},this.mu=new Map,this.fu=ta.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function _D(t,e,n=!0){const r=nI(t);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await Jk(r,e,n,!0),i}async function wD(t,e){const n=nI(t);await Jk(n,e,!0,!1)}async function Jk(t,e,n,r){const i=await Ub(t.localStore,er(e)),s=i.targetId,a=t.sharedClientState.addLocalQueryTarget(s,n);let l;return r&&(l=await ED(t,e,s,a==="current",i.resumeToken)),t.isPrimaryClient&&n&&$k(t.remoteStore,i),l}async function ED(t,e,n,r,i){t.pu=(p,g,k)=>async function(R,D,w,y){let I=D.view.ru(w);I.Cs&&(I=await zv(R.localStore,D.query,!1).then(({documents:N})=>D.view.ru(N,I)));const P=y&&y.targetChanges.get(D.targetId),F=y&&y.targetMismatches.get(D.targetId)!=null,B=D.view.applyChanges(I,R.isPrimaryClient,P,F);return Xv(R,D.targetId,B.au),B.snapshot}(t,p,g,k);const s=await zv(t.localStore,e,!0),a=new pD(e,s.Qs),l=a.ru(s.documents),u=Zo.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),d=a.applyChanges(l,t.isPrimaryClient,u);Xv(t,n,d.au);const m=new gD(e,n,a);return t.Tu.set(e,m),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function TD(t,e,n){const r=le(t),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(a=>!Gu(a,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await bf(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&cp(r.remoteStore,i.targetId),Pf(r,i.targetId)}).catch(ua)):(Pf(r,i.targetId),await bf(r.localStore,i.targetId,!0))}async function kD(t,e){const n=le(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),cp(n.remoteStore,r.targetId))}async function ID(t,e,n){const r=bD(t);try{const i=await function(a,l){const u=le(a),d=Le.now(),m=l.reduce((k,S)=>k.add(S.key),ge());let p,g;return u.persistence.runTransaction("Locally write mutations","readwrite",k=>{let S=Nr(),R=ge();return u.Ns.getEntries(k,m).next(D=>{S=D,S.forEach((w,y)=>{y.isValidDocument()||(R=R.add(w))})}).next(()=>u.localDocuments.getOverlayedDocuments(k,S)).next(D=>{p=D;const w=[];for(const y of l){const I=FR(y,p.get(y.key).overlayedDocument);I!=null&&w.push(new Ei(y.key,I,ak(I.value.mapValue),Sn.exists(!0)))}return u.mutationQueue.addMutationBatch(k,d,w,l)}).next(D=>{g=D;const w=D.applyToLocalDocumentSet(p,R);return u.documentOverlayCache.saveOverlays(k,D.batchId,w)})}).then(()=>({batchId:g.batchId,changes:yk(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,l,u){let d=a.Vu[a.currentUser.toKey()];d||(d=new qe(pe)),d=d.insert(l,u),a.Vu[a.currentUser.toKey()]=d}(r,i.batchId,n),await tl(r,i.changes),await Ju(r.remoteStore)}catch(i){const s=mp(i,"Failed to persist write");n.reject(s)}}async function Xk(t,e){const n=le(t);try{const r=await Vb(n.localStore,e);e.targetChanges.forEach((i,s)=>{const a=n.Au.get(s);a&&(Se(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?Se(a.hu,14607):i.removedDocuments.size>0&&(Se(a.hu,42227),a.hu=!1))}),await tl(n,r,e)}catch(r){await ua(r)}}function Jv(t,e,n){const r=le(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach((s,a)=>{const l=a.view.va(e);l.snapshot&&i.push(l.snapshot)}),function(a,l){const u=le(a);u.onlineState=l;let d=!1;u.queries.forEach((m,p)=>{for(const g of p.Sa)g.va(l)&&(d=!0)}),d&&yp(u)}(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function SD(t,e,n){const r=le(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),s=i&&i.key;if(s){let a=new qe(te.comparator);a=a.insert(s,Ft.newNoDocument(s,ae.min()));const l=ge().add(s),u=new Wu(ae.min(),new Map,new qe(pe),a,l);await Xk(r,u),r.du=r.du.remove(s),r.Au.delete(e),wp(r)}else await bf(r.localStore,e,!1).then(()=>Pf(r,e,n)).catch(ua)}async function AD(t,e){const n=le(t),r=e.batch.batchId;try{const i=await Mb(n.localStore,e);eI(n,r,null),Zk(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await tl(n,i)}catch(i){await ua(i)}}async function ND(t,e,n){const r=le(t);try{const i=await function(a,l){const u=le(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let m;return u.mutationQueue.lookupMutationBatch(d,l).next(p=>(Se(p!==null,37113),m=p.keys(),u.mutationQueue.removeMutationBatch(d,p))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,m,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,m)).next(()=>u.localDocuments.getDocuments(d,m))})}(r.localStore,e);eI(r,e,n),Zk(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await tl(r,i)}catch(i){await ua(i)}}function Zk(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function eI(t,e,n){const r=le(t);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function Pf(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||tI(t,r)})}function tI(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(cp(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),wp(t))}function Xv(t,e,n){for(const r of n)r instanceof Qk?(t.Ru.addReference(r.key,e),xD(t,r)):r instanceof Yk?(W(_p,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||tI(t,r.key)):ie(19791,{wu:r})}function xD(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(W(_p,"New document in limbo: "+n),t.Eu.add(r),wp(t))}function wp(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new te(je.fromString(e)),r=t.fu.next();t.Au.set(r,new yD(n)),t.du=t.du.insert(n,r),$k(t.remoteStore,new Wr(er($u(n.path)),r,"TargetPurposeLimboResolution",Uu.ce))}}async function tl(t,e,n){const r=le(t),i=[],s=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach((l,u)=>{a.push(r.pu(u,e,n).then(d=>{var m;if((d||n)&&r.isPrimaryClient){const p=d?!d.fromCache:(m=n==null?void 0:n.targetChanges.get(u.targetId))==null?void 0:m.current;r.sharedClientState.updateQueryState(u.targetId,p?"current":"not-current")}if(d){i.push(d);const p=op.As(u.targetId,d);s.push(p)}}))}),await Promise.all(a),r.Pu.H_(i),await async function(u,d){const m=le(u);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>L.forEach(d,g=>L.forEach(g.Es,k=>m.persistence.referenceDelegate.addReference(p,g.targetId,k)).next(()=>L.forEach(g.ds,k=>m.persistence.referenceDelegate.removeReference(p,g.targetId,k)))))}catch(p){if(!da(p))throw p;W(lp,"Failed to update sequence numbers: "+p)}for(const p of d){const g=p.targetId;if(!p.fromCache){const k=m.Ms.get(g),S=k.snapshotVersion,R=k.withLastLimboFreeSnapshotVersion(S);m.Ms=m.Ms.insert(g,R)}}}(r.localStore,s))}async function CD(t,e){const n=le(t);if(!n.currentUser.isEqual(e)){W(_p,"User change. New user:",e.toKey());const r=await Fk(n.localStore,e);n.currentUser=e,function(s,a){s.mu.forEach(l=>{l.forEach(u=>{u.reject(new H(V.CANCELLED,a))})}),s.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await tl(n,r.Ls)}}function RD(t,e){const n=le(t),r=n.Au.get(e);if(r&&r.hu)return ge().add(r.key);{let i=ge();const s=n.Iu.get(e);if(!s)return i;for(const a of s){const l=n.Tu.get(a);i=i.unionWith(l.view.nu)}return i}}function nI(t){const e=le(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Xk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=RD.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=SD.bind(null,e),e.Pu.H_=fD.bind(null,e.eventManager),e.Pu.yu=mD.bind(null,e.eventManager),e}function bD(t){const e=le(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=AD.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ND.bind(null,e),e}class lu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Qu(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return Ob(this.persistence,new Db,e.initialUser,this.serializer)}Cu(e){return new Lk(ap.mi,this.serializer)}Du(e){return new zb}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}lu.provider={build:()=>new lu};class DD extends lu{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Se(this.persistence.referenceDelegate instanceof au,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new yb(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Qt.withCacheSize(this.cacheSizeBytes):Qt.DEFAULT;return new Lk(r=>au.mi(r,n),this.serializer)}}class Of{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Jv(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=CD.bind(null,this.syncEngine),await uD(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new hD}()}createDatastore(e){const n=Qu(e.databaseInfo.databaseId),r=function(s){return new Hb(s)}(e.databaseInfo);return function(s,a,l,u){return new Jb(s,a,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,a,l){return new Zb(r,i,s,a,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Jv(this.syncEngine,n,0),function(){return Kv.v()?new Kv:new $b}())}createSyncEngine(e,n){return function(i,s,a,l,u,d,m){const p=new vD(i,s,a,l,u,d);return m&&(p.gu=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=le(i);W(Yi,"RemoteStore shutting down."),s.Ea.add(5),await el(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}Of.provider={build:()=>new Of};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ep{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ar("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fi="FirestoreClient";class jD{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Vt.UNAUTHENTICATED,this.clientId=Wm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async a=>{W(fi,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(W(fi,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new vr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=mp(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function lh(t,e){t.asyncQueue.verifyOperationInProgress(),W(fi,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await Fk(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Zv(t,e){t.asyncQueue.verifyOperationInProgress();const n=await PD(t);W(fi,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Hv(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>Hv(e.remoteStore,i)),t._onlineComponents=e}async function PD(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){W(fi,"Using user provided OfflineComponentProvider");try{await lh(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===V.FAILED_PRECONDITION||i.code===V.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Ys("Error using user provided cache. Falling back to memory cache: "+n),await lh(t,new lu)}}else W(fi,"Using default OfflineComponentProvider"),await lh(t,new DD(void 0));return t._offlineComponents}async function rI(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(W(fi,"Using user provided OnlineComponentProvider"),await Zv(t,t._uninitializedComponentsProvider._online)):(W(fi,"Using default OnlineComponentProvider"),await Zv(t,new Of))),t._onlineComponents}function OD(t){return rI(t).then(e=>e.syncEngine)}async function cu(t){const e=await rI(t),n=e.eventManager;return n.onListen=_D.bind(null,e.syncEngine),n.onUnlisten=TD.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=wD.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=kD.bind(null,e.syncEngine),n}function MD(t,e,n={}){const r=new vr;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,l,u,d){const m=new Ep({next:g=>{m.Nu(),a.enqueueAndForget(()=>gp(s,p));const k=g.docs.has(l);!k&&g.fromCache?d.reject(new H(V.UNAVAILABLE,"Failed to get document because the client is offline.")):k&&g.fromCache&&u&&u.source==="server"?d.reject(new H(V.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(g)},error:g=>d.reject(g)}),p=new vp($u(l.path),m,{includeMetadataChanges:!0,qa:!0});return pp(s,p)}(await cu(t),t.asyncQueue,e,n,r)),r.promise}function VD(t,e,n={}){const r=new vr;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,l,u,d){const m=new Ep({next:g=>{m.Nu(),a.enqueueAndForget(()=>gp(s,p)),g.fromCache&&u.source==="server"?d.reject(new H(V.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(g)},error:g=>d.reject(g)}),p=new vp(l,m,{includeMetadataChanges:!0,qa:!0});return pp(s,p)}(await cu(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iI(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e_=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sI="firestore.googleapis.com",t_=!0;class n_{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new H(V.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=sI,this.ssl=t_}else this.host=e.host,this.ssl=e.ssl??t_;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Vk;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<pb)throw new H(V.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Z1("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=iI(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new H(V.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new H(V.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new H(V.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Xu{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new n_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new H(V.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new H(V.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new n_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new $1;switch(r.type){case"firstParty":return new H1(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new H(V.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=e_.get(n);r&&(W("ComponentProvider","Removing Datastore"),e_.delete(n),r.terminate())}(this),Promise.resolve()}}function LD(t,e,n,r={}){var d;t=rn(t,Xu);const i=ns(e),s=t._getSettings(),a={...s,emulatorOptions:t._getEmulatorOptions()},l=`${e}:${n}`;i&&(Pm(`https://${l}`),Om("Firestore",!0)),s.host!==sI&&s.host!==l&&Ys("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...s,host:l,ssl:i,emulatorOptions:r};if(!kr(u,a)&&(t._setSettings(u),r.mockUserToken)){let m,p;if(typeof r.mockUserToken=="string")m=r.mockUserToken,p=Vt.MOCK_USER;else{m=ZA(r.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new H(V.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new Vt(g)}t._authCredentials=new G1(new WT(m,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new br(this.firestore,e,this._query)}}class Qe{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new si(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Qe(this.firestore,e,this._key)}toJSON(){return{type:Qe._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(Jo(n,Qe._jsonSchema))return new Qe(e,r||null,new te(je.fromString(n.referencePath)))}}Qe._jsonSchemaVersion="firestore/documentReference/1.0",Qe._jsonSchema={type:st("string",Qe._jsonSchemaVersion),referencePath:st("string")};class si extends br{constructor(e,n,r){super(e,n,$u(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Qe(this.firestore,null,new te(e))}withConverter(e){return new si(this.firestore,e,this._path)}}function xe(t,e,...n){if(t=Re(t),QT("collection","path",e),t instanceof Xu){const r=je.fromString(e,...n);return pv(r),new si(t,null,r)}{if(!(t instanceof Qe||t instanceof si))throw new H(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(je.fromString(e,...n));return pv(r),new si(t.firestore,null,r)}}function Nt(t,e,...n){if(t=Re(t),arguments.length===1&&(e=Wm.newId()),QT("doc","path",e),t instanceof Xu){const r=je.fromString(e,...n);return mv(r),new Qe(t,null,new te(r))}{if(!(t instanceof Qe||t instanceof si))throw new H(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(je.fromString(e,...n));return mv(r),new Qe(t.firestore,t instanceof si?t.converter:null,new te(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r_="AsyncQueue";class i_{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Bk(this,"async_queue_retry"),this._c=()=>{const r=oh();r&&W(r_,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=oh();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=oh();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new vr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!da(e))throw e;W(r_,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,Ar("INTERNAL UNHANDLED ERROR: ",s_(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=fp.createAndSchedule(this,e,n,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&ie(47125,{Pc:s_(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function s_(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a_(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class xr extends Xu{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new i_,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new i_(e),this._firestoreClient=void 0,await e}}}function FD(t,e){const n=typeof t=="object"?t:qo(),r=typeof t=="string"?t:eu,i=Rr(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=ZE("firestore");s&&LD(i,...s)}return i}function Zu(t){if(t._terminated)throw new H(V.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||UD(t),t._firestoreClient}function UD(t){var r,i,s;const e=t._freezeSettings(),n=function(l,u,d,m){return new uR(l,u,d,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,iI(m.experimentalLongPollingOptions),m.useFetchStreams,m.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((s=e.localCache)!=null&&s._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new jD(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Tn(At.fromBase64String(e))}catch(n){throw new H(V.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Tn(At.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Tn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Jo(e,Tn._jsonSchema))return Tn.fromBase64String(e.bytes)}}Tn._jsonSchemaVersion="firestore/bytes/1.0",Tn._jsonSchema={type:st("string",Tn._jsonSchemaVersion),bytes:st("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ed{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new H(V.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Tt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new H(V.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new H(V.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return pe(this._lat,e._lat)||pe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:nr._jsonSchemaVersion}}static fromJSON(e){if(Jo(e,nr._jsonSchema))return new nr(e.latitude,e.longitude)}}nr._jsonSchemaVersion="firestore/geoPoint/1.0",nr._jsonSchema={type:st("string",nr._jsonSchemaVersion),latitude:st("number"),longitude:st("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:rr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Jo(e,rr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new rr(e.vectorValues);throw new H(V.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}rr._jsonSchemaVersion="firestore/vectorValue/1.0",rr._jsonSchema={type:st("string",rr._jsonSchemaVersion),vectorValues:st("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BD=/^__.*__$/;class zD{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Ei(e,this.data,this.fieldMask,n,this.fieldTransforms):new Xo(e,this.data,n,this.fieldTransforms)}}class aI{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Ei(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function oI(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ie(40011,{Ac:t})}}class td{constructor(e,n,r,i,s,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new td({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return uu(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(oI(this.Ac)&&BD.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class $D{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Qu(e)}Cc(e,n,r,i=!1){return new td({Ac:e,methodName:n,Dc:r,path:Tt.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function nd(t){const e=t._freezeSettings(),n=Qu(t._databaseId);return new $D(t._databaseId,!!e.ignoreUndefinedProperties,n)}function lI(t,e,n,r,i,s={}){const a=t.Cc(s.merge||s.mergeFields?2:0,e,n,i);Ip("Data must be an object, but it was:",a,r);const l=cI(r,a);let u,d;if(s.merge)u=new fn(a.fieldMask),d=a.fieldTransforms;else if(s.mergeFields){const m=[];for(const p of s.mergeFields){const g=Mf(e,p,n);if(!a.contains(g))throw new H(V.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);dI(m,g)||m.push(g)}u=new fn(m),d=a.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,d=a.fieldTransforms;return new zD(new Jt(l),u,d)}class rd extends nl{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof rd}}function GD(t,e,n){return new td({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Tp extends nl{_toFieldTransform(e){return new Ik(e.path,new Mo)}isEqual(e){return e instanceof Tp}}class kp extends nl{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=GD(this,e,!0),r=this.vc.map(s=>ma(s,n)),i=new ea(r);return new Ik(e.path,i)}isEqual(e){return e instanceof kp&&kr(this.vc,e.vc)}}function KD(t,e,n,r){const i=t.Cc(1,e,n);Ip("Data must be an object, but it was:",i,r);const s=[],a=Jt.empty();wi(r,(u,d)=>{const m=Sp(e,u,n);d=Re(d);const p=i.yc(m);if(d instanceof rd)s.push(m);else{const g=ma(d,p);g!=null&&(s.push(m),a.set(m,g))}});const l=new fn(s);return new aI(a,l,i.fieldTransforms)}function qD(t,e,n,r,i,s){const a=t.Cc(1,e,n),l=[Mf(e,r,n)],u=[i];if(s.length%2!=0)throw new H(V.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)l.push(Mf(e,s[g])),u.push(s[g+1]);const d=[],m=Jt.empty();for(let g=l.length-1;g>=0;--g)if(!dI(d,l[g])){const k=l[g];let S=u[g];S=Re(S);const R=a.yc(k);if(S instanceof rd)d.push(k);else{const D=ma(S,R);D!=null&&(d.push(k),m.set(k,D))}}const p=new fn(d);return new aI(m,p,a.fieldTransforms)}function HD(t,e,n,r=!1){return ma(n,t.Cc(r?4:3,e))}function ma(t,e){if(uI(t=Re(t)))return Ip("Unsupported field value:",e,t),cI(t,e);if(t instanceof nl)return function(r,i){if(!oI(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,i){const s=[];let a=0;for(const l of r){let u=ma(l,i.wc(a));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),a++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Re(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return jR(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Le.fromDate(r);return{timestampValue:su(i.serializer,s)}}if(r instanceof Le){const s=new Le(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:su(i.serializer,s)}}if(r instanceof nr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Tn)return{bytesValue:Rk(i.serializer,r._byteString)};if(r instanceof Qe){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:ip(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof rr)return function(a,l){return{mapValue:{fields:{[ik]:{stringValue:sk},[tu]:{arrayValue:{values:a.toArray().map(d=>{if(typeof d!="number")throw l.Sc("VectorValues must only contain numeric values.");return ep(l.serializer,d)})}}}}}}(r,i);throw i.Sc(`Unsupported field value: ${Fu(r)}`)}(t,e)}function cI(t,e){const n={};return XT(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):wi(t,(r,i)=>{const s=ma(i,e.mc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function uI(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Le||t instanceof nr||t instanceof Tn||t instanceof Qe||t instanceof nl||t instanceof rr)}function Ip(t,e,n){if(!uI(n)||!YT(n)){const r=Fu(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function Mf(t,e,n){if((e=Re(e))instanceof ed)return e._internalPath;if(typeof e=="string")return Sp(t,e);throw uu("Field path arguments must be of type string or ",t,!1,void 0,n)}const WD=new RegExp("[~\\*/\\[\\]]");function Sp(t,e,n){if(e.search(WD)>=0)throw uu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new ed(...e.split("."))._internalPath}catch{throw uu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function uu(t,e,n,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(s||a)&&(u+=" (found",s&&(u+=` in field ${r}`),a&&(u+=` in document ${i}`),u+=")"),new H(V.INVALID_ARGUMENT,l+t+u)}function dI(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hI{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Qe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new QD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(id("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class QD extends hI{data(){return super.data()}}function id(t,e){return typeof e=="string"?Sp(t,e):e instanceof ed?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fI(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new H(V.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ap{}class Np extends Ap{}function tt(t,e,...n){let r=[];e instanceof Ap&&r.push(e),r=r.concat(n),function(s){const a=s.filter(u=>u instanceof xp).length,l=s.filter(u=>u instanceof sd).length;if(a>1||a>0&&l>0)throw new H(V.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class sd extends Np{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new sd(e,n,r)}_apply(e){const n=this._parse(e);return mI(e._query,n),new br(e.firestore,e.converter,Af(e._query,n))}_parse(e){const n=nd(e.firestore);return function(s,a,l,u,d,m,p){let g;if(d.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new H(V.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){l_(p,m);const S=[];for(const R of p)S.push(o_(u,s,R));g={arrayValue:{values:S}}}else g=o_(u,s,p)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||l_(p,m),g=HD(l,a,p,m==="in"||m==="not-in");return it.create(d,m,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function at(t,e,n){const r=e,i=id("where",t);return sd._create(i,r,n)}class xp extends Ap{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new xp(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:zn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let a=i;const l=s.getFlattenedFilters();for(const u of l)mI(a,u),a=Af(a,u)}(e._query,n),new br(e.firestore,e.converter,Af(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Cp extends Np{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Cp(e,n)}_apply(e){const n=function(i,s,a){if(i.startAt!==null)throw new H(V.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new H(V.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Oo(s,a)}(e._query,this._field,this._direction);return new br(e.firestore,e.converter,function(i,s){const a=i.explicitOrderBy.concat([s]);return new ha(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function as(t,e="asc"){const n=e,r=id("orderBy",t);return Cp._create(r,n)}class Rp extends Np{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Rp(e,n,r)}_apply(e){return new br(e.firestore,e.converter,ru(e._query,this._limit,this._limitType))}}function YD(t){return Rp._create("limit",t,"F")}function o_(t,e,n){if(typeof(n=Re(n))=="string"){if(n==="")throw new H(V.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!fk(e)&&n.indexOf("/")!==-1)throw new H(V.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(je.fromString(n));if(!te.isDocumentKey(r))throw new H(V.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return kv(t,new te(r))}if(n instanceof Qe)return kv(t,n._key);throw new H(V.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Fu(n)}.`)}function l_(t,e){if(!Array.isArray(t)||t.length===0)throw new H(V.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function mI(t,e){const n=function(i,s){for(const a of i)for(const l of a.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new H(V.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new H(V.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class JD{convertValue(e,n="none"){switch(di(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ze(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ui(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ie(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return wi(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var r,i,s;const n=(s=(i=(r=e.fields)==null?void 0:r[tu].arrayValue)==null?void 0:i.values)==null?void 0:s.map(a=>Ze(a.doubleValue));return new rr(n)}convertGeoPoint(e){return new nr(Ze(e.latitude),Ze(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=zu(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Do(e));default:return null}}convertTimestamp(e){const n=ci(e);return new Le(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=je.fromString(e);Se(Mk(r),9688,{name:e});const i=new jo(r.get(1),r.get(3)),s=new te(r.popFirst(5));return i.isEqual(n)||Ar(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pI(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class Ha{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ui extends hI{constructor(e,n,r,i,s,a){super(e,n,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new wc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(id("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new H(V.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Ui._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Ui._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ui._jsonSchema={type:st("string",Ui._jsonSchemaVersion),bundleSource:st("string","DocumentSnapshot"),bundleName:st("string"),bundle:st("string")};class wc extends Ui{data(e={}){return super.data(e)}}class Bi{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Ha(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new wc(this._firestore,this._userDataWriter,r.key,r,new Ha(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new H(V.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(l=>{const u=new wc(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Ha(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const u=new wc(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Ha(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,m=-1;return l.type!==0&&(d=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),m=a.indexOf(l.doc.key)),{type:XD(l.type),doc:u,oldIndex:d,newIndex:m}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new H(V.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Bi._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Wm.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function XD(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ie(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ti(t){t=rn(t,Qe);const e=rn(t.firestore,xr);return MD(Zu(e),t._key).then(n=>yI(e,t,n))}Bi._jsonSchemaVersion="firestore/querySnapshot/1.0",Bi._jsonSchema={type:st("string",Bi._jsonSchemaVersion),bundleSource:st("string","QuerySnapshot"),bundleName:st("string"),bundle:st("string")};class bp extends JD{constructor(e){super(),this.firestore=e}convertBytes(e){return new Tn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Qe(this.firestore,null,n)}}function ot(t){t=rn(t,br);const e=rn(t.firestore,xr),n=Zu(e),r=new bp(e);return fI(t._query),VD(n,t._query).then(i=>new Bi(e,r,t,i))}function rl(t,e,n){t=rn(t,Qe);const r=rn(t.firestore,xr),i=pI(t.converter,e,n);return ad(r,[lI(nd(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Sn.none())])}function xn(t,e,n,...r){t=rn(t,Qe);const i=rn(t.firestore,xr),s=nd(i);let a;return a=typeof(e=Re(e))=="string"||e instanceof ed?qD(s,"updateDoc",t._key,e,n,r):KD(s,"updateDoc",t._key,e),ad(i,[a.toMutation(t._key,Sn.exists(!0))])}function ZD(t){return ad(rn(t.firestore,xr),[new tp(t._key,Sn.none())])}function pa(t,e){const n=rn(t.firestore,xr),r=Nt(t),i=pI(t.converter,e);return ad(n,[lI(nd(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,Sn.exists(!1))]).then(()=>r)}function gI(t,...e){var u,d,m;t=Re(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||a_(e[r])||(n=e[r++]);const i={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(a_(e[r])){const p=e[r];e[r]=(u=p.next)==null?void 0:u.bind(p),e[r+1]=(d=p.error)==null?void 0:d.bind(p),e[r+2]=(m=p.complete)==null?void 0:m.bind(p)}let s,a,l;if(t instanceof Qe)a=rn(t.firestore,xr),l=$u(t._key.path),s={next:p=>{e[r]&&e[r](yI(a,t,p))},error:e[r+1],complete:e[r+2]};else{const p=rn(t,br);a=rn(p.firestore,xr),l=p._query;const g=new bp(a);s={next:k=>{e[r]&&e[r](new Bi(a,g,p,k))},error:e[r+1],complete:e[r+2]},fI(t._query)}return function(g,k,S,R){const D=new Ep(R),w=new vp(k,D,S);return g.asyncQueue.enqueueAndForget(async()=>pp(await cu(g),w)),()=>{D.Nu(),g.asyncQueue.enqueueAndForget(async()=>gp(await cu(g),w))}}(Zu(a),l,i,s)}function ad(t,e){return function(r,i){const s=new vr;return r.asyncQueue.enqueueAndForget(async()=>ID(await OD(r),i,s)),s.promise}(Zu(t),e)}function yI(t,e,n){const r=n.docs.get(e._key),i=new bp(t);return new Ui(t,i,e._key,r,new Ha(n.hasPendingWrites,n.fromCache),e.converter)}function It(){return new Tp("serverTimestamp")}function ej(...t){return new kp("arrayUnion",t)}(function(e,n=!0){(function(i){ca=i})(oa),yn(new an("firestore",(r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),l=new xr(new K1(r.getProvider("auth-internal")),new W1(a,r.getProvider("app-check-internal")),function(d,m){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new H(V.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new jo(d.options.projectId,m)}(a,i),a);return s={useFetchStreams:n,...s},l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),Ut(uv,dv,e),Ut(uv,dv,"esm2020")})();const vI="@firebase/installations",Dp="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _I=1e4,wI=`w:${Dp}`,EI="FIS_v2",tj="https://firebaseinstallations.googleapis.com/v1",nj=60*60*1e3,rj="installations",ij="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sj={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Ji=new yi(rj,ij,sj);function TI(t){return t instanceof Cn&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kI({projectId:t}){return`${tj}/projects/${t}/installations`}function II(t){return{token:t.token,requestStatus:2,expiresIn:oj(t.expiresIn),creationTime:Date.now()}}async function SI(t,e){const r=(await e.json()).error;return Ji.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function AI({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function aj(t,{refreshToken:e}){const n=AI(t);return n.append("Authorization",lj(e)),n}async function NI(t){const e=await t();return e.status>=500&&e.status<600?t():e}function oj(t){return Number(t.replace("s","000"))}function lj(t){return`${EI} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cj({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=kI(t),i=AI(t),s=e.getImmediate({optional:!0});if(s){const d=await s.getHeartbeatsHeader();d&&i.append("x-firebase-client",d)}const a={fid:n,authVersion:EI,appId:t.appId,sdkVersion:wI},l={method:"POST",headers:i,body:JSON.stringify(a)},u=await NI(()=>fetch(r,l));if(u.ok){const d=await u.json();return{fid:d.fid||n,registrationStatus:2,refreshToken:d.refreshToken,authToken:II(d.authToken)}}else throw await SI("Create Installation",u)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xI(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uj(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dj=/^[cdef][\w-]{21}$/,Vf="";function hj(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=fj(t);return dj.test(n)?n:Vf}catch{return Vf}}function fj(t){return uj(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function od(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CI=new Map;function RI(t,e){const n=od(t);bI(n,e),mj(n,e)}function bI(t,e){const n=CI.get(t);if(n)for(const r of n)r(e)}function mj(t,e){const n=pj();n&&n.postMessage({key:t,fid:e}),gj()}let Vi=null;function pj(){return!Vi&&"BroadcastChannel"in self&&(Vi=new BroadcastChannel("[Firebase] FID Change"),Vi.onmessage=t=>{bI(t.data.key,t.data.fid)}),Vi}function gj(){CI.size===0&&Vi&&(Vi.close(),Vi=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yj="firebase-installations-database",vj=1,Xi="firebase-installations-store";let ch=null;function jp(){return ch||(ch=Ou(yj,vj,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Xi)}}})),ch}async function du(t,e){const n=od(t),i=(await jp()).transaction(Xi,"readwrite"),s=i.objectStore(Xi),a=await s.get(n);return await s.put(e,n),await i.done,(!a||a.fid!==e.fid)&&RI(t,e.fid),e}async function DI(t){const e=od(t),r=(await jp()).transaction(Xi,"readwrite");await r.objectStore(Xi).delete(e),await r.done}async function ld(t,e){const n=od(t),i=(await jp()).transaction(Xi,"readwrite"),s=i.objectStore(Xi),a=await s.get(n),l=e(a);return l===void 0?await s.delete(n):await s.put(l,n),await i.done,l&&(!a||a.fid!==l.fid)&&RI(t,l.fid),l}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pp(t){let e;const n=await ld(t.appConfig,r=>{const i=_j(r),s=wj(t,i);return e=s.registrationPromise,s.installationEntry});return n.fid===Vf?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function _j(t){const e=t||{fid:hj(),registrationStatus:0};return jI(e)}function wj(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(Ji.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=Ej(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:Tj(t)}:{installationEntry:e}}async function Ej(t,e){try{const n=await cj(t,e);return du(t.appConfig,n)}catch(n){throw TI(n)&&n.customData.serverCode===409?await DI(t.appConfig):await du(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function Tj(t){let e=await c_(t.appConfig);for(;e.registrationStatus===1;)await xI(100),e=await c_(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await Pp(t);return r||n}return e}function c_(t){return ld(t,e=>{if(!e)throw Ji.create("installation-not-found");return jI(e)})}function jI(t){return kj(t)?{fid:t.fid,registrationStatus:0}:t}function kj(t){return t.registrationStatus===1&&t.registrationTime+_I<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ij({appConfig:t,heartbeatServiceProvider:e},n){const r=Sj(t,n),i=aj(t,n),s=e.getImmediate({optional:!0});if(s){const d=await s.getHeartbeatsHeader();d&&i.append("x-firebase-client",d)}const a={installation:{sdkVersion:wI,appId:t.appId}},l={method:"POST",headers:i,body:JSON.stringify(a)},u=await NI(()=>fetch(r,l));if(u.ok){const d=await u.json();return II(d)}else throw await SI("Generate Auth Token",u)}function Sj(t,{fid:e}){return`${kI(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Op(t,e=!1){let n;const r=await ld(t.appConfig,s=>{if(!PI(s))throw Ji.create("not-registered");const a=s.authToken;if(!e&&xj(a))return s;if(a.requestStatus===1)return n=Aj(t,e),s;{if(!navigator.onLine)throw Ji.create("app-offline");const l=Rj(s);return n=Nj(t,l),l}});return n?await n:r.authToken}async function Aj(t,e){let n=await u_(t.appConfig);for(;n.authToken.requestStatus===1;)await xI(100),n=await u_(t.appConfig);const r=n.authToken;return r.requestStatus===0?Op(t,e):r}function u_(t){return ld(t,e=>{if(!PI(e))throw Ji.create("not-registered");const n=e.authToken;return bj(n)?{...e,authToken:{requestStatus:0}}:e})}async function Nj(t,e){try{const n=await Ij(t,e),r={...e,authToken:n};return await du(t.appConfig,r),n}catch(n){if(TI(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await DI(t.appConfig);else{const r={...e,authToken:{requestStatus:0}};await du(t.appConfig,r)}throw n}}function PI(t){return t!==void 0&&t.registrationStatus===2}function xj(t){return t.requestStatus===2&&!Cj(t)}function Cj(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+nj}function Rj(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function bj(t){return t.requestStatus===1&&t.requestTime+_I<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dj(t){const e=t,{installationEntry:n,registrationPromise:r}=await Pp(e);return r?r.catch(console.error):Op(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jj(t,e=!1){const n=t;return await Pj(n),(await Op(n,e)).token}async function Pj(t){const{registrationPromise:e}=await Pp(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oj(t){if(!t||!t.options)throw uh("App Configuration");if(!t.name)throw uh("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw uh(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function uh(t){return Ji.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OI="installations",Mj="installations-internal",Vj=t=>{const e=t.getProvider("app").getImmediate(),n=Oj(e),r=Rr(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},Lj=t=>{const e=t.getProvider("app").getImmediate(),n=Rr(e,OI).getImmediate();return{getId:()=>Dj(n),getToken:i=>jj(n,i)}};function Fj(){yn(new an(OI,Vj,"PUBLIC")),yn(new an(Mj,Lj,"PRIVATE"))}Fj();Ut(vI,Dp);Ut(vI,Dp,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hu="analytics",Uj="firebase_id",Bj="origin",zj=60*1e3,$j="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Mp="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sn=new Pu("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gj={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},pn=new yi("analytics","Analytics",Gj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kj(t){if(!t.startsWith(Mp)){const e=pn.create("invalid-gtag-resource",{gtagURL:t});return sn.warn(e.message),""}return t}function MI(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function qj(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function Hj(t,e){const n=qj("firebase-js-sdk-policy",{createScriptURL:Kj}),r=document.createElement("script"),i=`${Mp}?l=${t}&id=${e}`;r.src=n?n==null?void 0:n.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function Wj(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function Qj(t,e,n,r,i,s){const a=r[i];try{if(a)await e[a];else{const u=(await MI(n)).find(d=>d.measurementId===i);u&&await e[u.appId]}}catch(l){sn.error(l)}t("config",i,s)}async function Yj(t,e,n,r,i){try{let s=[];if(i&&i.send_to){let a=i.send_to;Array.isArray(a)||(a=[a]);const l=await MI(n);for(const u of a){const d=l.find(p=>p.measurementId===u),m=d&&e[d.appId];if(m)s.push(m);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),t("event",r,i||{})}catch(s){sn.error(s)}}function Jj(t,e,n,r){async function i(s,...a){try{if(s==="event"){const[l,u]=a;await Yj(t,e,n,l,u)}else if(s==="config"){const[l,u]=a;await Qj(t,e,n,r,l,u)}else if(s==="consent"){const[l,u]=a;t("consent",l,u)}else if(s==="get"){const[l,u,d]=a;t("get",l,u,d)}else if(s==="set"){const[l]=a;t("set",l)}else t(s,...a)}catch(l){sn.error(l)}}return i}function Xj(t,e,n,r,i){let s=function(...a){window[r].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=Jj(s,t,e,n),{gtagCore:s,wrappedGtag:window[i]}}function Zj(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(Mp)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eP=30,tP=1e3;class nP{constructor(e={},n=tP){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const VI=new nP;function rP(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function iP(t){var a;const{appId:e,apiKey:n}=t,r={method:"GET",headers:rP(n)},i=$j.replace("{app-id}",e),s=await fetch(i,r);if(s.status!==200&&s.status!==304){let l="";try{const u=await s.json();(a=u.error)!=null&&a.message&&(l=u.error.message)}catch{}throw pn.create("config-fetch-failed",{httpStatus:s.status,responseMessage:l})}return s.json()}async function sP(t,e=VI,n){const{appId:r,apiKey:i,measurementId:s}=t.options;if(!r)throw pn.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw pn.create("no-api-key")}const a=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},l=new lP;return setTimeout(async()=>{l.abort()},zj),LI({appId:r,apiKey:i,measurementId:s},a,l,e)}async function LI(t,{throttleEndTimeMillis:e,backoffCount:n},r,i=VI){var l;const{appId:s,measurementId:a}=t;try{await aP(r,e)}catch(u){if(a)return sn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:s,measurementId:a};throw u}try{const u=await iP(t);return i.deleteThrottleMetadata(s),u}catch(u){const d=u;if(!oP(d)){if(i.deleteThrottleMetadata(s),a)return sn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${d==null?void 0:d.message}]`),{appId:s,measurementId:a};throw u}const m=Number((l=d==null?void 0:d.customData)==null?void 0:l.httpStatus)===503?Oy(n,i.intervalMillis,eP):Oy(n,i.intervalMillis),p={throttleEndTimeMillis:Date.now()+m,backoffCount:n+1};return i.setThrottleMetadata(s,p),sn.debug(`Calling attemptFetch again in ${m} millis`),LI(t,p,r,i)}}function aP(t,e){return new Promise((n,r)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(n,i);t.addEventListener(()=>{clearTimeout(s),r(pn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function oP(t){if(!(t instanceof Cn)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class lP{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function cP(t,e,n,r,i){if(i&&i.global){t("event",n,r);return}else{const s=await e,a={...r,send_to:s};t("event",n,a)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uP(){if(Du())try{await ju()}catch(t){return sn.warn(pn.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return sn.warn(pn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function dP(t,e,n,r,i,s,a){const l=sP(t);l.then(g=>{n[g.measurementId]=g.appId,t.options.measurementId&&g.measurementId!==t.options.measurementId&&sn.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${g.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(g=>sn.error(g)),e.push(l);const u=uP().then(g=>{if(g)return r.getId()}),[d,m]=await Promise.all([l,u]);Zj(s)||Hj(s,d.measurementId),i("js",new Date);const p=(a==null?void 0:a.config)??{};return p[Bj]="firebase",p.update=!0,m!=null&&(p[Uj]=m),i("config",d.measurementId,p),d.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hP{constructor(e){this.app=e}_delete(){return delete co[this.app.options.appId],Promise.resolve()}}let co={},d_=[];const h_={};let dh="dataLayer",fP="gtag",f_,FI,m_=!1;function mP(){const t=[];if(Mm()&&t.push("This is a browser extension environment."),Vm()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,i)=>`(${i+1}) ${r}`).join(" "),n=pn.create("invalid-analytics-context",{errorInfo:e});sn.warn(n.message)}}function pP(t,e,n){mP();const r=t.options.appId;if(!r)throw pn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)sn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw pn.create("no-api-key");if(co[r]!=null)throw pn.create("already-exists",{id:r});if(!m_){Wj(dh);const{wrappedGtag:s,gtagCore:a}=Xj(co,d_,h_,dh,fP);FI=s,f_=a,m_=!0}return co[r]=dP(t,d_,h_,e,f_,dh,n),new hP(t)}function gP(t=qo()){t=Re(t);const e=Rr(t,hu);return e.isInitialized()?e.getImmediate():yP(t)}function yP(t,e={}){const n=Rr(t,hu);if(n.isInitialized()){const i=n.getImmediate();if(kr(e,n.getOptions()))return i;throw pn.create("already-initialized")}return n.initialize({options:e})}async function vP(){if(Mm()||!Vm()||!Du())return!1;try{return await ju()}catch{return!1}}function _P(t,e,n,r){t=Re(t),cP(FI,co[t.app.options.appId],e,n,r).catch(i=>sn.error(i))}const p_="@firebase/analytics",g_="0.10.18";function wP(){yn(new an(hu,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return pP(r,i,n)},"PUBLIC")),yn(new an("analytics-internal",t,"PRIVATE")),Ut(p_,g_),Ut(p_,g_,"esm2020");function t(e){try{const n=e.getProvider(hu).getImmediate();return{logEvent:(r,i,s)=>_P(n,r,i,s)}}catch(n){throw pn.create("interop-component-reg-failed",{reason:n})}}}wP();const EP={apiKey:"AIzaSyAQVXo0DxYf44hU__zS4XMlrDz5uu6bAQc",authDomain:"glowchocolate-534b7.firebaseapp.com",projectId:"glowchocolate-534b7",storageBucket:"glowchocolate-534b7.firebasestorage.app",messagingSenderId:"494243389831",appId:"1:494243389831:web:b76f71af742baba3f87322",measurementId:"G-3K1K88W6JX"},Zi=iT(EP);try{typeof window<"u"&&vP().then(t=>{t?gP(Zi):console.info("[Analytics] Desteklenmiyor, atlanıyor")}).catch(()=>{console.info("[Analytics] Başlatılamadı, atlanıyor")})}catch{console.info("[Analytics] Hata, atlanıyor")}const cd=F1(Zi),oe=FD(Zi),UI=t=>t.toLowerCase().endsWith("@glow.com"),TP=async(t,e)=>{try{return UI(t)?{success:!0,user:(await kC(cd,t,e)).user,message:"Kayıt başarılı!"}:{success:!1,error:"invalid-domain",message:"Sadece @glow.com uzantılı e-postalar kabul edilir"}}catch(n){return{success:!1,error:n.code,message:BI(n.code)}}},kP=async(t,e)=>{try{return UI(t)?{success:!0,user:(await IC(cd,t,e)).user,message:"Giriş başarılı!"}:{success:!1,error:"invalid-domain",message:"Sadece @glow.com uzantılı e-postalar kabul edilir"}}catch(n){return{success:!1,error:n.code,message:BI(n.code)}}},IP=async()=>{try{return await xC(cd),{success:!0,message:"Çıkış başarılı!"}}catch(t){return{success:!1,error:t.code,message:"Çıkış yapılırken hata oluştu"}}},SP=t=>NC(cd,t),BI=t=>{switch(t){case"auth/user-not-found":return"Kullanıcı bulunamadı";case"auth/wrong-password":return"Hatalı şifre";case"auth/email-already-in-use":return"Bu e-posta zaten kullanımda";case"auth/weak-password":return"Şifre çok zayıf (en az 6 karakter)";case"auth/invalid-email":return"Geçersiz e-posta adresi";case"auth/too-many-requests":return"Çok fazla deneme. Lütfen daha sonra tekrar deneyin";case"auth/invalid-credential":return"Geçersiz giriş bilgileri";case"invalid-domain":return"Sadece @glow.com uzantılı e-postalar kabul edilir";default:return"Bir hata oluştu. Lütfen tekrar deneyin."}},AP=async t=>{try{const e=CP(t.department),n={uid:t.uid,email:t.email,firstName:t.firstName,lastName:t.lastName,department:t.department,fullName:`${t.firstName} ${t.lastName}`,createdAt:new Date,isActive:!0,role:e,permissions:zI(e)},r=await pa(xe(oe,"users"),n);return await NP(t.department,{id:r.id,...n}),{success:!0,id:r.id,message:"Kullanıcı profili oluşturuldu"}}catch(e){return console.error("Kullanıcı profili oluşturma hatası:",e),{success:!1,error:e.code,message:"Profil oluşturulamadı"}}},NP=async(t,e)=>{try{const n={userId:e.id,uid:e.uid,fullName:e.fullName,email:e.email,department:t,position:xP(t),joinDate:new Date,isActive:!0};return await pa(xe(oe,"departments",t,"employees"),n),{success:!0}}catch(n){return console.error("Departmana kullanıcı ekleme hatası:",n),{success:!1,error:n}}},xP=t=>({yonetim:"Yönetici",mudur:"Müdür",koordinatorler:"Koordinatör","servis-personeli":"Servis Personeli","bar-personeli":"Bar Personeli","mutfak-personeli":"Mutfak Personeli","tedarik-sorumlusu":"Tedarik Sorumlusu","imalat-personeli":"İmalat Personeli"})[t]||"Personel",CP=t=>["yonetim","mudur"].includes(t)?"admin":"employee",zI=t=>t==="admin"?{canViewAllPersonnel:!0,canManagePersonnel:!0,canManageDepartments:!0,canViewReports:!0,canManageSystem:!0,canDeleteRecords:!0,canModifyRoles:!0}:{canViewAllPersonnel:!1,canManagePersonnel:!1,canManageDepartments:!1,canViewReports:!1,canManageSystem:!1,canDeleteRecords:!1,canModifyRoles:!1},RP=async(t,e)=>{try{const n=Nt(oe,"notification_queue",t);return(await Ti(n)).exists()?{success:!0,skipped:!0}:(await rl(n,{...e,status:"pending",createdAt:It(),retries:0}),{success:!0})}catch(n){return console.error("Bildirim kuyruğa eklenemedi:",n),{success:!1,error:n.code||String(n)}}},bP=async(t,e=null)=>{const n=`broadcast_${Date.now()}`;return RP(n,{audience:{type:"all"},createdByUid:(e==null?void 0:e.uid)||null,createdByEmail:(e==null?void 0:e.email)||null,...t})},_s=async t=>{try{const e=tt(xe(oe,"users"),at("uid","==",t)),n=await ot(e);if(n.empty)return{success:!1,message:"Kullanıcı profili bulunamadı"};{const r=n.docs[0];return{success:!0,user:{id:r.id,...r.data()}}}}catch(e){return console.error("Kullanıcı profili getirme hatası:",e),{success:!1,error:e.code}}},Ql=async(t,e)=>{try{const n=tt(xe(oe,"users"),at("uid","==",t)),r=await ot(n);if(r.empty)throw new Error("Kullanıcı profili bulunamadı");const i=r.docs[0],s=Nt(oe,"users",i.id),a={...e,updatedAt:new Date};if(e.fullName){const u=e.fullName.trim().split(" ");a.firstName=u[0]||"",a.lastName=u.slice(1).join(" ")||""}await xn(s,a);const l=i.data();if(l.department)try{const u=tt(xe(oe,"departments",l.department,"employees"),at("uid","==",t)),d=await ot(u);if(!d.empty){const m=d.docs[0],p=Nt(oe,"departments",l.department,"employees",m.id);await xn(p,{fullName:a.fullName||l.fullName,email:a.email||l.email,phone:a.phone||l.phone,updatedAt:new Date})}}catch(u){console.warn("Departman bilgisi güncellenirken hata:",u)}return{success:!0,message:"Profil başarıyla güncellendi"}}catch(n){return console.error("Profil güncelleme hatası:",n),{success:!1,error:n.code||n.message,message:"Profil güncellenirken hata oluştu"}}},DP=async t=>{try{const e={...t,createdAt:new Date,isActive:!0,altGorevler:t.altGorevler||[]};return{success:!0,id:(await pa(xe(oe,"gorevler"),e)).id,message:"Görev başarıyla oluşturuldu"}}catch(e){return console.error("Görev oluşturma hatası:",e),{success:!1,error:e.code,message:"Görev oluşturulamadı"}}},jP=async()=>{try{const t=tt(xe(oe,"gorevler"),at("isActive","==",!0),as("createdAt","desc")),e=await ot(t),n=[];return e.forEach(r=>{n.push({id:r.id,...r.data()})}),{success:!0,gorevler:n}}catch(t){return console.error("Görevleri getirme hatası:",t),{success:!1,error:t.code,gorevler:[]}}},PP=async t=>{try{const e={...t,createdAt:new Date,onayDurumu:"bekliyor"};return{success:!0,id:(await pa(xe(oe,"gorev_onaylari"),e)).id,message:"Görev onaya gönderildi"}}catch(e){return console.error("Görev onay kaydı oluşturma hatası:",e),{success:!1,error:e.code,message:"Görev onaya gönderilemedi"}}},OP=async()=>{const t=e=>{try{return e?typeof e.toDate=="function"?e.toDate().getTime():new Date(e).getTime()||0:0}catch{return 0}};try{const e=tt(xe(oe,"gorev_onaylari"),at("onayDurumu","==","bekliyor"),as("createdAt","desc")),n=await ot(e),r=[];return n.forEach(i=>{r.push({id:i.id,...i.data()})}),{success:!0,onayBekleyenler:r}}catch(e){if((e==null?void 0:e.code)==="failed-precondition")try{const n=tt(xe(oe,"gorev_onaylari"),at("onayDurumu","==","bekliyor")),r=await ot(n),i=[];return r.forEach(s=>i.push({id:s.id,...s.data()})),i.sort((s,a)=>t(a.createdAt)-t(s.createdAt)),{success:!0,onayBekleyenler:i}}catch(n){return console.error("Onay bekleyen görevleri getirme (fallback) hatası:",n),{success:!1,error:n.code,onayBekleyenler:[]}}return console.error("Onay bekleyen görevleri getirme hatası:",e),{success:!1,error:e.code,onayBekleyenler:[]}}},y_=async(t,e,n="")=>{try{const r=Nt(oe,"gorev_onaylari",t);return await xn(r,{onayDurumu:e,adminNotu:n,onayTarihi:new Date,updatedAt:new Date}),{success:!0,message:`Görev ${e==="onaylandi"?"onaylandı":"reddedildi"}`}}catch(r){return console.error("Görev onay durumu güncelleme hatası:",r),{success:!1,error:r.code,message:"Onay durumu güncellenemedi"}}},MP=async()=>{const t=e=>{try{return e?typeof e.toDate=="function"?e.toDate().getTime():new Date(e).getTime()||0:0}catch{return 0}};try{const e=tt(xe(oe,"gorev_onaylari"),at("onayDurumu","==","onaylandi"),as("onayTarihi","desc")),n=await ot(e),r=[];return n.forEach(i=>{r.push({id:i.id,...i.data()})}),{success:!0,onaylananlar:r}}catch(e){if((e==null?void 0:e.code)==="failed-precondition")try{const n=tt(xe(oe,"gorev_onaylari"),at("onayDurumu","==","onaylandi")),r=await ot(n),i=[];return r.forEach(s=>i.push({id:s.id,...s.data()})),i.sort((s,a)=>t(a.onayTarihi)-t(s.onayTarihi)),{success:!0,onaylananlar:i}}catch(n){return console.error("Onaylanan görevleri getirme (fallback) hatası:",n),{success:!1,error:n.code,onaylananlar:[]}}return console.error("Onaylanan görevleri getirme hatası:",e),{success:!1,error:e.code,onaylananlar:[]}}},VP=async()=>{const t=e=>{try{return e?typeof e.toDate=="function"?e.toDate().getTime():new Date(e).getTime()||0:0}catch{return 0}};try{const e=tt(xe(oe,"gorev_onaylari"),at("onayDurumu","==","reddedildi"),as("onayTarihi","desc")),n=await ot(e),r=[];return n.forEach(i=>{r.push({id:i.id,...i.data()})}),{success:!0,reddedilenler:r}}catch(e){if((e==null?void 0:e.code)==="failed-precondition")try{const n=tt(xe(oe,"gorev_onaylari"),at("onayDurumu","==","reddedildi")),r=await ot(n),i=[];return r.forEach(s=>i.push({id:s.id,...s.data()})),i.sort((s,a)=>t(a.onayTarihi)-t(s.onayTarihi)),{success:!0,reddedilenler:i}}catch(n){return console.error("Reddedilen görevleri getirme (fallback) hatası:",n),{success:!1,error:n.code,reddedilenler:[]}}return console.error("Reddedilen görevleri getirme hatası:",e),{success:!1,error:e.code,reddedilenler:[]}}},LP=async()=>{try{const t=tt(xe(oe,"users"),at("isActive","==",!0)),e=await ot(t),n=[];return e.forEach(r=>n.push({id:r.id,...r.data()})),{success:!0,users:n}}catch(t){return console.error("Aktif kullanıcıları getirme hatası:",t),{success:!1,users:[],error:t.code||String(t)}}},FP=async()=>{const t=e=>e.sort((n,r)=>String(n.fullName||"").localeCompare(String(r.fullName||""),"tr"));try{const e=tt(xe(oe,"users"),as("fullName","asc")),n=await ot(e),r=[];return n.forEach(i=>r.push({id:i.id,...i.data()})),{success:!0,users:r}}catch{try{const n=await ot(xe(oe,"users")),r=[];return n.forEach(i=>r.push({id:i.id,...i.data()})),{success:!0,users:t(r)}}catch(n){return console.error("Kullanıcıları getirme hatası:",n),{success:!1,users:[],error:n.code||String(n)}}}},UP=async(t,e)=>{try{const n=tt(xe(oe,"users"),at("uid","==",t)),r=await ot(n);if(r.empty)return{success:!1,error:"not_found"};const i=r.docs[0],s=Nt(oe,"users",i.id);return await xn(s,{role:e,permissions:zI(e),updatedAt:new Date}),{success:!0}}catch(n){return console.error("Rol güncelleme hatası:",n),{success:!1,error:n.code||String(n)}}},BP=async(t,e)=>{try{const n=tt(xe(oe,"users"),at("uid","==",t)),r=await ot(n);if(r.empty)return{success:!1,error:"not_found"};const i=r.docs[0],s=Nt(oe,"users",i.id);return await xn(s,{isActive:e,updatedAt:new Date}),{success:!0}}catch(n){return console.error("Aktiflik güncelleme hatası:",n),{success:!1,error:n.code||String(n)}}},ga=(t,e)=>`${t}_${e}`,zP=async(t,e)=>{try{const n=Nt(oe,"mesai",ga(t,e)),r=await Ti(n);return r.exists()?{success:!0,data:{id:r.id,...r.data()}}:{success:!0,data:null}}catch(n){return console.error("Mesai kaydı getirme hatası:",n),{success:!1,error:n.code||String(n)}}},$P=(t,e)=>{const n=tt(xe(oe,"mesai"),at("date","==",t));return gI(n,r=>{const i=[];r.forEach(s=>i.push({id:s.id,...s.data()})),e(i)},r=>{console.error("Mesai dinleme hatası:",r)})},GP=async(t,e)=>{try{const n=tt(xe(oe,"mesai"),at("date",">=",t),at("date","<=",e)),r=await ot(n),i=[];return r.forEach(s=>i.push({id:s.id,...s.data()})),{success:!0,items:i}}catch(n){return console.error("Rapor kayıtlarını getirme hatası:",n),{success:!1,items:[],error:n.code||String(n)}}},ud=()=>{const t=new Date;return{clientTime:t.toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),millis:t.getTime()}},KP=async(t,e,n=null)=>{try{const r=Nt(oe,"mesai",ga(t.uid,e)),i=await Ti(r),{clientTime:s,millis:a}=ud(),l={uid:t.uid,email:t.email,fullName:t.fullName,department:t.department,position:t.position,date:e,status:"in",updatedAt:It()};if(i.exists()){const u=i.data()||{};if(u!=null&&u.leftAt||(u==null?void 0:u.status)==="out")return{success:!1,error:"already_closed"};if((u==null?void 0:u.status)==="absent")return{success:!1,error:"marked_absent"};await xn(r,{...l,arrivedAt:u.arrivedAt||{clientTime:s,millis:a},arrivedAtLocation:u.arrivedAtLocation||n||null,leftAt:null,overtimeAt:null,history:[...u.history||[],{type:"in",clientTime:s,millis:a,atMillis:a,atClientTime:s,location:n||null}]})}else await rl(r,{...l,createdAt:It(),arrivedAt:{clientTime:s,millis:a},arrivedAtLocation:n||null,leftAt:null,history:[{type:"in",clientTime:s,millis:a,atMillis:a,atClientTime:s,location:n||null}]});return{success:!0}}catch(r){return console.error("Mesai giriş (in) hatası:",r),{success:!1,error:r.code||String(r)}}},v_=async(t,e,n=null)=>{try{const r=Nt(oe,"mesai",ga(t.uid,e)),i=await Ti(r),{clientTime:s,millis:a}=ud(),l={uid:t.uid,email:t.email,fullName:t.fullName,department:t.department,position:t.position,date:e,status:"out",updatedAt:It()};if(i.exists()){const u=i.data()||{};await xn(r,{...l,arrivedAt:u.arrivedAt||null,leftAt:{clientTime:s,millis:a},leftAtLocation:n||null,history:[...u.history||[],{type:"out",clientTime:s,millis:a,atMillis:a,atClientTime:s,location:n||null}]})}else await rl(r,{...l,createdAt:It(),arrivedAt:null,leftAt:{clientTime:s,millis:a},leftAtLocation:n||null,history:[{type:"out",clientTime:s,millis:a,atMillis:a,atClientTime:s,location:n||null}]});return{success:!0}}catch(r){return console.error("Mesai çıkış (out) hatası:",r),{success:!1,error:r.code||String(r)}}},qP=async(t,e)=>{try{const n=Nt(oe,"mesai",ga(t.uid,e)),{clientTime:r,millis:i}=ud();return await rl(n,{uid:t.uid,email:t.email,fullName:t.fullName,department:t.department,position:t.position,date:e,status:"absent",arrivedAt:null,leftAt:null,createdAt:It(),updatedAt:It(),history:[{type:"absent",clientTime:r,millis:i,atMillis:i,atClientTime:r}]},{merge:!0}),{success:!0}}catch(n){return console.error("Mesai (absent) hatası:",n),{success:!1,error:n.code||String(n)}}},__=async(t,e)=>{try{const n=Nt(oe,"mesai",ga(t.uid,e));if(!(await Ti(n)).exists())return{success:!1,error:"no_entry"};const{clientTime:i,millis:s}=ud();return await xn(n,{status:"in_overtime",overtimeAt:{clientTime:i,millis:s},updatedAt:It(),history:ej({type:"in_overtime",clientTime:i,millis:s,atMillis:s,atClientTime:i})}),{success:!0}}catch(n){return console.error("Mesai overtime hatası:",n),{success:!1,error:n.code||String(n)}}},HP=async(t,e)=>{try{const n=Nt(oe,"mesai",ga(t.uid,e));return await ZD(n),{success:!0}}catch(n){return console.error("Mesai reset hatası:",n),{success:!1,error:n.code||String(n)}}},Vp=(t,e)=>`${t}_${e}`,$I=()=>{const t=new Date;return{clientTime:t.toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),millis:t.getTime()}},WP=async(t,e,n,r)=>{try{const i=Nt(oe,"molalar",Vp(t.uid,e)),s=await Ti(i),{clientTime:a,millis:l}=$I(),u=new Date(l+r*60*1e3),d={clientTime:u.toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),millis:u.getTime()},m={type:n,duration:r,startedAt:{clientTime:a,millis:l},expectedEndAt:d};if(s.exists()){const p=s.data()||{};if(p.activeBreak)return{success:!1,error:"already_on_break"};await xn(i,{uid:t.uid,fullName:t.fullName,department:t.department,position:t.position,date:e,active:!0,activeBreak:m,updatedAt:It(),history:[...p.history||[],{type:"start",breakType:n,duration:r,atMillis:l,atClientTime:a}]})}else await rl(i,{uid:t.uid,fullName:t.fullName,department:t.department,position:t.position,date:e,active:!0,activeBreak:m,createdAt:It(),updatedAt:It(),history:[{type:"start",breakType:n,duration:r,atMillis:l,atClientTime:a}]});return{success:!0}}catch(i){return console.error("Mola başlatma hatası:",i),{success:!1,error:i.code||String(i)}}},QP=async(t,e)=>{try{const n=Nt(oe,"molalar",Vp(t.uid,e)),r=await Ti(n);if(!r.exists())return{success:!1,error:"not_found"};const i=r.data()||{};if(!i.activeBreak)return{success:!1,error:"no_active_break"};const{clientTime:s,millis:a}=$I();return await xn(n,{active:!1,activeBreak:null,updatedAt:It(),history:[...i.history||[],{type:"end",breakType:i.activeBreak.type,duration:i.activeBreak.duration,atMillis:a,atClientTime:s}]}),{success:!0}}catch(n){return console.error("Mola bitirme hatası:",n),{success:!1,error:n.code||String(n)}}},YP=(t,e)=>{const n=tt(xe(oe,"molalar"),at("date","==",t));return gI(n,r=>{const i=[];r.forEach(s=>i.push({id:s.id,...s.data()})),e(i)},r=>console.error("Mola dinleme hatası:",r))},JP=async(t,e,n)=>{try{const r=Nt(oe,"molalar",Vp(t.uid,e)),i=await Ti(r);return i.exists()?(i.data()||{}).alertSentAt?{success:!0,skipped:!0}:(await xn(r,{alertSentAt:It(),lastAlert:{overMillis:n.overMillis,overPct:n.overPct,at:It()}}),await pa(xe(oe,"mola_uyarilari"),{uid:t.uid,fullName:t.fullName,department:t.department,position:t.position,date:e,breakType:n.breakType,duration:n.duration,startedAtMillis:n.startedAtMillis,expectedEndMillis:n.expectedEndMillis,overMillis:n.overMillis,overPct:n.overPct,createdAt:It()}),{success:!0}):{success:!1,error:"not_found"}}catch(r){return console.error("Aşım uyarısı gönderme hatası:",r),{success:!1,error:r.code||String(r)}}},XP=async t=>{try{const e={...t,status:t.status||"bekliyor",createdAt:It(),updatedAt:It()};return{success:!0,id:(await pa(xe(oe,"gorev_ricalari"),e)).id}}catch(e){return console.error("Görev rica kaydı oluşturma hatası:",e),{success:!1,error:e.code||String(e)}}},ZP=({onLogin:t})=>{const[e,n]=M.useState(!0),[r,i]=M.useState({email:"",password:"",confirmPassword:"",firstName:"",lastName:"",department:""}),[s,a]=M.useState({}),[l,u]=M.useState(!1),[d,m]=M.useState(!1),[p,g]=M.useState(!1),k=w=>{const{name:y,value:I}=w.target;i(P=>({...P,[y]:I})),s[y]&&a(P=>({...P,[y]:""}))},S=w=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(w)?w.toLowerCase().endsWith("@glow.com"):!1,R=()=>{const w={};return r.email?S(r.email)||(w.email="E-posta @glow.com ile bitmelidir"):w.email="E-posta gereklidir",r.password?r.password.length<6&&(w.password="Şifre en az 6 karakter olmalıdır"):w.password="Şifre gereklidir",e||(r.firstName||(w.firstName="Ad gereklidir"),r.lastName||(w.lastName="Soyad gereklidir"),r.department||(w.department="Departman seçimi gereklidir"),r.confirmPassword?r.password!==r.confirmPassword&&(w.confirmPassword="Şifreler eşleşmiyor"):w.confirmPassword="Şifre tekrarı gereklidir"),a(w),Object.keys(w).length===0},D=async w=>{if(w.preventDefault(),!!R()){u(!0);try{let y;if(e){if(y=await kP(r.email,r.password),y.success){const I=await _s(y.user.uid);t({uid:y.user.uid,email:y.user.email,name:I.success&&I.user.fullName||y.user.email.split("@")[0],department:I.success?I.user.department:void 0,role:I.success?I.user.role:"employee"})}}else if(y=await TP(r.email,r.password),y.success){const I={uid:y.user.uid,email:y.user.email,firstName:r.firstName,lastName:r.lastName,department:r.department},P=await AP(I);P.success?t({uid:y.user.uid,email:y.user.email,name:`${r.firstName} ${r.lastName}`,department:r.department}):a({general:"Profil oluşturulamadı: "+P.message})}y.success||a({general:y.message})}catch(y){console.error("Auth error:",y),a({general:"Bir hata oluştu. Lütfen tekrar deneyin."})}finally{u(!1)}}};return c.jsxs("div",{className:"login-register-container",children:[c.jsxs("div",{className:"floating-shapes",children:[c.jsx("div",{className:"shape"}),c.jsx("div",{className:"shape"}),c.jsx("div",{className:"shape"})]}),c.jsxs("div",{className:"auth-card glass-card",children:[c.jsxs("div",{className:"auth-header",children:[c.jsxs("h1",{className:"brand-title",children:["GlowChocolate",c.jsx("div",{className:"brand-logo",children:c.jsxs("div",{className:"logo-crown",children:[c.jsx("div",{className:"crown-center"}),c.jsx("div",{className:"crown-left"}),c.jsx("div",{className:"crown-right"}),c.jsx("div",{className:"crown-base"})]})})]}),c.jsx("p",{className:"brand-subtitle",children:"İşletme ve Personel Takip Sistemi"})]}),!1,c.jsxs("form",{onSubmit:D,className:"auth-form",children:[s.general&&c.jsx("div",{className:"error-banner",children:s.general}),!e&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"form-row",children:[c.jsxs("div",{className:"form-group",children:[c.jsx("input",{type:"text",name:"firstName",value:r.firstName,onChange:k,placeholder:" ",className:`form-input ${s.firstName?"error":""}`,disabled:l}),c.jsx("label",{className:"form-label",children:"Ad"}),s.firstName&&c.jsx("span",{className:"error-message",children:s.firstName})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("input",{type:"text",name:"lastName",value:r.lastName,onChange:k,placeholder:" ",className:`form-input ${s.lastName?"error":""}`,disabled:l}),c.jsx("label",{className:"form-label",children:"Soyad"}),s.lastName&&c.jsx("span",{className:"error-message",children:s.lastName})]})]}),c.jsxs("div",{className:"form-group",children:[c.jsxs("div",{className:`select-wrapper ${s.department?"error":""}`,children:[c.jsxs("select",{name:"department",value:r.department,onChange:k,onFocus:w=>w.target.parentElement.classList.add("focus"),onBlur:w=>w.target.parentElement.classList.remove("focus"),className:`form-select ${s.department?"error":""}`,disabled:l,children:[c.jsx("option",{value:"",children:"Departman Seçin"}),c.jsx("option",{value:"yonetim",children:"👔 Yönetim"}),c.jsx("option",{value:"mudur",children:"🏢 Müdür"}),c.jsx("option",{value:"koordinatorler",children:"⚡ Koordinatörler"}),c.jsx("option",{value:"servis-personeli",children:"🍽️ Servis Personeli"}),c.jsx("option",{value:"bar-personeli",children:"🍹 Bar Personeli"}),c.jsx("option",{value:"mutfak-personeli",children:"👨‍🍳 Mutfak Personeli"}),c.jsx("option",{value:"tedarik-sorumlusu",children:"📦 Tedarik Sorumlusu"}),c.jsx("option",{value:"imalat-personeli",children:"🍫 İmalat Personeli"})]}),c.jsx("label",{className:"select-label",children:"Departman"})]}),s.department&&c.jsx("span",{className:"error-message",children:s.department})]})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("input",{type:"email",name:"email",value:r.email,onChange:k,placeholder:" ",className:`form-input ${s.email?"error":""}`,disabled:l}),c.jsx("label",{className:"form-label",children:"E-posta (@glow.com)"}),s.email&&c.jsx("span",{className:"error-message",children:s.email})]}),c.jsxs("div",{className:"form-group",children:[c.jsxs("div",{className:"password-input-wrapper",children:[c.jsx("input",{type:d?"text":"password",name:"password",value:r.password,onChange:k,placeholder:" ",className:`form-input ${s.password?"error":""}`,disabled:l}),c.jsx("label",{className:"form-label",children:"Şifre"}),c.jsx("button",{type:"button",className:"password-toggle",onClick:()=>m(!d),disabled:l,children:d?"👁️":"👁️‍🗨️"})]}),s.password&&c.jsx("span",{className:"error-message",children:s.password})]}),!e&&c.jsxs("div",{className:"form-group",children:[c.jsxs("div",{className:"password-input-wrapper",children:[c.jsx("input",{type:d?"text":"password",name:"confirmPassword",value:r.confirmPassword,onChange:k,placeholder:" ",className:`form-input ${s.confirmPassword?"error":""}`,disabled:l}),c.jsx("label",{className:"form-label",children:"Şifre Tekrar"})]}),s.confirmPassword&&c.jsx("span",{className:"error-message",children:s.confirmPassword})]}),e&&c.jsxs("div",{className:"form-options",children:[c.jsxs("label",{className:"checkbox-wrapper",children:[c.jsx("input",{type:"checkbox",checked:p,onChange:w=>g(w.target.checked),disabled:l}),c.jsx("span",{className:"checkmark"}),"Beni Hatırla"]}),c.jsx("button",{type:"button",className:"forgot-password",children:"Şifremi Unuttum"})]}),c.jsx("button",{type:"submit",className:"btn btn-primary auth-submit",disabled:l,children:l?c.jsxs("div",{className:"loading-btn",children:[c.jsx("div",{className:"spinner"}),e?"Giriş yapılıyor...":"Kayıt oluşturuluyor..."]}):e?"Giriş Yap":"Kayıt Ol"})]}),c.jsx("div",{className:"auth-footer",children:c.jsxs("p",{children:[e?"Hesabınız yok mu?":"Zaten hesabınız var mı?",c.jsx("button",{type:"button",className:"link-btn",onClick:()=>n(!e),children:e?"Kayıt Ol":"Giriş Yap"})]})})]})]})},w_=()=>c.jsxs("div",{className:"loading-container",children:[c.jsxs("div",{className:"floating-shapes",children:[c.jsx("div",{className:"shape"}),c.jsx("div",{className:"shape"}),c.jsx("div",{className:"shape"})]}),c.jsxs("div",{className:"loading-content",children:[c.jsxs("div",{className:"loading-brand",children:[c.jsx("span",{className:"loading-icon",children:"🍫"}),c.jsx("h1",{className:"loading-title",children:"GlowChocolate"})]}),c.jsx("div",{className:"loading-spinner-container",children:c.jsxs("div",{className:"loading-spinner",children:[c.jsx("div",{className:"spinner-ring"}),c.jsx("div",{className:"spinner-ring"}),c.jsx("div",{className:"spinner-ring"}),c.jsx("div",{className:"spinner-inner",children:c.jsx("span",{className:"inner-icon",children:"✨"})})]})}),c.jsxs("div",{className:"loading-text",children:[c.jsx("p",{className:"loading-message",children:"Yetki kontrolü yapılıyor..."}),c.jsxs("div",{className:"loading-dots",children:[c.jsx("span",{className:"dot"}),c.jsx("span",{className:"dot"}),c.jsx("span",{className:"dot"})]})]})]})]}),Yl=({isOpen:t,onClose:e,userProfile:n,onUpdateProfile:r})=>{var S,R;const i=["Müdür","Müdür Yardımcısı","Bar Şefi","Salon Şefi","Mutfak Şefi","Bar Koordinatörü","Mutfak Koordinatörü","Salon Koordinatörü","Bulaşıkçı","Barista","Garson","Tatlı Ustası"],[s,a]=M.useState(!1),[l,u]=M.useState({fullName:(n==null?void 0:n.fullName)||"",phone:(n==null?void 0:n.phone)||"",email:(n==null?void 0:n.email)||"",department:(n==null?void 0:n.department)||"",position:(n==null?void 0:n.position)||""}),d=M.useMemo(()=>{const D=[...i],w=((n==null?void 0:n.position)||"").trim();return w&&!D.includes(w)&&D.push(w),D.sort((y,I)=>y.localeCompare(I,"tr",{sensitivity:"base"}))},[n==null?void 0:n.position]),m=()=>{a(!0)},p=async()=>{try{await r(l),a(!1)}catch(D){console.error("Profile update error:",D)}},g=()=>{u({fullName:(n==null?void 0:n.fullName)||"",phone:(n==null?void 0:n.phone)||"",email:(n==null?void 0:n.email)||"",department:(n==null?void 0:n.department)||"",position:(n==null?void 0:n.position)||""}),a(!1)},k=(D,w)=>{u(y=>({...y,[D]:w}))};return t?c.jsx("div",{className:"profile-modal-overlay",onClick:e,children:c.jsxs("div",{className:"profile-modal",onClick:D=>D.stopPropagation(),children:[c.jsxs("div",{className:"profile-modal-header",children:[c.jsx("h2",{children:"👤 Profil Bilgileri"}),c.jsx("button",{className:"close-button",onClick:e,children:"✕"})]}),c.jsxs("div",{className:"profile-modal-content",children:[c.jsxs("div",{className:"profile-avatar-section",children:[c.jsx("div",{className:"profile-avatar-large",children:(R=(S=(n==null?void 0:n.fullName)||"U")==null?void 0:S.charAt(0))==null?void 0:R.toUpperCase()}),c.jsx("button",{className:"avatar-upload-btn",children:"📷 Fotoğraf Yükle"})]}),c.jsxs("div",{className:"profile-info-section",children:[c.jsxs("div",{className:"profile-field",children:[c.jsx("label",{children:"Ad Soyad"}),s?c.jsx("input",{type:"text",value:l.fullName,onChange:D=>k("fullName",D.target.value),className:"profile-input"}):c.jsx("span",{className:"profile-value",children:(n==null?void 0:n.fullName)||"Belirtilmemiş"})]}),c.jsxs("div",{className:"profile-field",children:[c.jsx("label",{children:"📞 Telefon"}),s?c.jsx("input",{type:"tel",value:l.phone,onChange:D=>k("phone",D.target.value),className:"profile-input",placeholder:"0555 000 00 00"}):c.jsx("span",{className:"profile-value",children:(n==null?void 0:n.phone)||"Belirtilmemiş"})]}),c.jsxs("div",{className:"profile-field",children:[c.jsx("label",{children:"📧 Email"}),s?c.jsx("input",{type:"email",value:l.email,onChange:D=>k("email",D.target.value),className:"profile-input",placeholder:"ornek@email.com"}):c.jsx("span",{className:"profile-value",children:(n==null?void 0:n.email)||"Belirtilmemiş"})]}),c.jsxs("div",{className:"profile-field",children:[c.jsx("label",{children:"🏢 Departman"}),c.jsx("span",{className:"profile-value",children:n!=null&&n.department?n.department.toLocaleUpperCase("tr-TR"):"Belirtilmemiş"})]}),c.jsxs("div",{className:"profile-field",children:[c.jsx("label",{children:"💼 Pozisyon"}),s?c.jsxs("select",{className:"profile-input profile-select",value:l.position,onChange:D=>k("position",D.target.value),children:[c.jsx("option",{value:"",children:"Pozisyon Seçin"}),d.map(D=>c.jsx("option",{value:D,children:D},D))]}):c.jsx("span",{className:"profile-value",children:(n==null?void 0:n.position)||"Belirtilmemiş"})]})]}),c.jsx("div",{className:"profile-modal-actions",children:s?c.jsxs(c.Fragment,{children:[c.jsx("button",{className:"save-button",onClick:p,children:"💾 Kaydet"}),c.jsx("button",{className:"cancel-button",onClick:g,children:"❌ İptal"})]}):c.jsx("button",{className:"edit-button",onClick:m,children:"✏️ Düzenle"})})]})]})}):null},e2=({isOpen:t,onClose:e,userProfile:n,onOpenGorevler:r,onOpenMesaiTakip:i,onOpenMola:s})=>{if(!t)return null;const a=l=>{console.log(`${l} seçeneği seçildi`),l==="gunluk-gorevler"?r():l==="mesaiye-geldim"?i():l==="mola-ver"?s==null||s():e()};return c.jsx("div",{className:"personel-modal-overlay",onClick:e,children:c.jsxs("div",{className:"personel-modal",onClick:l=>l.stopPropagation(),children:[c.jsxs("div",{className:"personel-modal-header",children:[c.jsx("div",{className:"modal-icon",children:"👥"}),c.jsx("h2",{children:"Personel Takibi"}),c.jsx("p",{children:"Personel yönetimi"}),c.jsx("button",{className:"modal-close","aria-label":"Geri",title:"Geri",onClick:e,children:"←"})]}),c.jsx("div",{className:"personel-modal-content",children:c.jsxs("div",{className:"personel-options",children:[c.jsxs("div",{className:"personel-option",onClick:()=>a("mesaiye-geldim"),children:[c.jsx("div",{className:"option-icon",children:"🟢"}),c.jsxs("div",{className:"option-content",children:[c.jsx("h3",{children:"Mesaiye Geldim"}),c.jsx("p",{children:"Mesai başlangıç saatini kaydet"})]}),c.jsx("div",{className:"option-arrow",children:"→"})]}),c.jsxs("div",{className:"personel-option",onClick:()=>a("gunluk-gorevler"),children:[c.jsx("div",{className:"option-icon",children:"📋"}),c.jsxs("div",{className:"option-content",children:[c.jsx("h3",{children:"Günlük Görevler"}),c.jsx("p",{children:"Günlük görev atamaları ve takibi"})]}),c.jsx("div",{className:"option-arrow",children:"→"})]}),c.jsxs("div",{className:"personel-option",onClick:()=>a("mola-ver"),children:[c.jsx("div",{className:"option-icon",children:"☕"}),c.jsxs("div",{className:"option-content",children:[c.jsx("h3",{children:"Mola Ver"}),c.jsx("p",{children:"Mola saatlerini kaydet ve takip et"})]}),c.jsx("div",{className:"option-arrow",children:"→"})]}),c.jsxs("div",{className:"personel-option",onClick:()=>a("performans"),children:[c.jsx("div",{className:"option-icon",children:"📊"}),c.jsxs("div",{className:"option-content",children:[c.jsx("h3",{children:"Performans"}),c.jsx("p",{children:"Personel performans değerlendirmesi"})]}),c.jsx("div",{className:"option-arrow",children:"→"})]})]})})]})})},t2=({isOpen:t,onClose:e,userProfile:n})=>{const[r,i]=M.useState([]),[s,a]=M.useState(!1),[l,u]=M.useState(null),d=[{id:1,baslik:"Günlük Temizlik",aciklama:"Çalışma alanının günlük temizlik görevleri",durum:"aktif",altGorevler:[{id:11,baslik:"Masaları temizle",tamamlandi:!1},{id:12,baslik:"Zemini sil",tamamlandi:!1},{id:13,baslik:"Çöpleri boşalt",tamamlandi:!0},{id:14,baslik:"Ekipmanları düzenle",tamamlandi:!1}],onayDurumu:null},{id:2,baslik:"Stok Kontrol",aciklama:"Günlük stok sayım ve kontrol işlemleri",durum:"aktif",altGorevler:[{id:21,baslik:"Hammadde sayımı",tamamlandi:!0},{id:22,baslik:"Bitmiş ürün kontrolü",tamamlandi:!0},{id:23,baslik:"Eksik malzeme listesi",tamamlandi:!0}],onayDurumu:"bekliyor"},{id:3,baslik:"Müşteri Hizmetleri",aciklama:"Günlük müşteri takip ve hizmet görevleri",durum:"aktif",altGorevler:[{id:31,baslik:"Sabah müşteri karşılama",tamamlandi:!0},{id:32,baslik:"Sipariş alma",tamamlandi:!1},{id:33,baslik:"Müşteri memnuniyet anketi",tamamlandi:!1}],onayDurumu:null}];M.useEffect(()=>{t&&i(d)},[t]);const m=(R,D)=>{i(w=>w.map(y=>{if(y.id===R){const I=y.altGorevler.map(P=>P.id===D?{...P,tamamlandi:!P.tamamlandi}:P);return{...y,altGorevler:I}}return y}))},p=R=>R.altGorevler.every(D=>D.tamamlandi),g=R=>{i(D=>D.map(w=>w.id===R?{...w,onayDurumu:"bekliyor"}:w)),console.log(`Görev ${R} tamamlandı ve admin onayına gönderildi`)},k=R=>{switch(R){case"bekliyor":return"#ffc107";case"onaylandi":return"#28a745";case"reddedildi":return"#dc3545";default:return"#6c757d"}},S=R=>{switch(R){case"bekliyor":return"⏳ Onay Bekliyor";case"onaylandi":return"✅ Onaylandı";case"reddedildi":return"❌ Reddedildi";default:return""}};return t?c.jsx("div",{className:"gorevler-modal-overlay",onClick:e,children:c.jsxs("div",{className:"gorevler-modal",onClick:R=>R.stopPropagation(),children:[c.jsxs("div",{className:"gorevler-modal-header",children:[c.jsx("div",{className:"modal-icon",children:"📋"}),c.jsx("h2",{children:"Günlük Görevler"}),c.jsx("p",{children:"Günlük görev atamaları ve takibi"}),c.jsx("button",{className:"modal-close",onClick:e,children:"←"})]}),c.jsx("div",{className:"gorevler-modal-content",children:s?c.jsx("div",{className:"loading-message",children:"Görevler yükleniyor..."}):c.jsx("div",{className:"gorevler-listesi",children:r.map(R=>c.jsxs("div",{className:"gorev-karti",children:[c.jsxs("div",{className:"gorev-header",children:[c.jsx("h3",{children:R.baslik}),c.jsx("div",{className:"gorev-durum",children:R.onayDurumu&&c.jsx("span",{className:"onay-durumu",style:{backgroundColor:k(R.onayDurumu)},children:S(R.onayDurumu)})})]}),c.jsx("p",{className:"gorev-aciklama",children:R.aciklama}),c.jsxs("div",{className:"alt-gorevler",children:[c.jsx("h4",{children:"Alt Görevler:"}),c.jsx("div",{className:"alt-gorev-listesi",children:R.altGorevler.map(D=>c.jsxs("div",{className:`alt-gorev-item ${D.tamamlandi?"tamamlandi":""}`,onClick:()=>{R.onayDurumu!=="bekliyor"&&R.onayDurumu!=="onaylandi"&&m(R.id,D.id)},children:[c.jsx("div",{className:"checkbox",children:D.tamamlandi?"✓":"○"}),c.jsx("span",{className:"alt-gorev-baslik",children:D.baslik})]},D.id))})]}),c.jsxs("div",{className:"gorev-actions",children:[c.jsxs("div",{className:"ilerleme-bar",children:[c.jsxs("div",{className:"ilerleme-text",children:["İlerleme: ",R.altGorevler.filter(D=>D.tamamlandi).length,"/",R.altGorevler.length]}),c.jsx("div",{className:"progress-bar",children:c.jsx("div",{className:"progress-fill",style:{width:`${R.altGorevler.filter(D=>D.tamamlandi).length/R.altGorevler.length*100}%`}})})]}),c.jsx("button",{className:`gorev-tamamla-btn ${p(R)&&!R.onayDurumu?"aktif":"pasif"}`,disabled:!p(R)||R.onayDurumu,onClick:()=>g(R.id),children:R.onayDurumu==="bekliyor"?"⏳ Onay Bekliyor":R.onayDurumu==="onaylandi"?"✅ Tamamlandı":R.onayDurumu==="reddedildi"?"❌ Reddedildi":p(R)?"🎯 Görevi Tamamla":"⚠️ Alt Görevleri Tamamla"})]})]},R.id))})})]})}):null},n2=({userProfile:t,onBack:e})=>{var Ea,us;const[n,r]=M.useState(()=>{const T=localStorage.getItem("glowchocolate_gorevler");if(T)try{return JSON.parse(T)}catch(U){return console.error("Görevler yüklenirken hata:",U),[]}return[]}),[i,s]=M.useState(!1),[a,l]=M.useState(!1),[u,d]=M.useState("gorevler"),m=()=>new Date(Date.now()-new Date().getTimezoneOffset()*6e4).toISOString().split("T")[0],[p,g]=M.useState(m()),[k,S]=M.useState(!1),[R,D]=M.useState(null),[w,y]=M.useState(null),[I,P]=M.useState(null),[F,B]=M.useState(!1),[N,v]=M.useState(null),[E,x]=M.useState(!1),[A,b]=M.useState(""),[C,ye]=M.useState(!1),[Ue,be]=M.useState(!1),[ze,$]=M.useState(null),[K,Y]=M.useState({baslik:"",aciklama:"",altGorevler:[]}),[ve,ue]=M.useState(""),Ie=M.useRef(!1),[lt,Ae]=M.useState(null),[xt,Ye]=M.useState(!1),[yt,$n]=M.useState(null),[on,ne]=M.useState([]),[_e,de]=M.useState(""),[se,Te]=M.useState(""),[X,ce]=M.useState(""),fe=(t==null?void 0:t.role)==="admin",[Je,ct]=M.useState(null),De=[{id:1,baslik:"Günlük Temizlik",aciklama:"Çalışma alanının günlük temizlik görevleri",durum:"aktif",altGorevler:[{id:11,baslik:"Masaları temizle",tamamlandi:!1},{id:12,baslik:"Zemini sil",tamamlandi:!1},{id:13,baslik:"Çöpleri boşalt",tamamlandi:!0},{id:14,baslik:"Ekipmanları düzenle",tamamlandi:!1}],onayDurumu:"bekliyor"},{id:2,baslik:"Stok Kontrol",aciklama:"Günlük stok sayım ve kontrol işlemleri",durum:"aktif",altGorevler:[{id:21,baslik:"Hammadde sayımı",tamamlandi:!0},{id:22,baslik:"Bitmiş ürün kontrolü",tamamlandi:!0},{id:23,baslik:"Eksik malzeme listesi",tamamlandi:!0}],onayDurumu:"bekliyor",gonderenKullanici:{isim:"Ahmet Yılmaz",pozisyon:"Depo Sorumlusu",departman:"Lojistik"},gonderilmeTarihi:"2024-01-15T14:30:00",tamamlanmaFotografi:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAABAAEDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAv/xAAUEAEAAAAAAAAAAAAAAAAAAAAA/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAX/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwCdABmX/9k="},{id:3,baslik:"Müşteri Hizmetleri",aciklama:"Günlük müşteri takip ve hizmet görevleri",durum:"aktif",altGorevler:[{id:31,baslik:"Sabah müşteri karşılama",tamamlandi:!0},{id:32,baslik:"Sipariş alma",tamamlandi:!1},{id:33,baslik:"Müşteri memnuniyet anketi",tamamlandi:!1}],onayDurumu:null},{id:4,baslik:"Makine Bakım",aciklama:"Üretim makinelerinin günlük bakım kontrolleri",durum:"aktif",altGorevler:[{id:41,baslik:"Yağ seviyesi kontrolü",tamamlandi:!1},{id:42,baslik:"Sıcaklık ölçümü",tamamlandi:!1},{id:43,baslik:"Temizlik işlemi",tamamlandi:!1},{id:44,baslik:"Parça kontrolü",tamamlandi:!1}],onayDurumu:null}];M.useEffect(()=>{localStorage.getItem("glowchocolate_gorevler")||r(De)},[]),M.useEffect(()=>{(async()=>{try{const U=tt(xe(oe,"users"),at("isActive","==",!0),as("fullName")),J=await ot(U),Z=[];J.forEach(q=>{const ee=q.data();ee.uid&&ee.uid!==(t==null?void 0:t.uid)&&Z.push({uid:ee.uid,fullName:ee.fullName,department:ee.department,position:ee.position,email:ee.email})}),ne(Z)}catch(U){console.warn("Kullanıcı listesi yüklenemedi, offline olabilir:",U);const J=JSON.parse(localStorage.getItem("glowchocolate_users_cache")||"[]");ne(J)}})()},[t==null?void 0:t.uid]),M.useEffect(()=>{n.length>0&&(localStorage.setItem("glowchocolate_gorevler",JSON.stringify(n)),console.log("🔄 Görevler localStorage'a kaydedildi:",n.length,"görev"))},[n]);const ln=async()=>{if(!a){s(!0);try{const T=await jP();if(T.success&&T.gorevler.length>0)r(T.gorevler),localStorage.setItem("glowchocolate_gorevler",JSON.stringify(T.gorevler)),l(!0),console.log("✅ Firebase'den görevler yüklendi:",T.gorevler.length,"görev");else if(n.length>0){console.log("📤 Örnek görevler Firebase'e kaydediliyor...");for(const U of n)await DP(U);l(!0)}}catch(T){console.error("Firebase görev yükleme hatası:",T)}finally{s(!1)}}},Ct=async()=>{try{const T=await OP();T.success&&localStorage.setItem("glowchocolate_onay_bekleyenler",JSON.stringify(T.onayBekleyenler));const U=await MP();U.success&&localStorage.setItem("glowchocolate_onaylananlar",JSON.stringify(U.onaylananlar));const J=await VP();if(J.success){const Z=(J.reddedilenler||[]).map(q=>({...q,redNedeni:q.redNedeni??q.adminNotu??"",redTarihi:q.redTarihi??q.onayTarihi??q.gonderilmeTarihi??q.createdAt}));localStorage.setItem("glowchocolate_reddedilenler",JSON.stringify(Z))}console.log("✅ Firebase onay verileri yüklendi")}catch(T){console.error("Firebase onay verileri yükleme hatası:",T)}};M.useEffect(()=>{ln(),Ct()},[]),M.useEffect(()=>{console.log("📋 Mevcut görevler durumu:",{toplamGorev:n.length,aktifGorevlerTabinda:n.length,onayBekleyenler:jr().length,onaylananlar:Wt().length,reddedilenler:sr()})},[n]);const Rt=T=>{const J=JSON.parse(localStorage.getItem("glowchocolate_currentUser")||"{}").email||"anonymous";return JSON.parse(localStorage.getItem(`glowchocolate_user_selections_${J}`)||"{}")[T]||[]},bt=(T,U)=>{const Z=JSON.parse(localStorage.getItem("glowchocolate_currentUser")||"{}").email||"anonymous",q=JSON.parse(localStorage.getItem(`glowchocolate_user_selections_${Z}`)||"{}");q[T]=U,localStorage.setItem(`glowchocolate_user_selections_${Z}`,JSON.stringify(q))},Oe=(T,U)=>{const J=Rt(T),Z=J.includes(U)?J.filter(q=>q!==U):[...J,U];bt(T,Z),r(q=>[...q])},Xe=(T,U)=>Rt(T).includes(U),Gn=T=>Rt(T.id).length>0,il=T=>{const U=n.find(J=>J.id===T);D(U),S(!0)},sl=T=>{const U=n.find(J=>J.id===T);$n(U),ce("Temizliği bugün aksilikten dolayı tamamlayamıyorum. Mümkünse benim yerime yardımcı olur musun?"),Te(""),Ye(!0)},dd=async()=>{if(!yt||!se){Ae({type:"warning",message:"Lütfen bir kullanıcı seçin."}),setTimeout(()=>Ae(null),2e3);return}s(!0);try{const T=on.find(q=>q.uid===se),U=new Date().toISOString(),J={gorevId:yt.id,gorevBaslik:yt.baslik,gorevAciklama:yt.aciklama,gonderen:{uid:t==null?void 0:t.uid,fullName:t==null?void 0:t.fullName,email:t==null?void 0:t.email,department:t==null?void 0:t.department,position:t==null?void 0:t.position},hedef:{uid:T==null?void 0:T.uid,fullName:T==null?void 0:T.fullName,email:T==null?void 0:T.email,department:T==null?void 0:T.department,position:T==null?void 0:T.position},not:X,tarih:U,status:"bekliyor"},Z=await XP(J);if(Z.success){const q=JSON.parse(localStorage.getItem("glowchocolate_gorev_ricalari")||"[]");q.push({...J,id:Z.id}),localStorage.setItem("glowchocolate_gorev_ricalari",JSON.stringify(q)),Ae({type:"success",message:`${T==null?void 0:T.fullName} kişisine rica gönderildi.`})}else{const q=`local_${Date.now()}`,ee=JSON.parse(localStorage.getItem("glowchocolate_gorev_ricalari")||"[]");ee.push({...J,id:q,offline:!0}),localStorage.setItem("glowchocolate_gorev_ricalari",JSON.stringify(ee)),Ae({type:"warning",message:"Çevrimdışı: Rica yerel olarak kaydedildi."})}setTimeout(()=>Ae(null),2500),Ye(!1),$n(null),Te(""),ce("")}catch(T){console.error("Rica gönderilemedi:",T),Ae({type:"error",message:"Rica gönderilemedi."}),setTimeout(()=>Ae(null),2500)}finally{s(!1)}},ki=async()=>{if(!Ie.current&&R){Ie.current=!0,s(!0);try{const T=new Date().toISOString(),U=Rt(R.id),J=R.altGorevler.filter(ee=>U.includes(ee.id)),Z={gorevId:R.id,gorevBaslik:R.baslik,gorevAciklama:R.aciklama,gonderenKullanici:{isim:(t==null?void 0:t.fullName)||"Kullanıcı",pozisyon:(t==null?void 0:t.position)||"Pozisyon",departman:(t==null?void 0:t.department)||"Departman",email:(t==null?void 0:t.email)||"email@example.com"},gonderilmeTarihi:T,tamamlanmaFotografi:w,tamamlananAltGorevler:J,onayDurumu:"bekliyor"},q=await PP(Z);if(q.success)await Ct(),console.log("✅ Görev Firebase'e kaydedildi ve onaya gönderildi"),Ae({type:"success",message:"Görev admin onayına gönderildi."}),setTimeout(()=>Ae(null),2500);else{console.error("Firebase kaydetme hatası:",q.message);const ee={...Z,id:Date.now()},ft=JSON.parse(localStorage.getItem("glowchocolate_onay_bekleyenler")||"[]");ft.push(ee),localStorage.setItem("glowchocolate_onay_bekleyenler",JSON.stringify(ft)),Ae({type:"warning",message:"İnternet sorunu: Yerel olarak kaydedildi."}),setTimeout(()=>Ae(null),2500)}bt(R.id,[]),S(!1),D(null),y(null),I&&(I.getTracks().forEach(ee=>ee.stop()),P(null))}catch(T){console.error("Görev tamamlama hatası:",T),Ae({type:"error",message:"Görev onaya gönderilemedi."}),setTimeout(()=>Ae(null),2500)}finally{s(!1),Ie.current=!1}}},ya=async()=>{try{const T=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});P(T)}catch(T){console.error("Kamera erişim hatası:",T),alert("Kameraya erişim izni gerekli!")}},al=()=>{if(I){const T=document.getElementById("camera-video"),U=document.createElement("canvas");U.width=T.videoWidth,U.height=T.videoHeight,U.getContext("2d").drawImage(T,0,0);const Z=U.toDataURL("image/jpeg",.8);y(Z),I.getTracks().forEach(q=>q.stop()),P(null)}},va=()=>{y(null),ya()},_a=T=>{v(T),B(!0)},ol=()=>{v(null),B(!1)},wa=async T=>{s(!0);try{const U=await y_(T,"onaylandi","");if(U.success)await Ct(),console.log("✅ Görev Firebase'de onaylandı");else{console.error("Firebase onaylama hatası:",U.message);const Z=JSON.parse(localStorage.getItem("glowchocolate_onay_bekleyenler")||"[]").map(ee=>ee.id===T?{...ee,onayDurumu:"onaylandi",onayTarihi:new Date().toISOString()}:ee);localStorage.setItem("glowchocolate_onay_bekleyenler",JSON.stringify(Z));const q=Z.find(ee=>ee.id===T);if(q){const ee=JSON.parse(localStorage.getItem("glowchocolate_onaylananlar")||"[]");ee.push(q),localStorage.setItem("glowchocolate_onaylananlar",JSON.stringify(ee))}}}catch(U){console.error("Onaylama hatası:",U)}finally{s(!1)}},ll=T=>{const J=JSON.parse(localStorage.getItem("glowchocolate_onay_bekleyenler")||"[]").find(Z=>Z.id===T);J&&(ct(J),x(!0))},cl=async()=>{if(Je&&A.trim()){s(!0);try{const T=await y_(Je.id,"reddedildi",A);if(T.success)await Ct(),console.log("✅ Görev Firebase'de reddedildi");else{console.error("Firebase reddetme hatası:",T.message);const U={...Je,onayDurumu:"reddedildi",redNedeni:A,redTarihi:new Date().toISOString()},Z=JSON.parse(localStorage.getItem("glowchocolate_onay_bekleyenler")||"[]").filter(ee=>ee.id!==Je.id);localStorage.setItem("glowchocolate_onay_bekleyenler",JSON.stringify(Z));const q=JSON.parse(localStorage.getItem("glowchocolate_reddedilenler")||"[]");q.push(U),localStorage.setItem("glowchocolate_reddedilenler",JSON.stringify(q))}x(!1),ct(null),b("")}catch(T){console.error("Reddetme hatası:",T)}finally{s(!1)}}},Dr=T=>{switch(T){case"bekliyor":return"#ffc107";case"onaylandi":return"#28a745";case"reddedildi":return"#dc3545";default:return"#6c757d"}},os=T=>{switch(T){case"bekliyor":return"⏳ Onay Bekliyor";case"onaylandi":return"✅ Onaylandı";case"reddedildi":return"❌ Reddedildi";default:return""}},Ii=T=>{try{if(!T)return new Date(0);if(typeof(T==null?void 0:T.toDate)=="function")return T.toDate();if(T&&typeof T=="object"&&"seconds"in T)return new Date(T.seconds*1e3);const U=new Date(T);return isNaN(U.getTime())?new Date(0):U}catch{return new Date(0)}},Wt=(T=null)=>{const U=JSON.parse(localStorage.getItem("glowchocolate_onaylananlar")||"[]");if(!T)return U;const J=new Date(T).toDateString();return U.filter(Z=>{const q=Z.onayTarihi||Z.gonderilmeTarihi||Z.createdAt;return Ii(q).toDateString()===J})},jr=(T=null)=>{const U=JSON.parse(localStorage.getItem("glowchocolate_onay_bekleyenler")||"[]").filter(Z=>Z.onayDurumu==="bekliyor");if(!T)return U;const J=new Date(T).toDateString();return U.filter(Z=>{const q=Z.gonderilmeTarihi||Z.createdAt||Z.tamamlanmaTarihi;let ee;try{q&&typeof q.toDate=="function"?ee=q.toDate():q&&q.seconds?ee=new Date(q.seconds*1e3):ee=new Date(q)}catch{ee=new Date(0)}return ee.toDateString()===J})},ls=()=>n,cs=(T=null)=>{const J=JSON.parse(localStorage.getItem("glowchocolate_reddedilenler")||"[]").map(q=>({...q,redNedeni:q.redNedeni??q.adminNotu??"",redTarihi:q.redTarihi??q.onayTarihi??q.gonderilmeTarihi??q.createdAt}));if(!T)return J;const Z=new Date(T).toDateString();return J.filter(q=>{const ee=q.redTarihi||q.onayTarihi||q.createdAt;return Ii(ee).toDateString()===Z})},sr=()=>cs(p).length,ul=()=>Wt(p).length,vt=()=>jr(p).length,dl=()=>{const T=new Date().toDateString();if(localStorage.getItem("glowchocolate_last_reset_date")!==T){console.log("🌅 Yeni gün başladı, görevler sıfırlanıyor...");const Z=JSON.parse(localStorage.getItem("glowchocolate_currentUser")||"{}").email||"anonymous";localStorage.removeItem(`glowchocolate_user_selections_${Z}`),localStorage.setItem("glowchocolate_last_reset_date",T),console.log("✅ Günlük sıfırlama tamamlandı")}},Si=T=>{$(T),Y({baslik:T.baslik,aciklama:T.aciklama,altGorevler:[...T.altGorevler]}),be(!0)},Ai=async T=>{if(window.confirm("Bu görevi silmek istediğinizden emin misiniz?"))try{const U=n.filter(J=>J.id!==T);r(U),localStorage.setItem("glowchocolate_gorevler",JSON.stringify(U)),console.log("✅ Görev başarıyla silindi")}catch(U){console.error("Görev silme hatası:",U)}},hd=()=>{if(K.baslik&&K.aciklama&&K.altGorevler.length>0){const T={id:Date.now(),...K,durum:"aktif",onayDurumu:null},U=[...n,T];r(U),localStorage.setItem("glowchocolate_gorevler",JSON.stringify(U)),Y({baslik:"",aciklama:"",altGorevler:[]}),ue(""),ye(!1),console.log("✅ Yeni görev eklendi")}},fd=()=>{if(ze&&K.baslik&&K.aciklama&&K.altGorevler.length>0){const T=n.map(U=>U.id===ze.id?{...U,...K}:U);r(T),localStorage.setItem("glowchocolate_gorevler",JSON.stringify(T)),$(null),Y({baslik:"",aciklama:"",altGorevler:[]}),ue(""),be(!1),console.log("✅ Görev güncellendi")}},Rn=()=>{if(ve.trim()){const T={id:Date.now(),baslik:ve.trim(),durum:"aktif"};Y(U=>({...U,altGorevler:[...U.altGorevler,T]})),ue("")}},hl=T=>{Y(U=>({...U,altGorevler:U.altGorevler.filter(J=>J.id!==T)}))};M.useEffect(()=>{dl()},[]);const md=(T,U)=>{if(!T||!U)return 0;const J=new Date(U).toDateString();return Wt().filter(q=>{var ft;const ee=Ii(q.gonderilmeTarihi).toDateString();return((ft=q.gonderenKullanici)==null?void 0:ft.email)===T&&ee===J}).length},Kn=T=>{if(!T)return"Bilinmiyor";let U;try{typeof T.toDate=="function"?U=T.toDate():T&&T.seconds?U=new Date(T.seconds*1e3):U=new Date(T)}catch{U=new Date(T)}const J=new Date,Z=new Date;Z.setDate(J.getDate()-1);const q=U.toLocaleDateString("tr-TR"),ee=U.toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"});return U.toDateString()===J.toDateString()?`Bugün ${ee}`:U.toDateString()===Z.toDateString()?`Dün ${ee}`:`${q} ${ee}`};return c.jsxs("div",{className:"gunluk-gorevler-container",children:[c.jsxs("header",{className:"gorevler-header",children:[c.jsxs("div",{className:"header-left",children:[c.jsx("button",{className:"geri-btn",onClick:e,children:"← Geri"}),c.jsxs("div",{className:"header-title",children:[c.jsx("h1",{children:"📋 Günlük Görevler"}),c.jsx("p",{children:"Günlük görev atamaları ve takibi"})]})]}),c.jsxs("div",{className:"date-picker-container",children:[c.jsx("label",{htmlFor:"date-picker",children:"📅 Tarih Seç:"}),c.jsx("input",{id:"date-picker",type:"date",value:p,onChange:T=>g(T.target.value),max:m(),className:"date-picker-input"}),c.jsx("button",{className:"bugun-btn",onClick:()=>g(m()),children:"Bugün"})]}),c.jsxs("div",{className:"header-stats",children:[c.jsxs("div",{className:"stat-card",children:[c.jsx("div",{className:"stat-number",children:n.length}),c.jsx("div",{className:"stat-label",children:"Toplam Görev"})]}),c.jsxs("div",{className:"stat-card",children:[c.jsx("div",{className:"stat-number",children:ul()}),c.jsx("div",{className:"stat-label",children:"Tamamlanan"})]}),c.jsxs("div",{className:"stat-card",children:[c.jsx("div",{className:"stat-number",children:vt()}),c.jsx("div",{className:"stat-label",children:"Onay Bekliyor"})]}),c.jsxs("div",{className:"stat-card",children:[c.jsx("div",{className:"stat-number",children:sr()}),c.jsx("div",{className:"stat-label",children:"Reddedilen"})]}),fe&&c.jsx("button",{className:"admin-gorev-ekle-btn",onClick:()=>ye(!0),title:"Yeni Görev Ekle",children:"➕ Görev Ekle"})]})]}),c.jsxs("main",{className:"gorevler-main",children:[c.jsxs("div",{className:"user-info-bar",children:[c.jsx("div",{className:"user-avatar",children:((us=(Ea=t==null?void 0:t.fullName)==null?void 0:Ea.charAt(0))==null?void 0:us.toUpperCase())||"U"}),c.jsxs("div",{className:"user-details",children:[c.jsx("h3",{children:(t==null?void 0:t.fullName)||"Kullanıcı"}),c.jsxs("p",{children:[String((t==null?void 0:t.department)||"Departman").toLocaleUpperCase("tr-TR")," - ",String((t==null?void 0:t.position)||"Pozisyon").toLocaleUpperCase("tr-TR")]})]}),c.jsx("div",{className:"tarih-info",children:c.jsx("div",{className:"tarih",children:new Date().toLocaleDateString("tr-TR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})})]}),c.jsxs("div",{className:"tab-navigation",children:[c.jsxs("button",{className:`tab-btn ${u==="gorevler"?"active":""}`,onClick:()=>d("gorevler"),children:["📋 Aktif Görevler (",n.length,")"]}),c.jsxs("button",{className:`tab-btn ${u==="onay-bekleyen"?"active":""}`,onClick:()=>d("onay-bekleyen"),children:["⏳ Onay Bekleyenler (",jr(p).length,")"]}),c.jsxs("button",{className:`tab-btn ${u==="onaylanan"?"active":""}`,onClick:()=>d("onaylanan"),children:["✅ Onaylananlar (",Wt(p).length,")"]}),c.jsxs("button",{className:`tab-btn ${u==="reddedilenler"?"active":""}`,onClick:()=>d("reddedilenler"),children:["❌ Reddedilenler (",sr(),")"]})]}),i?c.jsx("div",{className:"loading-message",children:"Görevler yükleniyor..."}):c.jsxs("div",{className:"gorevler-grid",children:[u==="gorevler"&&ls().map(T=>c.jsxs("div",{className:"gorev-karti",children:[c.jsx("div",{className:"gorev-header",children:c.jsx("h3",{children:T.baslik})}),c.jsx("p",{className:"gorev-aciklama",children:T.aciklama}),c.jsxs("div",{className:"alt-gorevler",children:[c.jsx("h4",{children:"Alt Görevler:"}),c.jsx("div",{className:"alt-gorev-listesi",children:T.altGorevler.map(U=>c.jsxs("div",{className:`alt-gorev-item ${Xe(T.id,U.id)?"tamamlandi":""}`,onClick:()=>Oe(T.id,U.id),children:[c.jsx("div",{className:"checkbox",children:Xe(T.id,U.id)?"✓":"○"}),c.jsx("span",{className:"alt-gorev-baslik",children:U.baslik})]},U.id))})]}),c.jsxs("div",{className:"gorev-actions",children:[c.jsxs("div",{className:"ilerleme-bar",children:[c.jsxs("div",{className:"ilerleme-text",children:["İlerleme: ",Rt(T.id).length,"/",T.altGorevler.length]}),c.jsx("div",{className:"progress-bar",children:c.jsx("div",{className:"progress-fill",style:{width:`${Rt(T.id).length/T.altGorevler.length*100}%`}})})]}),fe&&c.jsxs("div",{className:"admin-actions",children:[c.jsx("button",{className:"admin-btn edit-btn",onClick:()=>Si(T),title:"Görevi Düzenle",children:"✏️"}),c.jsx("button",{className:"admin-btn delete-btn",onClick:()=>Ai(T.id),title:"Görevi Sil",children:"🗑️"})]}),c.jsx("button",{className:`gorev-tamamla-btn ${Gn(T)?"aktif":"pasif"}`,disabled:!Gn(T),onClick:()=>il(T.id),children:Gn(T)?"🎯 Görevi Tamamla":"⚠️ En Az 1 Alt Görev Tamamla"}),c.jsxs("button",{className:"rica-et-btn",onClick:()=>sl(T.id),title:"Bu görevi başka birinden rica et",children:[c.jsx("span",{className:"ico",children:"🙏"}),c.jsx("span",{className:"label",children:"Rica Et"})]})]})]},T.id)),u==="onay-bekleyen"&&(jr(p).length===0?c.jsxs("div",{className:"bos-durum-mesaji",children:[c.jsx("div",{className:"bos-ikon",children:"⏳"}),c.jsx("h3",{children:"Onay Bekleyen Görev Yok"}),c.jsx("p",{children:"Kullanıcılar tarafından tamamlanan görevler burada görünecektir."})]}):jr(p).map(T=>{var U,J,Z,q,ee,ft;return c.jsxs("div",{className:"gorev-karti onay-bekleyen-kart",children:[c.jsxs("div",{className:"gorev-header",children:[c.jsx("h3",{children:T.gorevBaslik||T.baslik}),c.jsx("div",{className:"gorev-durum",children:c.jsx("span",{className:"onay-durumu",style:{backgroundColor:Dr(T.onayDurumu)},children:os(T.onayDurumu)})})]}),c.jsx("p",{className:"gorev-aciklama",children:T.gorevAciklama||T.aciklama}),c.jsxs("div",{className:"gonderen-bilgi",children:[c.jsxs("div",{className:"kullanici-info",children:[c.jsx("div",{className:"kullanici-avatar",children:((Z=(J=(U=T.gonderenKullanici)==null?void 0:U.isim)==null?void 0:J.charAt(0))==null?void 0:Z.toUpperCase())||"U"}),c.jsxs("div",{className:"kullanici-detay",children:[c.jsx("h4",{children:((q=T.gonderenKullanici)==null?void 0:q.isim)||"Bilinmeyen Kullanıcı"}),c.jsxs("p",{children:[String(((ee=T.gonderenKullanici)==null?void 0:ee.departman)||"Departman").toLocaleUpperCase("tr-TR")," - ",String(((ft=T.gonderenKullanici)==null?void 0:ft.pozisyon)||"Pozisyon").toLocaleUpperCase("tr-TR")]})]})]}),c.jsxs("div",{className:"gonderilme-tarihi",children:[c.jsx("span",{className:"tarih-ikon",children:"📅"}),c.jsx("span",{className:"tarih-text",children:Kn(T.gonderilmeTarihi||T.createdAt)})]})]}),c.jsxs("div",{className:"alt-gorevler",children:[c.jsx("h4",{children:"Tamamlanan Alt Görevler:"}),c.jsx("div",{className:"alt-gorev-listesi",children:(T.tamamlananAltGorevler||[]).map(bn=>c.jsxs("div",{className:"alt-gorev-item tamamlandi",children:[c.jsx("div",{className:"checkbox",children:"✓"}),c.jsx("span",{className:"alt-gorev-baslik",children:bn.baslik})]},bn.id))})]}),T.tamamlanmaFotografi&&c.jsxs("div",{className:"kanit-fotografi",children:[c.jsx("h4",{children:"📸 Kanıt Fotoğrafı:"}),c.jsxs("div",{className:"foto-container",children:[c.jsx("img",{src:T.tamamlanmaFotografi,alt:"Görev kanıt fotoğrafı",className:"kanit-foto",onClick:()=>_a(T.tamamlanmaFotografi)}),c.jsx("div",{className:"foto-overlay",children:c.jsx("span",{children:"🔍 Büyütmek için tıkla"})})]})]}),c.jsxs("div",{className:"admin-onay-actions",children:[c.jsx("button",{className:"onayla-btn",onClick:()=>wa(T.id),children:"✅ Onayla"}),c.jsx("button",{className:"reddet-btn",onClick:()=>ll(T.id),children:"❌ Reddet"})]})]},T.id)})),u==="onaylanan"&&(Wt(p).length===0?c.jsxs("div",{className:"bos-durum-mesaji",children:[c.jsx("div",{className:"bos-ikon",children:"✅"}),c.jsx("h3",{children:"Henüz Onaylanan Görev Yok"}),c.jsx("p",{children:"Admin tarafından onaylanan görevler burada görünecektir."})]}):Wt(p).map(T=>{var U,J,Z,q,ee,ft,bn;return c.jsxs("div",{className:"gorev-karti onaylanan-kart",children:[c.jsxs("div",{className:"gorev-header",children:[c.jsx("h3",{children:T.gorevBaslik}),c.jsx("div",{className:"gorev-durum",children:c.jsx("span",{className:"onay-durumu",style:{backgroundColor:Dr(T.onayDurumu)},children:os(T.onayDurumu)})})]}),c.jsx("p",{className:"gorev-aciklama",children:T.gorevAciklama}),c.jsxs("div",{className:"gonderen-bilgi",children:[c.jsxs("div",{className:"kullanici-info",children:[c.jsx("div",{className:"kullanici-avatar",children:((Z=(J=(U=T.gonderenKullanici)==null?void 0:U.isim)==null?void 0:J.charAt(0))==null?void 0:Z.toUpperCase())||"U"}),c.jsxs("div",{className:"kullanici-detay",children:[c.jsx("h4",{children:((q=T.gonderenKullanici)==null?void 0:q.isim)||"Bilinmeyen Kullanıcı"}),c.jsxs("p",{children:[String(((ee=T.gonderenKullanici)==null?void 0:ee.departman)||"Departman").toLocaleUpperCase("tr-TR")," - ",String(((ft=T.gonderenKullanici)==null?void 0:ft.pozisyon)||"Pozisyon").toLocaleUpperCase("tr-TR")]})]})]}),c.jsxs("div",{className:"tarih-bilgileri",children:[c.jsxs("div",{className:"gonderilme-tarihi",children:[c.jsx("span",{className:"tarih-ikon",children:"📤"}),c.jsxs("span",{className:"tarih-text",children:["Gönderilme: ",Kn(T.gonderilmeTarihi)]})]}),c.jsxs("div",{className:"onay-tarihi",children:[c.jsx("span",{className:"tarih-ikon",children:"✅"}),c.jsxs("span",{className:"tarih-text",children:["Onaylanma: ",Kn(T.onayTarihi)]})]})]})]}),c.jsx("div",{className:"gunluk-istatistik",children:c.jsxs("div",{className:"istatistik-box",children:[c.jsx("span",{className:"istatistik-ikon",children:"📊"}),c.jsxs("div",{className:"istatistik-detay",children:[c.jsx("span",{className:"istatistik-sayi",children:md((bn=T.gonderenKullanici)==null?void 0:bn.email,T.gonderilmeTarihi)}),c.jsx("span",{className:"istatistik-text",children:"Günlük Tamamlanan"})]})]})}),c.jsxs("div",{className:"alt-gorevler",children:[c.jsx("h4",{children:"Tamamlanan Alt Görevler:"}),c.jsx("div",{className:"alt-gorev-listesi",children:(T.tamamlananAltGorevler||[]).map(fl=>c.jsxs("div",{className:"alt-gorev-item tamamlandi",children:[c.jsx("div",{className:"checkbox",children:"✓"}),c.jsx("span",{className:"alt-gorev-baslik",children:fl.baslik})]},fl.id))})]}),T.tamamlanmaFotografi&&c.jsxs("div",{className:"kanit-fotografi",children:[c.jsx("h4",{children:"📸 Kanıt Fotoğrafı:"}),c.jsxs("div",{className:"foto-container",children:[c.jsx("img",{src:T.tamamlanmaFotografi,alt:"Görev kanıt fotoğrafı",className:"kanit-foto",onClick:()=>_a(T.tamamlanmaFotografi)}),c.jsx("div",{className:"foto-overlay",children:c.jsx("span",{children:"🔍 Büyütmek için tıkla"})})]})]}),c.jsx("div",{className:"tamamlandi-badge",children:c.jsx("span",{children:"🏆 Başarıyla Tamamlandı"})})]},T.id)})),u==="reddedilenler"&&(cs(p).length===0?c.jsxs("div",{className:"bos-durum-mesaji",children:[c.jsx("div",{className:"bos-ikon",children:"❌"}),c.jsx("h3",{children:"Reddedilen Görev Yok"}),c.jsx("p",{children:"Admin tarafından reddedilen görevler burada görünecektir."})]}):cs(p).map(T=>{var U,J,Z,q,ee,ft;return c.jsxs("div",{className:"gorev-karti reddedilen-kart",children:[c.jsxs("div",{className:"gorev-header",children:[c.jsx("h3",{children:T.gorevBaslik}),c.jsx("div",{className:"gorev-durum",children:c.jsx("span",{className:"onay-durumu reddedildi-durumu",children:"❌ Reddedildi"})})]}),c.jsx("p",{className:"gorev-aciklama",children:T.gorevAciklama}),c.jsxs("div",{className:"gonderen-bilgi",children:[c.jsxs("div",{className:"kullanici-info",children:[c.jsx("div",{className:"kullanici-avatar",children:((Z=(J=(U=T.gonderenKullanici)==null?void 0:U.isim)==null?void 0:J.charAt(0))==null?void 0:Z.toUpperCase())||"U"}),c.jsxs("div",{className:"kullanici-detay",children:[c.jsx("h4",{children:((q=T.gonderenKullanici)==null?void 0:q.isim)||"Bilinmeyen Kullanıcı"}),c.jsxs("p",{children:[String(((ee=T.gonderenKullanici)==null?void 0:ee.departman)||"Departman").toLocaleUpperCase("tr-TR")," - ",String(((ft=T.gonderenKullanici)==null?void 0:ft.pozisyon)||"Pozisyon").toLocaleUpperCase("tr-TR")]})]})]}),c.jsxs("div",{className:"gonderilme-tarihi",children:[c.jsx("span",{className:"tarih-ikon",children:"📅"}),c.jsx("span",{className:"tarih-text",children:Kn(T.gonderilmeTarihi)})]})]}),c.jsxs("div",{className:"red-nedeni",children:[c.jsx("h4",{children:"⚠️ Red Nedeni:"}),c.jsx("div",{className:"red-aciklama",children:T.redNedeni}),c.jsx("div",{className:"red-tarihi",children:c.jsxs("span",{children:["🕐 Red Tarihi: ",Kn(T.redTarihi)]})})]}),c.jsxs("div",{className:"alt-gorevler",children:[c.jsx("h4",{children:"Tamamlanmış Alt Görevler:"}),c.jsx("div",{className:"alt-gorev-listesi",children:(T.tamamlananAltGorevler||[]).map(bn=>c.jsxs("div",{className:"alt-gorev-item tamamlandi",children:[c.jsx("div",{className:"checkbox",children:"✓"}),c.jsx("span",{className:"alt-gorev-baslik",children:bn.baslik})]},bn.id))})]}),T.tamamlanmaFotografi&&c.jsxs("div",{className:"kanit-fotografi",children:[c.jsx("h4",{children:"📸 Gönderilen Fotoğraf:"}),c.jsxs("div",{className:"foto-container",children:[c.jsx("img",{src:T.tamamlanmaFotografi,alt:"Reddedilen görev fotoğrafı",className:"kanit-foto",onClick:()=>_a(T.tamamlanmaFotografi)}),c.jsx("div",{className:"foto-overlay",children:c.jsx("span",{children:"🔍 Büyütmek için tıkla"})})]})]})]},T.id)}))]})]}),k&&c.jsx("div",{className:"modal-overlay",children:c.jsxs("div",{className:"tamamla-modal",children:[i&&c.jsx("div",{style:{height:"3px",background:"rgba(212,175,55,0.25)"},children:c.jsx("div",{style:{height:"100%",width:"100%",background:"#d4af37",animation:"loadingBar 1s linear infinite"}})}),c.jsxs("div",{className:"modal-header",children:[c.jsx("h3",{children:"📋 Görev Tamamlama"}),c.jsx("button",{className:"modal-close-btn",onClick:()=>{S(!1),D(null),y(null),I&&(I.getTracks().forEach(T=>T.stop()),P(null))},children:"✕"})]}),c.jsxs("div",{className:"modal-content",children:[c.jsxs("div",{className:"gorev-bilgi",children:[c.jsx("h4",{children:R==null?void 0:R.baslik}),c.jsx("p",{children:R==null?void 0:R.aciklama}),c.jsxs("div",{className:"tamamlanan-alt-gorevler",children:[c.jsx("h5",{children:"✅ Tamamlanan Alt Görevler:"}),c.jsx("ul",{children:R==null?void 0:R.altGorevler.filter(T=>Rt(R.id).includes(T.id)).map(T=>c.jsx("li",{children:T.baslik},T.id))})]})]}),c.jsxs("div",{className:"fotograf-bolumu",children:[c.jsx("h4",{children:"📸 Fotoğraf Çek"}),c.jsx("p",{children:"Görevin tamamlandığını kanıtlamak için bir fotoğraf çekin."}),!I&&!w&&c.jsx("button",{className:"kamera-baslat-btn",onClick:ya,children:"📷 Kamerayı Başlat"}),I&&!w&&c.jsxs("div",{className:"kamera-container",children:[c.jsx("video",{id:"camera-video",autoPlay:!0,playsInline:!0,ref:T=>{T&&I&&(T.srcObject=I)}}),c.jsx("button",{className:"foto-cek-btn",onClick:al,children:"📸 Fotoğraf Çek"})]}),w&&c.jsxs("div",{className:"cekilen-foto",children:[c.jsx("img",{src:w,alt:"Çekilen fotoğraf"}),c.jsx("div",{className:"foto-actions",children:c.jsx("button",{className:"tekrar-cek-btn",onClick:va,children:"🔄 Tekrar Çek"})})]})]}),c.jsxs("div",{className:"modal-actions",children:[c.jsx("button",{className:"iptal-btn",onClick:()=>{S(!1),D(null),y(null),I&&(I.getTracks().forEach(T=>T.stop()),P(null))},children:"❌ İptal"}),c.jsx("button",{className:"onayla-gonder-btn",onClick:ki,disabled:!w||i,children:i?"Gönderiliyor…":"✅ Admin Onayına Gönder"})]}),c.jsx("div",{className:"uyari-mesaj",children:"⚠️ Bu görev admin onayına gönderilecektir. Fotoğraf kanıt olarak kullanılacaktır."})]})]})}),xt&&c.jsx("div",{className:"modal-overlay",onClick:()=>Ye(!1),children:c.jsxs("div",{className:"rica-modal",onClick:T=>T.stopPropagation(),children:[i&&c.jsx("div",{style:{height:"3px",background:"rgba(212,175,55,0.25)"},children:c.jsx("div",{style:{height:"100%",width:"100%",background:"#d4af37",animation:"loadingBar 1s linear infinite"}})}),c.jsxs("div",{className:"modal-header",children:[c.jsx("h3",{children:"🙏 Rica Et"}),c.jsx("button",{className:"modal-close-btn",onClick:()=>Ye(!1),children:"✕"})]}),c.jsxs("div",{className:"modal-content",children:[c.jsxs("div",{className:"gorev-bilgi",children:[c.jsx("h4",{children:yt==null?void 0:yt.baslik}),c.jsx("p",{children:yt==null?void 0:yt.aciklama})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{children:"Kimden rica edeceksin?"}),c.jsx("input",{type:"text",placeholder:"İsimle ara...",value:_e,onChange:T=>de(T.target.value)}),c.jsx("div",{className:"kisi-listesi",children:on.filter(T=>(T.fullName||"").toLowerCase().includes(_e.toLowerCase())).slice(0,20).map(T=>{var U,J;return c.jsxs("label",{className:`kisi-item ${se===T.uid?"secili":""}`,children:[c.jsx("input",{type:"radio",name:"rica-kisi",value:T.uid,checked:se===T.uid,onChange:()=>Te(T.uid)}),c.jsx("span",{className:"avatar",children:((J=(U=T.fullName)==null?void 0:U.charAt(0))==null?void 0:J.toUpperCase())||"?"}),c.jsx("span",{className:"isim",children:T.fullName}),c.jsxs("span",{className:"etiket",children:[String(T.department||"").toLocaleUpperCase("tr-TR")," • ",String(T.position||"").toLocaleUpperCase("tr-TR")]})]},T.uid)})})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{children:"Not (isteğe bağlı)"}),c.jsx("textarea",{rows:3,placeholder:"Kısaca durumu açıklayın...",value:X,onChange:T=>ce(T.target.value)})]})]}),c.jsxs("div",{className:"modal-actions",children:[c.jsx("button",{className:"iptal-btn",onClick:()=>Ye(!1),children:"İptal"}),c.jsx("button",{className:"gonder-btn",onClick:dd,disabled:!se||i,children:"Gönder"})]})]})}),lt&&c.jsx("div",{style:{position:"fixed",bottom:20,left:"50%",transform:"translateX(-50%)",padding:"10px 16px",borderRadius:12,background:lt.type==="success"?"#28a745":lt.type==="warning"?"#ffc107":"#dc3545",color:"#fff",boxShadow:"0 6px 18px rgba(0,0,0,0.2)",zIndex:1100},children:lt.message}),E&&c.jsx("div",{className:"modal-overlay",children:c.jsxs("div",{className:"red-modal",children:[c.jsxs("div",{className:"modal-header",children:[c.jsx("h3",{children:"❌ Görev Reddetme"}),c.jsx("button",{className:"modal-close-btn",onClick:()=>{x(!1),b(""),ct(null)},children:"✕"})]}),c.jsxs("div",{className:"modal-content",children:[c.jsxs("div",{className:"red-uyari",children:[c.jsx("p",{children:"Bu görevi reddetmek istediğinizden emin misiniz?"}),c.jsxs("p",{children:[c.jsx("strong",{children:"Not:"})," Görev kullanıcıya normal şekilde görünecek ve tekrar yapabilecektir."]})]}),c.jsxs("div",{className:"red-nedeni-input",children:[c.jsx("label",{htmlFor:"redNedeni",children:"Red Nedeni (Zorunlu):"}),c.jsx("textarea",{id:"redNedeni",value:A,onChange:T=>b(T.target.value),placeholder:"Görevi neden reddettiğinizi açıklayın...",rows:4,maxLength:500}),c.jsxs("div",{className:"karakter-sayisi",children:[A.length,"/500 karakter"]})]}),c.jsxs("div",{className:"modal-actions",children:[c.jsx("button",{className:"iptal-btn",onClick:()=>{x(!1),b(""),ct(null)},children:"🔙 İptal"}),c.jsx("button",{className:"red-onayla-btn",onClick:cl,disabled:!A.trim(),children:"❌ Reddet"})]})]})]})}),F&&c.jsx("div",{className:"modal-overlay photo-modal-overlay",onClick:ol,children:c.jsxs("div",{className:"photo-modal",onClick:T=>T.stopPropagation(),children:[c.jsxs("div",{className:"photo-modal-header",children:[c.jsx("h3",{children:"📸 Kanıt Fotoğrafı"}),c.jsx("button",{className:"modal-close-btn",onClick:ol,children:"✕"})]}),c.jsx("div",{className:"photo-modal-content",children:c.jsx("img",{src:N,alt:"Büyütülmüş kanıt fotoğrafı",className:"buyutulmus-foto"})}),c.jsx("div",{className:"photo-modal-footer",children:c.jsx("p",{children:"Fotoğrafı kapatmak için dış alana tıklayın veya ✕ butonunu kullanın"})})]})}),C&&c.jsx("div",{className:"modal-overlay admin-modal-overlay",onClick:()=>ye(!1),children:c.jsxs("div",{className:"admin-gorev-modal",onClick:T=>T.stopPropagation(),children:[c.jsxs("div",{className:"modal-header",children:[c.jsx("h3",{children:"➕ Yeni Görev Ekle"}),c.jsx("button",{className:"modal-close",onClick:()=>ye(!1),children:"✕"})]}),c.jsxs("div",{className:"modal-content",children:[c.jsxs("div",{className:"form-group",children:[c.jsx("label",{children:"Görev Başlığı:"}),c.jsx("input",{type:"text",value:K.baslik,onChange:T=>Y({...K,baslik:T.target.value}),placeholder:"Görev başlığını girin..."})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{children:"Görev Açıklaması:"}),c.jsx("textarea",{value:K.aciklama,onChange:T=>Y({...K,aciklama:T.target.value}),placeholder:"Görev açıklamasını girin...",rows:"3"})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{children:"Alt Görevler:"}),c.jsxs("div",{className:"alt-gorev-input",children:[c.jsx("input",{type:"text",value:ve,onChange:T=>ue(T.target.value),placeholder:"Alt görev girin...",onKeyPress:T=>T.key==="Enter"&&Rn()}),c.jsx("button",{type:"button",onClick:Rn,children:"Ekle"})]}),c.jsx("div",{className:"alt-gorev-listesi",children:K.altGorevler.map(T=>c.jsxs("div",{className:"alt-gorev-item",children:[c.jsx("span",{children:T.baslik}),c.jsx("button",{onClick:()=>hl(T.id),children:"🗑️"})]},T.id))})]})]}),c.jsxs("div",{className:"modal-footer",children:[c.jsx("button",{className:"btn-iptal",onClick:()=>ye(!1),children:"İptal"}),c.jsx("button",{className:"btn-kaydet",onClick:hd,disabled:!K.baslik||!K.aciklama||K.altGorevler.length===0,children:"Görev Ekle"})]})]})}),Ue&&c.jsx("div",{className:"modal-overlay admin-modal-overlay",onClick:()=>be(!1),children:c.jsxs("div",{className:"admin-gorev-modal",onClick:T=>T.stopPropagation(),children:[c.jsxs("div",{className:"modal-header",children:[c.jsx("h3",{children:"✏️ Görev Düzenle"}),c.jsx("button",{className:"modal-close",onClick:()=>be(!1),children:"✕"})]}),c.jsxs("div",{className:"modal-content",children:[c.jsxs("div",{className:"form-group",children:[c.jsx("label",{children:"Görev Başlığı:"}),c.jsx("input",{type:"text",value:K.baslik,onChange:T=>Y({...K,baslik:T.target.value}),placeholder:"Görev başlığını girin..."})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{children:"Görev Açıklaması:"}),c.jsx("textarea",{value:K.aciklama,onChange:T=>Y({...K,aciklama:T.target.value}),placeholder:"Görev açıklamasını girin...",rows:"3"})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{children:"Alt Görevler:"}),c.jsxs("div",{className:"alt-gorev-input",children:[c.jsx("input",{type:"text",value:ve,onChange:T=>ue(T.target.value),placeholder:"Alt görev girin...",onKeyPress:T=>T.key==="Enter"&&Rn()}),c.jsx("button",{type:"button",onClick:Rn,children:"Ekle"})]}),c.jsx("div",{className:"alt-gorev-listesi",children:K.altGorevler.map(T=>c.jsxs("div",{className:"alt-gorev-item",children:[c.jsx("span",{children:T.baslik}),c.jsx("button",{onClick:()=>hl(T.id),children:"🗑️"})]},T.id))})]})]}),c.jsxs("div",{className:"modal-footer",children:[c.jsx("button",{className:"btn-iptal",onClick:()=>be(!1),children:"İptal"}),c.jsx("button",{className:"btn-kaydet",onClick:fd,disabled:!K.baslik||!K.aciklama||K.altGorevler.length===0,children:"Güncelle"})]})]})})]})},E_={in:{label:"İçerde",color:"green"},in_overtime:{label:"İçerde (Fazla Mesai)",color:"green"},out:{label:"Dışarda",color:"red"},absent:{label:"Bugün Gelmedi",color:"gray"},no_record:{label:"Kayıt Yok",color:"gray"}},hh=t=>t||"—",Jl=t=>{try{return t?new Date(t).toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):null}catch{return null}};function r2({open:t,onClose:e,record:n}){var d,m,p,g,k,S,R,D,w,y,I,P;if(M.useEffect(()=>{const F=B=>{B.key==="Escape"&&(e==null||e())};return t&&window.addEventListener("keydown",F),()=>window.removeEventListener("keydown",F)},[t,e]),!t||!n)return null;const r=E_[n.status]||E_.no_record,i=(d=n.arrivedAtLocation)==null?void 0:d.address,s=(m=n.arrivedAtLocation)!=null&&m.lat&&((p=n.arrivedAtLocation)!=null&&p.lon)?`https://www.google.com/maps?q=${n.arrivedAtLocation.lat},${n.arrivedAtLocation.lon}`:null,a=(g=n.leftAtLocation)==null?void 0:g.address,l=(k=n.leftAtLocation)!=null&&k.lat&&((S=n.leftAtLocation)!=null&&S.lon)?`https://www.google.com/maps?q=${n.leftAtLocation.lat},${n.leftAtLocation.lon}`:null,u=Array.isArray(n.history)?n.history:[];return c.jsx("div",{className:"mesai-modal-overlay",onClick:e,children:c.jsxs("div",{className:"mesai-modal",onClick:F=>F.stopPropagation(),children:[c.jsxs("div",{className:"mesai-modal-header",children:[c.jsxs("div",{children:[c.jsx("div",{className:"name",children:n.fullName}),c.jsxs("div",{className:"sub",children:[String(n.department||"").toLocaleUpperCase("tr-TR"),n.position?` / ${String(n.position).toLocaleUpperCase("tr-TR")}`:""]})]}),c.jsx("div",{className:`status-chip ${r.color}`,children:r.label})]}),c.jsxs("div",{className:"mesai-modal-section grid2",children:[c.jsxs("div",{className:"kv",children:[c.jsx("span",{children:"Geliş"}),c.jsx("strong",{children:hh(((R=n==null?void 0:n.arrivedAt)==null?void 0:R.clientTime)||Jl((D=n==null?void 0:n.arrivedAt)==null?void 0:D.millis))})]}),c.jsxs("div",{className:"kv",children:[c.jsx("span",{children:"Çıkış"}),c.jsx("strong",{children:hh(((w=n==null?void 0:n.leftAt)==null?void 0:w.clientTime)||Jl((y=n==null?void 0:n.leftAt)==null?void 0:y.millis))})]}),c.jsxs("div",{className:"kv",children:[c.jsx("span",{children:"Fazla Mesai"}),c.jsx("strong",{children:hh(((I=n==null?void 0:n.overtimeAt)==null?void 0:I.clientTime)||Jl((P=n==null?void 0:n.overtimeAt)==null?void 0:P.millis))})]}),c.jsxs("div",{className:"kv",children:[c.jsx("span",{children:"Durum"}),c.jsx("strong",{children:r.label})]})]}),c.jsxs("div",{className:"mesai-modal-section",children:[c.jsx("div",{className:"section-title",children:"Konum"}),i||a?c.jsxs("div",{children:[i&&c.jsxs("div",{className:"addr",style:{marginBottom:a?10:0},children:[c.jsxs("div",{children:[c.jsx("strong",{children:"Giriş:"})," ",i]}),s&&c.jsx("a",{className:"map",href:s,target:"_blank",rel:"noreferrer",children:"Haritada Aç"})]}),a&&c.jsxs("div",{className:"addr",children:[c.jsxs("div",{children:[c.jsx("strong",{children:"Çıkış:"})," ",a]}),l&&c.jsx("a",{className:"map",href:l,target:"_blank",rel:"noreferrer",children:"Haritada Aç"})]})]}):c.jsx("div",{className:"muted",children:"Konum bilgisi yok"})]}),c.jsxs("div",{className:"mesai-modal-section",children:[c.jsx("div",{className:"section-title",children:"Geçmiş"}),u.length===0?c.jsx("div",{className:"muted",children:"Kayıt yok"}):c.jsx("ul",{className:"history",children:u.map((F,B)=>{const N=F.atClientTime||Jl(F.atMillis)||F.clientTime||"—",v=F.type==="in"?"Giriş":F.type==="out"?"Çıkış":F.type==="absent"?"Bugün Gelmedi":F.type==="in_overtime"?"Fazla Mesai":F.type;return c.jsxs("li",{children:[c.jsx("span",{className:"pill",children:v})," ",c.jsx("span",{className:"time",children:N})]},B)})})]}),c.jsx("div",{className:"mesai-modal-actions",children:c.jsx("button",{className:"btn",onClick:e,children:"Kapat"})})]})})}function i2({open:t,onClose:e,title:n,items:r=[],type:i="inside",onSelect:s}){const[a,l]=M.useState("");M.useEffect(()=>{t&&l("")},[t]);const u=M.useMemo(()=>{const p=a.trim().toLowerCase();return p?r.filter(g=>{const k=(g.fullName||"").toLowerCase(),S=(g.department||"").toLowerCase(),R=(g.position||"").toLowerCase();return k.includes(p)||S.includes(p)||R.includes(p)}):r},[a,r]);if(!t)return null;const d=i==="inside"?"green":i==="absent"?"gray":"red",m=(p,g)=>{var y,I,P,F,B;const k=String(p.department||"").toLocaleUpperCase("tr-TR"),S=String(p.position||"").toLocaleUpperCase("tr-TR"),R=(y=p.arrivedAtLocation)==null?void 0:y.address,D=R?R.split(",").slice(0,3).join(", "):null,w=(I=p.arrivedAtLocation)!=null&&I.lat&&((P=p.arrivedAtLocation)!=null&&P.lon)?`https://www.google.com/maps?q=${p.arrivedAtLocation.lat},${p.arrivedAtLocation.lon}`:null;return c.jsxs("div",{className:"gl-row",onClick:()=>s==null?void 0:s(p),children:[c.jsx("div",{className:`gl-dot ${d}`}),c.jsxs("div",{className:"gl-info",children:[c.jsx("div",{className:"gl-name",children:p.fullName}),c.jsxs("div",{className:"gl-meta",children:[k,S?` / ${S}`:"",D?` · ${D}`:""," ",w&&c.jsx("a",{className:"gl-map",href:w,target:"_blank",rel:"noreferrer",onClick:N=>N.stopPropagation(),children:"harita"})]})]}),c.jsxs("div",{className:"gl-right",children:[i==="inside"&&((F=p.arrivedAt)==null?void 0:F.clientTime)&&c.jsxs("span",{className:"gl-pill",children:["Geliş ",p.arrivedAt.clientTime]}),i==="outside"&&c.jsxs("span",{className:"gl-pill",children:["Çıkış ",((B=p.leftAt)==null?void 0:B.clientTime)||"—"]}),i==="absent"&&c.jsx("span",{className:"gl-pill",children:"—"})]})]},p.uid||g)};return c.jsx("div",{className:"gl-overlay",onClick:e,children:c.jsxs("div",{className:"gl-modal",onClick:p=>p.stopPropagation(),children:[c.jsxs("div",{className:"gl-header",children:[c.jsxs("div",{className:"gl-title",children:[n," ",c.jsx("span",{className:"count",children:r.length})]}),c.jsx("button",{className:"gl-close",onClick:e,children:"×"})]}),c.jsx("div",{className:"gl-toolbar",children:c.jsx("input",{className:"gl-search",placeholder:"İsim / departman / pozisyon",value:a,onChange:p=>l(p.target.value)})}),c.jsx("div",{className:"gl-list",children:u.length===0?c.jsx("div",{className:"gl-empty",children:"Sonuç yok"}):u.map(m)})]})})}function s2({open:t,icon:e="🎉",title:n,subtitle:r,duration:i=2200,onClose:s}){return M.useEffect(()=>{if(!t)return;const a=setTimeout(()=>s==null?void 0:s(),i);return()=>clearTimeout(a)},[t,i,s]),t?c.jsx("div",{className:"cn-overlay",onClick:s,children:c.jsxs("div",{className:"cn-card",onClick:a=>a.stopPropagation(),role:"alertdialog","aria-live":"assertive",children:[c.jsx("div",{className:"cn-icon",children:e}),n&&c.jsx("div",{className:"cn-title",children:n}),r&&c.jsx("div",{className:"cn-sub",children:r}),c.jsx("button",{className:"cn-close",onClick:s,children:"×"})]})}):null}const a2=({userProfile:t,onBack:e})=>{var $n,on;const[n,r]=M.useState(null),[i,s]=M.useState({gelisSaati:null,cikisSaati:null}),[a,l]=M.useState(null),[u,d]=M.useState(()=>new Date().toISOString().split("T")[0]),[m,p]=M.useState(null),[g,k]=M.useState([]),[S,R]=M.useState([]),[D,w]=M.useState(!1),[y,I]=M.useState(null),[P,F]=M.useState(!1),[B,N]=M.useState(null),[v,E]=M.useState({open:!1,type:null,items:[]}),[x,A]=M.useState({open:!1,icon:"🎉",title:"",subtitle:""}),[b,C]=M.useState(null),[ye,Ue]=M.useState(!1),[be,ze]=M.useState(null),$=q_.useRef(null);M.useEffect(()=>{let ne=null;return(async()=>{const _e=await LP();_e!=null&&_e.success&&R(_e.users||[])})(),ne=$P(u,_e=>{k(_e||[])}),()=>{typeof ne=="function"&&ne()}},[u]);const K=()=>new Date(Date.now()-new Date().getTimezoneOffset()*6e4).toISOString().split("T")[0];M.useEffect(()=>{Y(u)},[u,t]);const Y=async(ne,_e={})=>{var Te,X;const{keepIfMissing:de=!1}=_e;if(!(t!=null&&t.uid))return;const se=await zP(t.uid,ne);if(se.success&&se.data){const ce=se.data;C(ce.date||ne),Ue(!!(ce!=null&&ce.leftAt)||(ce==null?void 0:ce.status)==="out");const fe=((Te=ce.arrivedAt)==null?void 0:Te.clientTime)||null,Je=((X=ce.leftAt)==null?void 0:X.clientTime)||null,ct=ce.status==="in"||ce.status==="in_overtime"?"geldim":ce.status==="out"?"kaldim":ce.status==="absent"?"gelmedim":null;if(l({durum:ct,gelisSaati:fe,cikisSaati:Je}),s({gelisSaati:fe,cikisSaati:Je}),fe&&!Je){const De=new Date(`${ne}T${fe}`),ln=new Date(De.getTime()+9.5*3600*1e3);p(ln.toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit",second:"2-digit"}))}else p(null)}else de||(l(null),s({gelisSaati:null,cikisSaati:null}),p(null),C(null),Ue(!1))},ve=async()=>{var ce;if(I(null),ze("in"),!(t!=null&&t.uid)){I("Profil eksik (UID). Lütfen çıkış yapıp tekrar giriş yapın.");return}w(!0);const ne=a,_e=i,de=new Date,se=de.toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit",second:"2-digit"});l({durum:"geldim",gelisSaati:se,cikisSaati:null}),s({gelisSaati:se,cikisSaati:null});const Te=new Date(de.getTime()+9.5*3600*1e3);p(Te.toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit",second:"2-digit"})),A({open:!0,icon:"👋",title:`Hoş geldin ${(t==null?void 0:t.firstName)||((ce=t==null?void 0:t.fullName)==null?void 0:ce.split(" ")[0])||""}!`,subtitle:"Güzel bir mesai olsun."});let X=null;try{const fe=await new Promise((ln,Ct)=>{if(!navigator.geolocation)return Ct(new Error("Geolocation not supported"));navigator.geolocation.getCurrentPosition(ln,Ct,{enableHighAccuracy:!0,maximumAge:0,timeout:1e4})}),{latitude:Je,longitude:ct}=fe.coords;let De=null;try{const ln=new AbortController,Ct=`https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${Je}&lon=${ct}`,Rt=setTimeout(()=>ln.abort(),2500),bt=await fetch(Ct,{headers:{Accept:"application/json"},signal:ln.signal});if(clearTimeout(Rt),bt.ok){const Oe=await bt.json();De=(Oe==null?void 0:Oe.display_name)||null}}catch{}X={lat:Je,lon:ct,address:De}}catch{A({open:!0,icon:"ℹ️",title:"Konum alınamadı",subtitle:"İzin verilmedi veya zaman aşımı. Kayıt yine de alındı."})}try{const fe=await KP({uid:t==null?void 0:t.uid,email:t==null?void 0:t.email,fullName:t==null?void 0:t.fullName,department:t==null?void 0:t.department,position:t==null?void 0:t.position},u,X);if(!(fe!=null&&fe.success))throw new Error((fe==null?void 0:fe.error)||"Kayıt başarısız");C(u),setTimeout(()=>Y(u,{keepIfMissing:!0}),600),setTimeout(()=>Y(u),1600)}catch(fe){I(`Kayıt alınamadı: ${(fe==null?void 0:fe.message)||fe}`),l(ne||null),s(_e||{gelisSaati:null,cikisSaati:null})}finally{w(!1)}},ue=async()=>{I(null),ze("out"),w(!0);const ne=b||u;let _e=null;try{const de=await new Promise((ce,fe)=>{if(!navigator.geolocation)return fe(new Error("Geolocation not supported"));navigator.geolocation.getCurrentPosition(ce,fe,{enableHighAccuracy:!0,maximumAge:0,timeout:1e4})}),{latitude:se,longitude:Te}=de.coords;let X=null;try{const ce=new AbortController,fe=`https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${se}&lon=${Te}`,Je=setTimeout(()=>ce.abort(),2500),ct=await fetch(fe,{headers:{Accept:"application/json"},signal:ce.signal});if(clearTimeout(Je),ct.ok){const De=await ct.json();X=(De==null?void 0:De.display_name)||null}}catch{}_e={lat:se,lon:Te,address:X}}catch{A({open:!0,icon:"ℹ️",title:"Konum alınamadı",subtitle:"İzin verilmedi veya zaman aşımı. Kayıt yine de alındı."})}try{const de=await v_({uid:t==null?void 0:t.uid,email:t==null?void 0:t.email,fullName:t==null?void 0:t.fullName,department:t==null?void 0:t.department,position:t==null?void 0:t.position},ne,_e);if(!(de!=null&&de.success))throw new Error((de==null?void 0:de.error)||"Çıkış kaydı başarısız");await Y(ne),A({open:!0,icon:"🙏",title:"Güle güle",subtitle:"Emeğin için teşekkürler."})}catch(de){I(`Çıkış alınamadı: ${(de==null?void 0:de.message)||de}`)}finally{w(!1)}};M.useEffect(()=>{$.current&&(clearTimeout($.current),$.current=null);const ne=a==null?void 0:a.durum,_e=a==null?void 0:a.gelisSaati,de=a==null?void 0:a.cikisSaati,se=b||u;if(ne==="geldim"&&_e&&!de&&se){const Te=new Date(`${se}T${_e}`),ce=new Date(Te.getTime()+9.5*3600*1e3).getTime()-Date.now();ce<=0?Ie():$.current=setTimeout(()=>{Ie()},ce)}return()=>{$.current&&clearTimeout($.current)}},[a==null?void 0:a.durum,a==null?void 0:a.gelisSaati,a==null?void 0:a.cikisSaati,b,u]);const Ie=async()=>{try{const ne=b||u;await v_({uid:t==null?void 0:t.uid,email:t==null?void 0:t.email,fullName:t==null?void 0:t.fullName,department:t==null?void 0:t.department,position:t==null?void 0:t.position},ne,null),await Y(ne),A({open:!0,icon:"⏰",title:"Otomatik Kapatıldı",subtitle:"9,5 saat dolduğu için mesai kapatıldı."})}catch{}},lt=()=>{if(be==="in")return ve();if(be==="out")return ue();if(be==="absent")return Ae();if(be==="overtime"){const ne=b||u;return __({uid:t==null?void 0:t.uid,email:t==null?void 0:t.email,fullName:t==null?void 0:t.fullName,department:t==null?void 0:t.department,position:t==null?void 0:t.position},ne).then(()=>Y(ne))}},Ae=async()=>{I(null),w(!0),await qP({uid:t==null?void 0:t.uid,email:t==null?void 0:t.email,fullName:t==null?void 0:t.fullName,department:t==null?void 0:t.department,position:t==null?void 0:t.position},u),await Y(u),w(!1)},xt=ne=>{switch(ne==null?void 0:ne.durum){case"geldim":return"🟢 Mesaide";case"kaldim":return"🔴 Mesai Bitti";case"gelmedim":return"❌ Bugün Gelmedi";default:return"⚪ Kayıt Yok"}},Ye=()=>{if(a!=null&&a.gelisSaati&&(a!=null&&a.cikisSaati)){const ne=new Date(`2000-01-01 ${a.gelisSaati}`),de=new Date(`2000-01-01 ${a.cikisSaati}`)-ne,se=Math.floor(de/(1e3*60*60)),Te=Math.floor(de%(1e3*60*60)/(1e3*60));return`${se}s ${Te}dk`}return null},yt=ne=>new Date(ne).toLocaleDateString("tr-TR",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return c.jsxs("div",{className:"mesai-takip-container",children:[c.jsxs("header",{className:"mesai-header",children:[c.jsxs("div",{className:"header-left",children:[c.jsx("button",{className:"geri-btn",onClick:e,children:"← Geri"}),c.jsxs("div",{className:"header-title",children:[c.jsx("h1",{children:"Mesai Takip"}),c.jsxs("p",{children:[(t==null?void 0:t.name)||(t==null?void 0:t.fullName)||"Kullanıcı"," - ",String((t==null?void 0:t.department)||"Departman").toLocaleUpperCase("tr-TR")]})]})]}),c.jsxs("div",{className:"date-picker-container",children:[c.jsx("label",{children:"Tarih:"}),c.jsx("input",{type:"date",value:u,onChange:ne=>d(ne.target.value),max:K(),className:"date-picker-input"}),c.jsx("button",{className:"bugun-btn",onClick:()=>d(K()),children:"Bugün"})]}),c.jsxs("div",{className:"header-stats",children:[c.jsxs("div",{className:"stat-card",children:[c.jsx("div",{className:"stat-number",children:"08:30"}),c.jsx("div",{className:"stat-label",children:"İşletme Açılış"})]}),c.jsxs("div",{className:"stat-card",children:[c.jsx("div",{className:"stat-number",children:"23:45"}),c.jsx("div",{className:"stat-label",children:"İşletme Kapanış"})]})]})]}),c.jsxs("main",{className:"mesai-main",children:[c.jsxs("div",{className:"user-info-bar",children:[c.jsx("div",{className:"user-avatar",children:((on=($n=t==null?void 0:t.fullName)==null?void 0:$n.charAt(0))==null?void 0:on.toUpperCase())||"U"}),c.jsxs("div",{className:"user-details",children:[c.jsx("h3",{children:(t==null?void 0:t.fullName)||"Kullanıcı"}),c.jsxs("p",{children:[String((t==null?void 0:t.department)||"Departman").toLocaleUpperCase("tr-TR")," - ",String((t==null?void 0:t.position)||"Pozisyon").toLocaleUpperCase("tr-TR")]})]}),c.jsx("div",{className:"tarih-info",children:c.jsx("div",{className:"tarih",children:yt(u)})})]}),c.jsxs("div",{className:"mesai-durum-karti",children:[c.jsx("h3",{children:"📊 Mesai Durumu"}),c.jsxs("div",{className:"mesai-butonlari",children:[(a==null?void 0:a.durum)==="geldim"?c.jsxs("button",{className:"mesai-btn kaldim-btn",onClick:ue,children:[c.jsx("div",{className:"btn-icon",children:"🛑"}),c.jsxs("div",{className:"btn-content",children:[c.jsx("h4",{children:"Mesaiyi Bitirdim"}),c.jsx("p",{children:"Çıkış saatini kaydet ve mesaiyi kapat."})]})]}):c.jsxs("button",{className:"mesai-btn geldim-btn",onClick:ve,disabled:ye||(a==null?void 0:a.durum)==="gelmedim"||D,title:ye?"Bugün çıkış alınmış, yeniden giriş kilitli.":"Geliş saatini kaydeder. 9,5 saat sonra otomatik kapanış uyarısı.",children:[c.jsx("div",{className:"btn-icon",children:"🟢"}),c.jsxs("div",{className:"btn-content",children:[c.jsx("h4",{children:"Mesaiye Geldim"}),c.jsx("p",{children:D?"Kaydediliyor...":ye?"Bugün için giriş kapalı (çıkış alınmış).":"Başlangıcı kaydet. 9.5 saat sonra otomatik kapanır."})]})]}),y&&c.jsxs("div",{style:{gridColumn:"1 / -1",color:"#b94a48"},children:[y,c.jsx("button",{className:"bugun-btn",style:{marginLeft:10},onClick:lt,children:"Tekrar Dene"})]}),(a==null?void 0:a.durum)==="gelmedim"&&c.jsxs("div",{style:{gridColumn:"1 / -1",color:"#856404"},children:["Bu günde 'Bugün Gelmedim' kaydı var. Gerekirse kaydı sıfırlayabilirsin.",c.jsx("button",{className:"bugun-btn",style:{marginLeft:10},onClick:async()=>{await HP({uid:t==null?void 0:t.uid},u),await Y(u)},children:"Kaydı Sıfırla"})]}),c.jsxs("button",{className:"mesai-btn kaldim-btn",onClick:async()=>{const ne=b||u;await __({uid:t==null?void 0:t.uid,email:t==null?void 0:t.email,fullName:t==null?void 0:t.fullName,department:t==null?void 0:t.department,position:t==null?void 0:t.position},ne),await Y(ne)},disabled:(a==null?void 0:a.durum)!=="geldim",children:[c.jsx("div",{className:"btn-icon",children:"⏱️"}),c.jsxs("div",{className:"btn-content",children:[c.jsx("h4",{children:"Mesaiye Kaldım"}),c.jsx("p",{children:"9.5 saat sonrası için uzat. Kapanışı ayrı alttan yap."})]})]}),c.jsxs("button",{className:"mesai-btn gelmedim-btn",onClick:Ae,disabled:(a==null?void 0:a.durum)==="gelmedim"||(a==null?void 0:a.gelisSaati),children:[c.jsx("div",{className:"btn-icon",children:"❌"}),c.jsxs("div",{className:"btn-content",children:[c.jsx("h4",{children:"Bugün Gelmedim"}),c.jsx("p",{children:"Bugün mesaiye gelmediğimi kaydet. Diğer seçenekler pasif olur."})]})]})]}),c.jsxs("div",{className:"durum-detay",children:[c.jsx("div",{className:"durum-badge",children:xt(a)}),a&&c.jsxs("div",{className:"saat-bilgileri",children:[a.gelisSaati&&c.jsxs("div",{className:"saat-item",children:[c.jsx("span",{className:"saat-label",children:"🟢 Geliş:"}),c.jsx("span",{className:"saat-value",children:a.gelisSaati})]}),a.cikisSaati&&c.jsxs("div",{className:"saat-item",children:[c.jsx("span",{className:"saat-label",children:"🔴 Çıkış:"}),c.jsx("span",{className:"saat-value",children:a.cikisSaati})]}),m&&!a.cikisSaati&&c.jsxs("div",{className:"saat-item otomatik",children:[c.jsx("span",{className:"saat-label",children:"⏰ Otomatik Çıkış:"}),c.jsx("span",{className:"saat-value",children:m})]}),Ye()&&c.jsxs("div",{className:"saat-item",children:[c.jsx("span",{className:"saat-label",children:"⏱️ Toplam:"}),c.jsx("span",{className:"saat-value",children:Ye()})]})]})]})]}),c.jsxs("div",{className:"bilgi-mesaji",children:[c.jsx("h4",{children:"ℹ️ Önemli Bilgiler:"}),c.jsxs("ul",{children:[c.jsx("li",{children:"Mesai kayıtları günlük olarak tutulur"}),c.jsx("li",{children:"Mesaiye geldikten 9.5 saat sonra otomatik kapatma uyarısı"}),c.jsx("li",{children:"Bir kez kaydedilen durum değiştirilemez"}),c.jsx("li",{children:"Mesaiye geldikten sonra çıkış yapabilirsiniz"}),c.jsx("li",{children:"Bugün gelmediğinizi işaretlerseniz diğer seçenekler pasif olur"}),c.jsx("li",{children:"Giriş/çıkış sırasında konum izni istenir; doğru kayıt için izin vermeniz önerilir"})]})]})]}),c.jsx("main",{className:"mesai-main",children:c.jsxs("div",{className:"mesai-durum-karti",children:[c.jsx("h3",{children:"🏪 İşletme Durum Panosu"}),(()=>{const ne=new Map(g.map(X=>[X.uid,X])),_e=[],de=[],se=[];for(const X of g)X.status==="in"||X.status==="in_overtime"?_e.push(X):X.status==="absent"&&de.push(X);for(const X of S){const ce=ne.get(X.uid);if(ce){if(ce.status==="in"||ce.status==="in_overtime"||ce.status==="absent")continue;se.push(ce)}else se.push({uid:X.uid,fullName:X.fullName||X.firstName+" "+(X.lastName||""),department:X.department,position:X.position,leftAt:null,arrivedAtLocation:null,status:"no_record"})}const Te=(X,ce="gray",fe="outside")=>{var Oe,Xe;const Je=String(X.department||"").toLocaleUpperCase("tr-TR"),ct=String(X.position||"").toLocaleUpperCase("tr-TR"),De=fe==="outside"&&X.leftAtLocation||X.arrivedAtLocation,ln=De==null?void 0:De.address,Ct=ln?ln.split(",").slice(0,3).join(", "):null,Rt=De!=null&&De.lat&&(De!=null&&De.lon)?`https://www.google.com/maps?q=${De.lat},${De.lon}`:null,bt=[];if(fe==="inside"&&(X.status==="in_overtime"&&bt.push(c.jsx("span",{className:"chip overtime",children:"fazla mesai"},"ot")),(Oe=X.arrivedAt)!=null&&Oe.clientTime&&bt.push(c.jsxs("span",{className:"chip",children:["Geliş: ",X.arrivedAt.clientTime]},"in"))),fe==="outside"&&(bt.push(c.jsxs("span",{className:"chip",children:["Çıkış: ",((Xe=X.leftAt)==null?void 0:Xe.clientTime)||"—"]},"out")),X.status==="no_record"&&bt.push(c.jsx("span",{className:"chip warn",children:"kayıt yok"},"nr")),De)){const Gn=X.leftAtLocation?"Çıkış konumu":"Giriş konumu";bt.push(c.jsx("span",{className:"chip",children:Gn},"loc"))}return c.jsxs("div",{className:"user-row",onClick:()=>{N(X),F(!0)},style:{cursor:"pointer"},children:[c.jsx("div",{className:`user-dot ${ce}`}),c.jsxs("div",{className:"user-info",children:[c.jsx("div",{className:"user-name",children:X.fullName}),c.jsxs("div",{className:"user-meta",children:[Je,ct?` / ${ct}`:"",Ct?` · ${Ct}`:""," ",Rt&&c.jsx("a",{className:"map-link",href:Rt,target:"_blank",rel:"noreferrer",children:"harita"})]}),bt.length>0&&c.jsx("div",{className:"chips",children:bt})]})]},X.uid||X.id)};return c.jsx("div",{children:c.jsxs("div",{className:"panel-columns",children:[c.jsxs("div",{className:"panel-card",children:[c.jsxs("div",{className:"panel-card-header",children:[c.jsx("span",{className:"btn-icon",children:"🟢"}),c.jsx("button",{className:"title",style:{background:"transparent",border:0,cursor:"pointer",padding:0},onClick:()=>E({open:!0,type:"inside",items:_e,title:"İçerde Olanlar"}),children:"İçerde Olanlar"}),c.jsx("span",{className:"count",children:_e.length})]}),c.jsx("div",{className:"list-scroll",children:_e.length===0?c.jsx("div",{className:"empty-state",children:"Yok"}):_e.map(X=>Te(X,"green","inside"))})]}),c.jsxs("div",{className:"panel-card",children:[c.jsxs("div",{className:"panel-card-header",children:[c.jsx("span",{className:"btn-icon",children:"🔴"}),c.jsx("button",{className:"title",style:{background:"transparent",border:0,cursor:"pointer",padding:0},onClick:()=>E({open:!0,type:"outside",items:se,title:"Dışarda Olanlar"}),children:"Dışarda Olanlar"}),c.jsx("span",{className:"count",children:se.length})]}),c.jsx("div",{className:"list-scroll",children:se.length===0?c.jsx("div",{className:"empty-state",children:"Yok"}):se.map(X=>Te(X,"red","outside"))})]}),c.jsxs("div",{className:"panel-card",children:[c.jsxs("div",{className:"panel-card-header",children:[c.jsx("span",{className:"btn-icon",children:"❌"}),c.jsx("button",{className:"title",style:{background:"transparent",border:0,cursor:"pointer",padding:0},onClick:()=>E({open:!0,type:"absent",items:de,title:"Bugün Gelmeyenler"}),children:"Bugün Gelmeyenler"}),c.jsx("span",{className:"count",children:de.length})]}),c.jsx("div",{className:"list-scroll",children:de.length===0?c.jsx("div",{className:"empty-state",children:"Yok"}):de.map(X=>Te(X,"gray","absent"))})]})]})})})()]})}),c.jsx(r2,{open:P,onClose:()=>F(!1),record:B}),c.jsx(i2,{open:v.open,title:v.title,type:v.type,items:v.items,onClose:()=>E({open:!1,type:null,items:[]}),onSelect:ne=>{N(ne),F(!0)}}),c.jsx(s2,{open:x.open,icon:x.icon,title:x.title,subtitle:x.subtitle,duration:2200,onClose:()=>A({...x,open:!1})})]})};function o2({userProfile:t,onBack:e}){const[n,r]=M.useState(""),[i,s]=M.useState(""),[a,l]=M.useState(!1),[u,d]=M.useState([]),[m,p]=M.useState(null),g=async()=>{if(p(null),!n||!i){p("Başlangıç ve bitiş tarihlerini seçin.");return}l(!0);const S=await GP(n,i);S.success?d(S.items):p("Kayıtlar alınamadı"),l(!1)},k=()=>{const S=["Ad Soyad","Tarih","Durum","Geliş","Çıkış","Fazla Mesai"],R=u.map(P=>{var F,B,N;return[P.fullName,P.date,P.status,((F=P.arrivedAt)==null?void 0:F.clientTime)||"",((B=P.leftAt)==null?void 0:B.clientTime)||"",((N=P.overtimeAt)==null?void 0:N.clientTime)||""]}),D=[S,...R].map(P=>P.map(F=>`"${(F||"").toString().replaceAll('"','""')}"`).join(",")).join(`
`),w=new Blob([D],{type:"text/csv;charset=utf-8;"}),y=URL.createObjectURL(w),I=document.createElement("a");I.href=y,I.download=`mesai-rapor_${n||"baslangic"}_${i||"bitis"}.csv`,I.click(),URL.revokeObjectURL(y)};return c.jsxs("div",{style:{padding:20},children:[c.jsx("button",{onClick:e,children:"← Geri"}),c.jsx("h2",{children:"Raporlar"}),c.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[c.jsx("label",{children:"Başlangıç"}),c.jsx("input",{type:"date",value:n,onChange:S=>r(S.target.value)}),c.jsx("label",{children:"Bitiş"}),c.jsx("input",{type:"date",value:i,onChange:S=>s(S.target.value)}),c.jsx("button",{onClick:g,disabled:a,children:a?"Yükleniyor...":"Getir"}),c.jsx("button",{onClick:k,disabled:!u.length,children:"CSV İndir"})]}),m&&c.jsx("div",{style:{color:"#b94a48",marginTop:10},children:m}),c.jsxs("div",{style:{marginTop:20},children:[c.jsxs("div",{style:{fontWeight:"bold",marginBottom:8},children:["Kayıt Sayısı: ",u.length]}),c.jsxs("div",{style:{maxHeight:420,overflow:"auto",border:"1px solid #eee",borderRadius:8},children:[u.map(S=>{var R,D,w;return c.jsxs("div",{style:{padding:10,borderBottom:"1px solid #f2f2f2"},children:[c.jsxs("div",{style:{fontWeight:"600"},children:[S.fullName," — ",S.date," (",S.status,")"]}),c.jsxs("div",{style:{fontSize:13,opacity:.8},children:["Geliş: ",((R=S.arrivedAt)==null?void 0:R.clientTime)||"—"," · Çıkış: ",((D=S.leftAt)==null?void 0:D.clientTime)||"—"," · Fazla Mesai: ",((w=S.overtimeAt)==null?void 0:w.clientTime)||"—"]})]},S.id)}),u.length===0&&c.jsx("div",{style:{padding:14,opacity:.7},children:"Kayıt yok"})]})]})]})}function l2({userProfile:t,onBack:e,onOpenReports:n,onOpenMola:r,onOpenPersonel:i,onOpenUsers:s,onOpenNotifications:a}){const l=(t==null?void 0:t.role)==="admin";return c.jsxs("div",{className:"admin-wrap",children:[c.jsxs("header",{className:"admin-header",children:[c.jsx("button",{className:"back-btn",onClick:e,children:"← Geri"}),c.jsx("h1",{children:"Yönetim Menüsü"}),c.jsx("div",{className:"spacer"})]}),l?c.jsx("main",{className:"admin-main",children:c.jsxs("div",{className:"admin-grid",children:[c.jsxs("button",{className:"admin-card",onClick:n,children:[c.jsx("div",{className:"icon",children:"📈"}),c.jsxs("div",{className:"txt",children:[c.jsx("h3",{children:"Raporlar"}),c.jsx("p",{children:"Mesai ve mola raporları"})]}),c.jsx("div",{className:"arrow",children:"→"})]}),c.jsxs("button",{className:"admin-card",onClick:r,children:[c.jsx("div",{className:"icon",children:"☕"}),c.jsxs("div",{className:"txt",children:[c.jsx("h3",{children:"Mola Yönetimi"}),c.jsx("p",{children:"Aktif molalar ve geçmiş"})]}),c.jsx("div",{className:"arrow",children:"→"})]}),c.jsxs("button",{className:"admin-card",onClick:i,children:[c.jsx("div",{className:"icon",children:"👥"}),c.jsxs("div",{className:"txt",children:[c.jsx("h3",{children:"Personel"}),c.jsx("p",{children:"Kadro ve vardiyalar"})]}),c.jsx("div",{className:"arrow",children:"→"})]}),c.jsxs("button",{className:"admin-card",onClick:s,children:[c.jsx("div",{className:"icon",children:"🛂"}),c.jsxs("div",{className:"txt",children:[c.jsx("h3",{children:"Kullanıcılar"}),c.jsx("p",{children:"Rol ve aktiflik yönetimi"})]}),c.jsx("div",{className:"arrow",children:"→"})]}),c.jsxs("button",{className:"admin-card",onClick:a,children:[c.jsx("div",{className:"icon",children:"🔔"}),c.jsxs("div",{className:"txt",children:[c.jsx("h3",{children:"Bildirimler"}),c.jsx("p",{children:"Tekil ve toplu gönderimler"})]}),c.jsx("div",{className:"arrow",children:"→"})]})]})}):c.jsx("div",{className:"warn",children:"Bu alanı görüntülemek için yetkiniz yok."})]})}const Xl=t=>{if(!t&&t!==0)return"—";try{return new Date(t).toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return"—"}},T_=t=>{const e=Math.max(0,Math.floor(t/1e3)),n=Math.floor(e/60),r=String(e%60).padStart(2,"0");return`${n} dk ${r} sn`};function c2({open:t,onClose:e,record:n}){const r=M.useMemo(()=>{var u,d,m,p;if(!n)return[];const s=Array.isArray(n.history)?[...n.history]:[];s.sort((g,k)=>(g.atMillis||0)-(k.atMillis||0));const a=[];let l=null;for(const g of s)if(g.type==="start")l={type:g.breakType,duration:g.duration,start:g.atMillis,startClient:g.atClientTime};else if(g.type==="end"&&l){const k=l.start+(l.duration||0)*60*1e3,S=g.atMillis,R=Math.max(0,S-k);a.push({...l,end:S,endClient:g.atClientTime,expectedEnd:k,over:R}),l=null}if(n.active&&n.activeBreak){const g=n.activeBreak;a.push({type:g.type,duration:g.duration,start:(u=g.startedAt)==null?void 0:u.millis,startClient:(d=g.startedAt)==null?void 0:d.clientTime,expectedEnd:(m=g.expectedEndAt)==null?void 0:m.millis,end:null,over:Math.max(0,Date.now()-(((p=g.expectedEndAt)==null?void 0:p.millis)||0))})}return a},[n]),i=r.filter(s=>s.end).reduce((s,a)=>s+Math.max(0,a.end-(a.start||0)),0);return!t||!n?null:c.jsx("div",{className:"mola-modal-overlay",onClick:e,children:c.jsxs("div",{className:"mola-modal",onClick:s=>s.stopPropagation(),children:[c.jsxs("div",{className:"mola-modal-header",children:[c.jsxs("div",{children:[c.jsx("div",{className:"name",children:n.fullName}),c.jsx("div",{className:"sub",children:n.date})]}),c.jsx("button",{className:"close-btn",onClick:e,children:"×"})]}),c.jsxs("div",{className:"mola-modal-section",children:[c.jsx("div",{className:"section-title",children:"Özet"}),c.jsxs("div",{className:"summary",children:[c.jsxs("div",{className:"pill",children:["Seans: ",r.length]}),c.jsxs("div",{className:"pill",children:["Toplam Süre: ",T_(i)]})]})]}),c.jsxs("div",{className:"mola-modal-section",children:[c.jsx("div",{className:"section-title",children:"Günün Molaları"}),r.length===0?c.jsx("div",{className:"muted",children:"Kayıt yok"}):c.jsx("ul",{className:"sess-list",children:r.map((s,a)=>{const l=(s.duration||0)*60*1e3,u=s.end&&l?Math.round(Math.max(0,s.end-s.expectedEnd)/l*100):s.over>0&&l?Math.round(s.over/l*100):0;return c.jsxs("li",{className:"sess-item",children:[c.jsxs("div",{className:"row-top",children:[c.jsx("span",{className:"pill kind",children:s.type}),s.end?c.jsxs("span",{className:u>0?"pill danger":"pill soft",children:[Xl(s.start)," → ",Xl(s.end)," ",u>0?` · Aşım %${u}`:""]}):c.jsxs("span",{className:s.over>0?"pill danger":"pill soft",children:[Xl(s.start)," → ",Xl(s.expectedEnd),s.over>0?` · Aşım +${T_(s.over)}`:""]})]}),c.jsx("div",{className:`progress ${(s.end?s.end>s.expectedEnd:Date.now()>(s.expectedEnd||0))?"over":""}`,children:c.jsx("div",{className:"progress-bar",style:{width:`${Math.min(100,Math.round(((s.end||Date.now())-(s.start||0))/(l||1)*100))}%`}})})]},a)})})]}),c.jsx("div",{className:"mola-modal-actions",children:c.jsx("button",{className:"btn",onClick:e,children:"Kapat"})})]})})}const fh=()=>new Date(Date.now()-new Date().getTimezoneOffset()*6e4).toISOString().split("T")[0];function u2({userProfile:t,onBack:e}){var N,v,E,x;const[n,r]=M.useState(fh()),[i,s]=M.useState(!1),[a,l]=M.useState(null),[u,d]=M.useState([]),[m,p]=M.useState(null);M.useEffect(()=>{const A=YP(n,b=>d(b||[]));return()=>{typeof A=="function"&&A()}},[n]);const g=M.useMemo(()=>u.find(A=>A.uid===(t==null?void 0:t.uid)),[u,t]),k=(g==null?void 0:g.active)&&(g==null?void 0:g.activeBreak),[S,R]=M.useState(Date.now()),D=M.useRef(!1);M.useEffect(()=>{const A=setInterval(()=>R(Date.now()),1e3);return()=>clearInterval(A)},[]),M.useEffect(()=>{D.current=!1},[(N=k==null?void 0:k.startedAt)==null?void 0:N.millis]),M.useEffect(()=>{var b;if(!((b=k==null?void 0:k.expectedEndAt)!=null&&b.millis))return;const A=k.expectedEndAt.millis-S;!D.current&&A<=6e4&&A>0&&(navigator!=null&&navigator.vibrate&&navigator.vibrate([200,120,200]),D.current=!0)},[S,(v=k==null?void 0:k.expectedEndAt)==null?void 0:v.millis]);const w=A=>{const b=Math.max(0,Math.floor(A/1e3)),C=String(Math.floor(b/60)).padStart(2,"0"),ye=String(b%60).padStart(2,"0");return`${C}:${ye}`},y=A=>{const b=Math.max(0,Math.floor(A/1e3)),C=String(Math.floor(b/3600)).padStart(2,"0"),ye=String(Math.floor(b%3600/60)).padStart(2,"0"),Ue=String(b%60).padStart(2,"0");return`${C}:${ye}:${Ue}`},I=async(A,b)=>{l(null),s(!0),(await WP({uid:t==null?void 0:t.uid,fullName:t==null?void 0:t.fullName,department:t==null?void 0:t.department,position:t==null?void 0:t.position},n,A,b)).success||l("Mola başlatılamadı"),s(!1)},P=async()=>{l(null),s(!0),(await QP({uid:t==null?void 0:t.uid},n)).success||l("Mola bitirilemedi"),s(!1)},F=u.filter(A=>A.active&&A.activeBreak),B=u.map(A=>({...A,last:[...A.history||[]].reverse().find(b=>b.type==="end"||b.type==="start")})).filter(Boolean);return c.jsxs("div",{className:"mola-container",children:[c.jsxs("header",{className:"mola-header",children:[c.jsxs("div",{className:"header-left",children:[c.jsx("button",{className:"geri-btn",onClick:e,children:"← Geri"}),c.jsxs("div",{className:"header-title",children:[c.jsx("h1",{children:"Mola Yönetimi"}),c.jsx("p",{children:(t==null?void 0:t.fullName)||"Kullanıcı"})]})]}),c.jsxs("div",{className:"date-picker-container",children:[c.jsx("label",{children:"Tarih:"}),c.jsx("input",{type:"date",value:n,max:fh(),onChange:A=>r(A.target.value),className:"date-picker-input"}),c.jsx("button",{className:"bugun-btn",onClick:()=>r(fh()),children:"Bugün"})]})]}),a&&c.jsx("div",{className:"err",children:a}),c.jsxs("main",{className:"mola-main",children:[c.jsxs("div",{className:"mola-kart",children:[c.jsx("h3",{children:"☕ Mola Seçenekleri"}),c.jsxs("div",{className:"mola-btn-grid",children:[c.jsxs("button",{className:"mola-btn",disabled:i||!!k,onClick:()=>I("yemek_45",45),title:"45 dakikalık yemek molası başlat",children:[c.jsx("div",{className:"btn-icon",children:"🍽️"}),c.jsxs("div",{className:"btn-content",children:[c.jsx("h4",{children:"Yemek Molası"}),c.jsx("p",{children:"45 dakika"})]})]}),c.jsxs("button",{className:"mola-btn",disabled:i||!!k,onClick:()=>I("yemek_30",30),title:"30 dakikalık yemek molası başlat",children:[c.jsx("div",{className:"btn-icon",children:"🍽️"}),c.jsxs("div",{className:"btn-content",children:[c.jsx("h4",{children:"Yemek Molası"}),c.jsx("p",{children:"30 dakika"})]})]}),c.jsxs("button",{className:"mola-btn",disabled:i||!!k,onClick:()=>I("normal_15",15),title:"15 dakikalık mola başlat",children:[c.jsx("div",{className:"btn-icon",children:"☕"}),c.jsxs("div",{className:"btn-content",children:[c.jsx("h4",{children:"Normal Mola"}),c.jsx("p",{children:"15 dakika"})]})]})]}),k&&c.jsxs("div",{className:"aktif-mola",children:[c.jsxs("div",{className:"aktif-bilgi",children:[c.jsx("span",{className:"pill",children:"Aktif"}),c.jsx("span",{className:"tip",children:k.type}),c.jsxs("span",{className:"saat",children:[(E=k.startedAt)==null?void 0:E.clientTime," → ",(x=k.expectedEndAt)==null?void 0:x.clientTime]}),(()=>{var be,ze,$;const A=((be=k.expectedEndAt)==null?void 0:be.millis)||0,b=A-S;if(b>0)return c.jsxs("span",{className:"pill soft",children:["Kalan ",w(b)]});const C=S-A,ye=(k.duration||0)*60*1e3,Ue=ye?Math.round(C/ye*100):0;return!(g!=null&&g.alertSentAt)&&Ue>=50&&JP({uid:t==null?void 0:t.uid,fullName:t==null?void 0:t.fullName,department:t==null?void 0:t.department,position:t==null?void 0:t.position},n,{breakType:k.type,duration:k.duration,startedAtMillis:(ze=k.startedAt)==null?void 0:ze.millis,expectedEndMillis:($=k.expectedEndAt)==null?void 0:$.millis,overMillis:C,overPct:Ue}),c.jsxs("span",{className:"pill danger",children:["AŞIM +",w(C)," ",Ue>0?`(%${Ue})`:""]})})(),(g==null?void 0:g.alertSentAt)&&c.jsx("span",{className:"pill soft",children:"Yönetime bildirildi"})]}),c.jsx("button",{className:"bitir-btn",disabled:i,onClick:P,children:"Molayı Bitir"})]})]}),c.jsxs("div",{className:"panel-columns",children:[c.jsxs("div",{className:"panel-card",children:[c.jsxs("div",{className:"panel-card-header",children:[c.jsx("span",{className:"btn-icon",children:"📋"}),c.jsx("span",{className:"title",children:"Bugün Mola Yapanlar"}),c.jsx("span",{className:"count",children:B.length})]}),c.jsx("div",{className:"list-scroll",children:B.length===0?c.jsx("div",{className:"empty-state",children:"Kayıt yok"}):B.map(A=>{var ve,ue,Ie,lt,Ae,xt,Ye,yt,$n,on,ne,_e,de;const b=A.active&&A.activeBreak;let C=null,ye=0;const Ue=Array.isArray(A.history)?[...A.history].sort((se,Te)=>(se.atMillis||0)-(Te.atMillis||0)):[],be=[];let ze=null;for(const se of Ue)se.type==="start"?ze={start:se.atMillis,duration:se.duration,type:se.breakType}:se.type==="end"&&ze&&(be.push({...ze,end:se.atMillis}),ze=null);b&&be.push({start:(ue=(ve=A.activeBreak)==null?void 0:ve.startedAt)==null?void 0:ue.millis,end:null,duration:(Ie=A.activeBreak)==null?void 0:Ie.duration,type:(lt=A.activeBreak)==null?void 0:lt.type});const $=be.filter(se=>se.start&&se.end),K=$.reduce((se,Te)=>se+Math.max(0,Te.end-Te.start),0)+(b?Math.max(0,S-(((xt=(Ae=A.activeBreak)==null?void 0:Ae.startedAt)==null?void 0:xt.millis)||S)):0),Y=$.length+(b?1:0);if(b){const se=((yt=(Ye=A.activeBreak)==null?void 0:Ye.startedAt)==null?void 0:yt.millis)||0,Te=((on=($n=A.activeBreak)==null?void 0:$n.expectedEndAt)==null?void 0:on.millis)||0,X=(((ne=A.activeBreak)==null?void 0:ne.duration)||0)*60*1e3,ce=Math.max(0,S-se);if(ye=X?Math.min(100,Math.round(ce/X*100)):0,S<Te)C=c.jsxs("span",{className:"chip",children:["Kalan ",w(Te-S)]});else{const fe=S-Te,Je=X?Math.round(fe/X*100):0;C=c.jsxs("span",{className:"chip warn",children:["Aşım +",w(fe)," ",Je>0?`(%${Je})`:""]})}}return c.jsx("div",{className:"user-row clickable",onClick:()=>p({...A,date:n}),title:"Günün mola detaylarını gör",children:c.jsxs("div",{className:"user-info",children:[c.jsx("div",{className:"user-name",children:A.fullName}),c.jsxs("div",{className:"chips",children:[c.jsxs("span",{className:"chip",children:["Molalar: ",Y]}),c.jsxs("span",{className:"chip",children:["Toplam: ",y(K)]}),C]}),b&&c.jsx("div",{className:`progress ${S>(((de=(_e=A.activeBreak)==null?void 0:_e.expectedEndAt)==null?void 0:de.millis)||0)?"over":""}`,children:c.jsx("div",{className:"progress-bar",style:{width:`${ye}%`}})})]})},A.id)})})]}),c.jsxs("div",{className:"panel-card",children:[c.jsxs("div",{className:"panel-card-header",children:[c.jsx("span",{className:"btn-icon",children:"⏱️"}),c.jsx("span",{className:"title",children:"Şu An Aktif Moladakiler"}),c.jsx("span",{className:"count",children:F.length})]}),c.jsx("div",{className:"list-scroll",children:F.length===0?c.jsx("div",{className:"empty-state",children:"Kimse yok"}):F.map(A=>{var b,C,ye,Ue,be;return c.jsx("div",{className:"user-row",children:c.jsxs("div",{className:"user-info",children:[c.jsx("div",{className:"user-name",children:A.fullName}),c.jsxs("div",{className:"chips",children:[c.jsx("span",{className:"chip",children:(b=A.activeBreak)==null?void 0:b.type}),c.jsxs("span",{className:"chip",children:[(ye=(C=A.activeBreak)==null?void 0:C.startedAt)==null?void 0:ye.clientTime," → ",(be=(Ue=A.activeBreak)==null?void 0:Ue.expectedEndAt)==null?void 0:be.clientTime]})]})]})},A.id)})})]})]})]}),c.jsx(c2,{open:!!m,onClose:()=>p(null),record:m})]})}function d2({userProfile:t,onBack:e}){const n=(t==null?void 0:t.role)==="admin",[r,i]=M.useState(!0),[s,a]=M.useState([]),[l,u]=M.useState("all"),[d,m]=M.useState(""),[p,g]=M.useState(null),k=n,S=async()=>{i(!0);try{const y=await FP();y.success&&a(y.users)}finally{i(!1)}};M.useEffect(()=>{S()},[]);const R=M.useMemo(()=>{const y=d.toLowerCase();return s.filter(I=>!(l==="active"&&!I.isActive||l==="passive"&&I.isActive||l==="admins"&&I.role!=="admin"||l==="employees"&&I.role!=="employee"||y&&!String(I.fullName||"").toLowerCase().includes(y)&&!String(I.email||"").toLowerCase().includes(y)))},[s,l,d]),D=async(y,I)=>{if(k){g(y.uid);try{(await UP(y.uid,I)).success&&await S()}finally{g(null)}}},w=async(y,I)=>{if(k){g(y.uid);try{(await BP(y.uid,I)).success&&await S()}finally{g(null)}}};return c.jsxs("div",{className:"admin-users-wrap",children:[c.jsxs("header",{className:"admin-users-header",children:[c.jsx("button",{className:"back-btn",onClick:e,children:"← Geri"}),c.jsx("h1",{children:"Kullanıcı Yönetimi"}),c.jsx("div",{className:"spacer"})]}),!n&&c.jsx("div",{className:"warn",children:"Bu alan için yetkiniz yok."}),c.jsxs("div",{className:"toolbar",children:[c.jsx("input",{className:"search",placeholder:"Ara: isim veya e-posta",value:d,onChange:y=>m(y.target.value)}),c.jsxs("div",{className:"filters",children:[c.jsx("button",{className:`chip ${l==="all"?"active":""}`,onClick:()=>u("all"),children:"Tümü"}),c.jsx("button",{className:`chip ${l==="active"?"active":""}`,onClick:()=>u("active"),children:"Aktif"}),c.jsx("button",{className:`chip ${l==="passive"?"active":""}`,onClick:()=>u("passive"),children:"Pasif"}),c.jsx("button",{className:`chip ${l==="admins"?"active":""}`,onClick:()=>u("admins"),children:"Admin"}),c.jsx("button",{className:`chip ${l==="employees"?"active":""}`,onClick:()=>u("employees"),children:"Personel"})]})]}),r?c.jsx("div",{className:"loading",children:"Yükleniyor…"}):c.jsxs("div",{className:"list",children:[R.map(y=>c.jsxs("div",{className:`row ${y.isActive?"":"passive"}`,children:[c.jsx("div",{className:"id",children:c.jsx("div",{className:"avatar",children:String(y.fullName||"?").charAt(0).toUpperCase()})}),c.jsxs("div",{className:"info",children:[c.jsx("div",{className:"name",children:y.fullName||"—"}),c.jsxs("div",{className:"meta",children:[String(y.department||"").toLocaleUpperCase("tr-TR")," • ",String(y.position||"").toLocaleUpperCase("tr-TR")]}),c.jsx("div",{className:"email",children:y.email})]}),c.jsxs("div",{className:"actions",children:[c.jsxs("div",{className:"role",children:[c.jsx("span",{className:`role-badge ${y.role==="admin"?"admin":"employee"}`,children:y.role==="admin"?"Admin":"Personel"}),k&&c.jsxs("div",{className:"role-buttons",children:[c.jsx("button",{disabled:p===y.uid||y.role==="admin",onClick:()=>D(y,"admin"),children:"Yap: Admin"}),c.jsx("button",{disabled:p===y.uid||y.role==="employee",onClick:()=>D(y,"employee"),children:"Yap: Personel"})]})]}),c.jsxs("div",{className:"active",children:[c.jsxs("label",{className:"switch",children:[c.jsx("input",{type:"checkbox",checked:!!y.isActive,disabled:!k||p===y.uid,onChange:I=>w(y,I.target.checked)}),c.jsx("span",{className:"slider"})]}),c.jsx("div",{className:"active-text",children:y.isActive?"Aktif":"Pasif"})]})]})]},y.uid||y.id)),R.length===0&&c.jsx("div",{className:"empty",children:"Kriterlere uygun kullanıcı bulunamadı."})]})]})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h2="type.googleapis.com/google.protobuf.Int64Value",f2="type.googleapis.com/google.protobuf.UInt64Value";function GI(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function fu(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>fu(e));if(typeof t=="function"||typeof t=="object")return GI(t,e=>fu(e));throw new Error("Data cannot be encoded in JSON: "+t)}function ra(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case h2:case f2:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>ra(e)):typeof t=="function"||typeof t=="object"?GI(t,e=>ra(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lp="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k_={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Zt extends Cn{constructor(e,n,r){super(`${Lp}/${e}`,n||""),this.details=r,Object.setPrototypeOf(this,Zt.prototype)}}function m2(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function mu(t,e){let n=m2(t),r=n,i;try{const s=e&&e.error;if(s){const a=s.status;if(typeof a=="string"){if(!k_[a])return new Zt("internal","internal");n=k_[a],r=a}const l=s.message;typeof l=="string"&&(r=l),i=s.details,i!==void 0&&(i=ra(i))}}catch{}return n==="ok"?null:new Zt(n,r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p2{constructor(e,n,r,i){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,dn(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||n.get().then(s=>this.auth=s,()=>{}),this.messaging||r.get().then(s=>this.messaging=s,()=>{}),this.appCheck||i==null||i.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:i}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lf="us-central1",g2=/^data: (.*?)(?:\n|$)/;function y2(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new Zt("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class v2{constructor(e,n,r,i,s=Lf,a=(...l)=>fetch(...l)){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new p2(e,n,r,i),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(s);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=Lf}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function _2(t,e,n){const r=ns(e);t.emulatorOrigin=`http${r?"s":""}://${e}:${n}`,r&&(Pm(t.emulatorOrigin),Om("Functions",!0))}function w2(t,e,n){const r=i=>T2(t,e,i,{});return r.stream=(i,s)=>I2(t,e,i,s),r}async function E2(t,e,n,r){n["Content-Type"]="application/json";let i;try{i=await r(t,{method:"POST",body:JSON.stringify(e),headers:n})}catch{return{status:0,json:null}}let s=null;try{s=await i.json()}catch{}return{status:i.status,json:s}}async function KI(t,e){const n={},r=await t.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(n.Authorization="Bearer "+r.authToken),r.messagingToken&&(n["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(n["X-Firebase-AppCheck"]=r.appCheckToken),n}function T2(t,e,n,r){const i=t._url(e);return k2(t,i,n,r)}async function k2(t,e,n,r){n=fu(n);const i={data:n},s=await KI(t,r),a=r.timeout||7e4,l=y2(a),u=await Promise.race([E2(e,i,s,t.fetchImpl),l.promise,t.cancelAllRequests]);if(l.cancel(),!u)throw new Zt("cancelled","Firebase Functions instance was deleted.");const d=mu(u.status,u.json);if(d)throw d;if(!u.json)throw new Zt("internal","Response is not valid JSON object.");let m=u.json.data;if(typeof m>"u"&&(m=u.json.result),typeof m>"u")throw new Zt("internal","Response is missing data field.");return{data:ra(m)}}function I2(t,e,n,r){const i=t._url(e);return S2(t,i,n,r||{})}async function S2(t,e,n,r){var g;n=fu(n);const i={data:n},s=await KI(t,r);s["Content-Type"]="application/json",s.Accept="text/event-stream";let a;try{a=await t.fetchImpl(e,{method:"POST",body:JSON.stringify(i),headers:s,signal:r==null?void 0:r.signal})}catch(k){if(k instanceof Error&&k.name==="AbortError"){const R=new Zt("cancelled","Request was cancelled.");return{data:Promise.reject(R),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(R)}}}}}}const S=mu(0,null);return{data:Promise.reject(S),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(S)}}}}}}let l,u;const d=new Promise((k,S)=>{l=k,u=S});(g=r==null?void 0:r.signal)==null||g.addEventListener("abort",()=>{const k=new Zt("cancelled","Request was cancelled.");u(k)});const m=a.body.getReader(),p=A2(m,l,u,r==null?void 0:r.signal);return{stream:{[Symbol.asyncIterator](){const k=p.getReader();return{async next(){const{value:S,done:R}=await k.read();return{value:S,done:R}},async return(){return await k.cancel(),{done:!0,value:void 0}}}}},data:d}}function A2(t,e,n,r){const i=(a,l)=>{const u=a.match(g2);if(!u)return;const d=u[1];try{const m=JSON.parse(d);if("result"in m){e(ra(m.result));return}if("message"in m){l.enqueue(ra(m.message));return}if("error"in m){const p=mu(0,m);l.error(p),n(p);return}}catch(m){if(m instanceof Zt){l.error(m),n(m);return}}},s=new TextDecoder;return new ReadableStream({start(a){let l="";return u();async function u(){if(r!=null&&r.aborted){const d=new Zt("cancelled","Request was cancelled");return a.error(d),n(d),Promise.resolve()}try{const{value:d,done:m}=await t.read();if(m){l.trim()&&i(l.trim(),a),a.close();return}if(r!=null&&r.aborted){const g=new Zt("cancelled","Request was cancelled");a.error(g),n(g),await t.cancel();return}l+=s.decode(d,{stream:!0});const p=l.split(`
`);l=p.pop()||"";for(const g of p)g.trim()&&i(g.trim(),a);return u()}catch(d){const m=d instanceof Zt?d:mu(0,null);a.error(m),n(m)}}},cancel(){return t.cancel()}})}const I_="@firebase/functions",S_="0.13.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N2="auth-internal",x2="app-check-internal",C2="messaging-internal";function R2(t){const e=(n,{instanceIdentifier:r})=>{const i=n.getProvider("app").getImmediate(),s=n.getProvider(N2),a=n.getProvider(C2),l=n.getProvider(x2);return new v2(i,s,a,l,r)};yn(new an(Lp,e,"PUBLIC").setMultipleInstances(!0)),Ut(I_,S_,t),Ut(I_,S_,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A_(t=qo(),e=Lf){const r=Rr(Re(t),Lp).getImmediate({identifier:e}),i=ZE("functions");return i&&Ff(r,...i),r}function Ff(t,e,n){_2(Re(t),e,n)}function N_(t,e,n){return w2(Re(t),e)}R2();function b2({userProfile:t,onBack:e}){const n=(t==null?void 0:t.role)==="admin",[r,i]=M.useState("Duyuru"),[s,a]=M.useState(""),[l,u]=M.useState(!1),[d,m]=M.useState([]),p=async()=>{try{const S=tt(xe(oe,"notification_queue"),as("createdAt","desc"),YD(20)),R=await ot(S),D=[];R.forEach(w=>D.push({id:w.id,...w.data()})),m(D)}catch{}};M.useEffect(()=>{p()},[]);const g=async()=>{var S,R;if(n&&s.trim()){u(!0);try{const D=A_(Zi,"us-central1");if(typeof window<"u"&&window.location.hostname==="localhost")try{Ff(D,"localhost",5001)}catch{}const y=await N_(D,"enqueueBroadcast")({payload:{notification:{title:r||"Duyuru",body:s.trim()}}});if(!((S=y==null?void 0:y.data)!=null&&S.success))throw new Error("callable_failed");(R=y==null?void 0:y.data)!=null&&R.success&&(a(""),await p())}catch{try{if(typeof window<"u"&&window.location.hostname.endsWith(".pages.dev")){const y=await ot(tt(xe(oe,"users"),at("isActive","==",!0))),I=[];if(y.forEach(F=>{const B=F.get("fcmToken");B&&I.push(String(B))}),I.length===0)throw new Error("no_tokens");if(!(await fetch("/api/notify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tokens:I,notification:{title:r||"Duyuru",body:s.trim()},data:{}})})).ok)throw new Error("worker_failed");a(""),await p();return}}catch{(await bP({notification:{title:r||"Duyuru",body:s.trim()}},{uid:t==null?void 0:t.uid,email:t==null?void 0:t.email})).success&&(a(""),await p())}}finally{u(!1)}}},k=async()=>{if(n){u(!0);try{const S=A_(Zi,"us-central1");if(typeof window<"u"&&window.location.hostname==="localhost")try{Ff(S,"localhost",5001)}catch{}await N_(S,"processPending")({limit:25}),await p()}catch(S){console.error("processPending error",S)}finally{u(!1)}}};return c.jsxs("div",{className:"admin-notif-wrap",children:[c.jsxs("header",{className:"admin-notif-header",children:[c.jsx("button",{className:"back-btn",onClick:e,children:"← Geri"}),c.jsx("h1",{children:"Bildirimler"}),c.jsx("div",{className:"spacer"})]}),!n&&c.jsx("div",{className:"warn",children:"Bu alan için yetkiniz yok."}),c.jsxs("div",{className:"pane",children:[c.jsxs("div",{className:"form",children:[c.jsxs("div",{className:"group",children:[c.jsx("label",{children:"Başlık"}),c.jsx("input",{value:r,onChange:S=>i(S.target.value)})]}),c.jsxs("div",{className:"group",children:[c.jsx("label",{children:"Mesaj"}),c.jsx("textarea",{rows:3,placeholder:"Tüm kullanıcılara gidecek mesaj...",value:s,onChange:S=>a(S.target.value)})]}),c.jsxs("div",{className:"actions",children:[c.jsx("button",{className:"send",onClick:g,disabled:l||!s.trim(),children:"Gönder"}),c.jsx("button",{className:"send",onClick:k,disabled:l,children:"Bekleyenleri İşle"})]})]}),c.jsxs("div",{className:"recent",children:[c.jsx("h3",{children:"Son Kuyruk Kayıtları"}),c.jsxs("div",{className:"list",children:[d.map(S=>{var R,D;return c.jsxs("div",{className:`row ${S.status||"pending"}`,children:[c.jsx("div",{className:"id",children:S.id}),c.jsxs("div",{className:"msg",children:[(R=S.notification)==null?void 0:R.title," — ",(D=S.notification)==null?void 0:D.body]}),c.jsx("div",{className:"status",children:S.status||"pending"})]},S.id)}),d.length===0&&c.jsx("div",{className:"empty",children:"Kayıt yok"})]})]})]}),c.jsx("footer",{className:"hint",children:"Not: Gönderimler, Firestore'daki notification_queue üzerinden bir (gelecek) Cloud Function ile tekil olarak FCM'e iletilir."})]})}const D2=({user:t,onLogout:e,refreshKey:n,setRefreshKey:r})=>{var B,N;const[i,s]=M.useState(null),[a,l]=M.useState(!0),[u,d]=M.useState(!1),[m,p]=M.useState(!1),[g,k]=M.useState(!1),[S,R]=M.useState(!1),[D,w]=M.useState(()=>localStorage.getItem("glowchocolate_currentView")||"dashboard");M.useEffect(()=>{y()},[]),M.useEffect(()=>{localStorage.setItem("glowchocolate_currentView",D),console.log("🔄 Mevcut görünüm localStorage'a kaydedildi:",D)},[D]);const y=async()=>{try{const v=await _s(t.uid);v.success&&s(v.user)}catch(v){console.error("Profil yüklenemedi:",v)}finally{l(!1)}},I=[{id:"imalat-stok",title:"İmalat & Stok",icon:"🏭",description:"Üretim ve stok yönetimi",color:"#d4af37"},{id:"kasa-defteri",title:"Kasa Defteri",icon:"💰",description:"Kasa giriş çıkış takibi",color:"#b8860b"},{id:"satis-recete",title:"Satış & Reçete",icon:"📋",description:"Satış kayıtları ve reçeteler",color:"#d4af37"},{id:"gelir-gider",title:"Gelir & Gider",icon:"📊",description:"Mali durumu izleme",color:"#b8860b"},{id:"personel-takibi",title:"Personel Takibi",icon:"👥",description:"Personel yönetimi",color:"#d4af37",adminOnly:!1},{id:"maas-bilgisi",title:"Maaş Bilgisi",icon:"💵",description:"Maaş hesaplama ve ödeme",color:"#b8860b",adminOnly:!0},{id:"dis-tedarik",title:"Dış Tedarik & Stok Sayım",icon:"📦",description:"Tedarik yönetimi & Stok Sayımı",color:"#d4af37"},{id:"vardiya-yonetimi",title:"Personel Listesi & Vardiya Yönetimi",icon:"⏰",description:"Vardiya planlaması",color:"#b8860b",adminOnly:!0},{id:"ayarlar-raporlar",title:"Ayarlar & Raporlar",icon:"⚙️",description:"Sistem ayarları ve raporlar",color:"#d4af37",adminOnly:!0,action:()=>w("admin")}],P=v=>{console.log(`${v} kartına tıklandı`);const E=I.find(x=>x.id===v);if(E!=null&&E.adminOnly&&(i==null?void 0:i.role)!=="admin"){alert("Bu alana sadece adminler erişebilir.");return}if(E!=null&&E.action){E.action();return}v==="personel-takibi"&&w("personel-takip")};M.useEffect(()=>{!((i==null?void 0:i.role)==="admin")&&["admin","admin-users","admin-notifications","reports"].includes(D)&&(console.warn("Yetkisiz admin görünümü algılandı, ana panele yönlendiriliyor:",D),w("dashboard"))},[i==null?void 0:i.role,D]);const F=v=>({yonetim:"Yönetim",mudur:"Müdür",koordinatorler:"Koordinatörler","servis-personeli":"Servis Personeli","bar-personeli":"Bar Personeli","mutfak-personeli":"Mutfak Personeli","tedarik-sorumlusu":"Tedarik Sorumlusu","imalat-personeli":"İmalat Personeli"})[v]||v;return a?c.jsx("div",{className:"dashboard-container",children:c.jsxs("div",{className:"loading-wrapper",children:[c.jsx("div",{className:"loading-spinner"}),c.jsx("p",{children:"Yükleniyor..."})]})}):D==="gorevler"?c.jsxs(c.Fragment,{children:[c.jsx(n2,{userProfile:i,onBack:()=>w("personel-takip")}),c.jsx(Yl,{isOpen:u,onClose:()=>d(!1),userProfile:i,onUpdateProfile:async v=>{try{console.log("Profil güncelleniyor:",v);const E=await Ql(t.uid,v);if(E.success){console.log("✅ Profil başarıyla güncellendi");const x=await _s(t.uid);x.success&&(s(x.user),r(A=>A+1),console.log("✅ Kullanıcı profili yenilendi"),console.log("✅ Personel kartları yenilenecek"))}else throw console.error("❌ Güncelleme başarısız:",E.message),new Error(E.message||"Güncelleme başarısız")}catch(E){throw console.error("❌ Profile update error:",E),E}}})]}):D==="mesai-takip"?c.jsxs(c.Fragment,{children:[c.jsx(a2,{userProfile:i,onBack:()=>w("personel-takip")}),c.jsx(Yl,{isOpen:u,onClose:()=>d(!1),userProfile:i,onUpdateProfile:async v=>{try{console.log("Profil güncelleniyor:",v);const E=await Ql(t.uid,v);if(E.success){console.log("✅ Profil başarıyla güncellendi");const x=await _s(t.uid);x.success&&(s(x.user),r(A=>A+1),console.log("✅ Kullanıcı profili yenilendi"),console.log("✅ Personel kartları yenilenecek"))}else throw console.error("❌ Güncelleme başarısız:",E.message),new Error(E.message||"Güncelleme başarısız")}catch(E){throw console.error("❌ Profile update error:",E),E}}})]}):D==="reports"?c.jsx(c.Fragment,{children:c.jsx(o2,{userProfile:i,onBack:()=>w("dashboard")})}):D==="admin"?c.jsx(c.Fragment,{children:c.jsx(l2,{userProfile:i,onBack:()=>w("dashboard"),onOpenReports:()=>w("reports"),onOpenMola:()=>w("mola"),onOpenPersonel:()=>w("personel-takip"),onOpenUsers:()=>w("admin-users"),onOpenNotifications:()=>w("admin-notifications")})}):D==="mola"?c.jsx(c.Fragment,{children:c.jsx(u2,{userProfile:i,onBack:()=>w("personel-takip")})}):D==="admin-users"?c.jsx(c.Fragment,{children:c.jsx(d2,{userProfile:i,onBack:()=>w("admin")})}):D==="admin-notifications"?c.jsx(c.Fragment,{children:c.jsx(b2,{userProfile:i,onBack:()=>w("admin")})}):D==="personel-takip"?c.jsxs(c.Fragment,{children:[c.jsx(e2,{isOpen:!0,onClose:()=>w("dashboard"),userProfile:i,onOpenGorevler:()=>w("gorevler"),onOpenMesaiTakip:()=>w("mesai-takip"),onOpenMola:()=>w("mola")}),c.jsx(Yl,{isOpen:u,onClose:()=>d(!1),userProfile:i,onUpdate:async v=>{try{console.log("Profil güncelleniyor:",v);const E=await Ql(t.uid,v);if(E.success){console.log("✅ Profil başarıyla güncellendi");const x=await _s(t.uid);x.success&&(s(x.user),r(A=>A+1),console.log("✅ Kullanıcı profili yenilendi"),console.log("✅ Personel kartları yenilenecek"))}else throw console.error("❌ Güncelleme başarısız:",E.message),new Error(E.message||"Güncelleme başarısız")}catch(E){throw console.error("❌ Profile update error:",E),E}}})]}):c.jsxs("div",{className:"dashboard-container",children:[c.jsxs("header",{className:"dashboard-header",children:[c.jsx("div",{className:"header-left",children:c.jsx("div",{className:"brand-section",children:c.jsxs("div",{className:"brand-text",children:[c.jsx("h1",{children:"Glow Chocolate"}),c.jsx("p",{children:"İşletme Yönetim Sistemi"})]})})}),c.jsxs("div",{className:"header-right",children:[c.jsxs("div",{className:"user-info",children:[c.jsx("div",{className:"user-avatar",onClick:()=>d(!0),style:{cursor:"pointer"},children:(N=(B=(i==null?void 0:i.fullName)||t.name)==null?void 0:B.charAt(0))==null?void 0:N.toUpperCase()}),c.jsxs("div",{className:"user-details",children:[c.jsxs("span",{className:"user-name",children:["Hoş geldin, ",(i==null?void 0:i.fullName)||t.name,(i==null?void 0:i.role)==="admin"&&c.jsx("span",{className:"admin-badge",onClick:()=>d(!0),style:{cursor:"pointer"},children:"⬇️"})]}),c.jsx("span",{className:"user-department",children:(i==null?void 0:i.department)&&F(i.department)})]})]}),c.jsx("button",{onClick:e,className:"logout-btn",children:"Çıkış Yap"})]})]}),c.jsxs("main",{className:"dashboard-main",children:[c.jsxs("div",{className:"welcome-section",children:[c.jsx("h2",{children:" İşletme Kontrol Merkezi"}),c.jsx("p",{children:"Üst düzey yönetim paneline hoş geldiniz. Tüm işletme süreçlerinizi buradan izleyebilir ve yönetebilirsiniz."})]}),c.jsx("div",{className:"cards-grid",children:I.filter(v=>!v.adminOnly||(i==null?void 0:i.role)==="admin").map(v=>c.jsxs("div",{className:"dashboard-card",onClick:()=>P(v.id),style:{"--card-color":v.color},children:[c.jsx("div",{className:"card-icon",children:v.icon}),c.jsxs("div",{className:"card-content",children:[c.jsx("h3",{children:v.title}),c.jsx("p",{children:v.description})]}),c.jsx("div",{className:"card-arrow",children:"→"})]},v.id))})]}),c.jsx(Yl,{isOpen:u,onClose:()=>d(!1),userProfile:i,onUpdateProfile:async v=>{try{console.log("Profil güncelleniyor:",v);const E=await Ql(t.uid,v);if(E.success){console.log("✅ Profil başarıyla güncellendi");const x=await _s(t.uid);x.success&&(s(x.user),r(A=>A+1),console.log("✅ Kullanıcı profili yenilendi"),console.log("✅ Personel kartları yenilenecek"))}else throw console.error("❌ Güncelleme başarısız:",E.message),new Error(E.message||"Güncelleme başarısız")}catch(E){throw console.error("❌ Profile update error:",E),E}}}),c.jsx(t2,{isOpen:S,onClose:()=>R(!1),userProfile:i})]})};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j2="/firebase-messaging-sw.js",P2="/firebase-cloud-messaging-push-scope",qI="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",O2="https://fcmregistrations.googleapis.com/v1",HI="google.c.a.c_id",M2="google.c.a.c_l",V2="google.c.a.ts",L2="google.c.a.e",x_=1e4;var C_;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(C_||(C_={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var Lo;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(Lo||(Lo={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cr(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function F2(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(n),i=new Uint8Array(r.length);for(let s=0;s<r.length;++s)i[s]=r.charCodeAt(s);return i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mh="fcm_token_details_db",U2=5,R_="fcm_token_object_Store";async function B2(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(s=>s.name).includes(mh))return null;let e=null;return(await Ou(mh,U2,{upgrade:async(r,i,s,a)=>{if(i<2||!r.objectStoreNames.contains(R_))return;const l=a.objectStore(R_),u=await l.index("fcmSenderId").get(t);if(await l.clear(),!!u){if(i===2){const d=u;if(!d.auth||!d.p256dh||!d.endpoint)return;e={token:d.fcmToken,createTime:d.createTime??Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:typeof d.vapidKey=="string"?d.vapidKey:cr(d.vapidKey)}}}else if(i===3){const d=u;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:cr(d.auth),p256dh:cr(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:cr(d.vapidKey)}}}else if(i===4){const d=u;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:cr(d.auth),p256dh:cr(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:cr(d.vapidKey)}}}}}})).close(),await Zd(mh),await Zd("fcm_vapid_details_db"),await Zd("undefined"),z2(e)?e:null}function z2(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $2="firebase-messaging-database",G2=1,Fo="firebase-messaging-store";let ph=null;function WI(){return ph||(ph=Ou($2,G2,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Fo)}}})),ph}async function K2(t){const e=QI(t),r=await(await WI()).transaction(Fo).objectStore(Fo).get(e);if(r)return r;{const i=await B2(t.appConfig.senderId);if(i)return await Fp(t,i),i}}async function Fp(t,e){const n=QI(t),i=(await WI()).transaction(Fo,"readwrite");return await i.objectStore(Fo).put(e,n),await i.done,e}function QI({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q2={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Bt=new yi("messaging","Messaging",q2);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H2(t,e){const n=await Bp(t),r=YI(e),i={method:"POST",headers:n,body:JSON.stringify(r)};let s;try{s=await(await fetch(Up(t.appConfig),i)).json()}catch(a){throw Bt.create("token-subscribe-failed",{errorInfo:a==null?void 0:a.toString()})}if(s.error){const a=s.error.message;throw Bt.create("token-subscribe-failed",{errorInfo:a})}if(!s.token)throw Bt.create("token-subscribe-no-token");return s.token}async function W2(t,e){const n=await Bp(t),r=YI(e.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)};let s;try{s=await(await fetch(`${Up(t.appConfig)}/${e.token}`,i)).json()}catch(a){throw Bt.create("token-update-failed",{errorInfo:a==null?void 0:a.toString()})}if(s.error){const a=s.error.message;throw Bt.create("token-update-failed",{errorInfo:a})}if(!s.token)throw Bt.create("token-update-no-token");return s.token}async function Q2(t,e){const r={method:"DELETE",headers:await Bp(t)};try{const s=await(await fetch(`${Up(t.appConfig)}/${e}`,r)).json();if(s.error){const a=s.error.message;throw Bt.create("token-unsubscribe-failed",{errorInfo:a})}}catch(i){throw Bt.create("token-unsubscribe-failed",{errorInfo:i==null?void 0:i.toString()})}}function Up({projectId:t}){return`${O2}/projects/${t}/registrations`}async function Bp({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function YI({p256dh:t,auth:e,endpoint:n,vapidKey:r}){const i={web:{endpoint:n,auth:e,p256dh:t}};return r!==qI&&(i.web.applicationPubKey=r),i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y2=7*24*60*60*1e3;async function J2(t){const e=await Z2(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:cr(e.getKey("auth")),p256dh:cr(e.getKey("p256dh"))},r=await K2(t.firebaseDependencies);if(r){if(eO(r.subscriptionOptions,n))return Date.now()>=r.createTime+Y2?X2(t,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await Q2(t.firebaseDependencies,r.token)}catch(i){console.warn(i)}return b_(t.firebaseDependencies,n)}else return b_(t.firebaseDependencies,n)}async function X2(t,e){try{const n=await W2(t.firebaseDependencies,e),r={...e,token:n,createTime:Date.now()};return await Fp(t.firebaseDependencies,r),n}catch(n){throw n}}async function b_(t,e){const r={token:await H2(t,e),createTime:Date.now(),subscriptionOptions:e};return await Fp(t,r),r.token}async function Z2(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:F2(e)})}function eO(t,e){const n=e.vapidKey===t.vapidKey,r=e.endpoint===t.endpoint,i=e.auth===t.auth,s=e.p256dh===t.p256dh;return n&&r&&i&&s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D_(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return tO(e,t),nO(e,t),rO(e,t),e}function tO(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const r=e.notification.body;r&&(t.notification.body=r);const i=e.notification.image;i&&(t.notification.image=i);const s=e.notification.icon;s&&(t.notification.icon=s)}function nO(t,e){e.data&&(t.data=e.data)}function rO(t,e){var i,s,a,l;if(!e.fcmOptions&&!((i=e.notification)!=null&&i.click_action))return;t.fcmOptions={};const n=((s=e.fcmOptions)==null?void 0:s.link)??((a=e.notification)==null?void 0:a.click_action);n&&(t.fcmOptions.link=n);const r=(l=e.fcmOptions)==null?void 0:l.analytics_label;r&&(t.fcmOptions.analyticsLabel=r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iO(t){return typeof t=="object"&&!!t&&HI in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sO(t){if(!t||!t.options)throw gh("App Configuration Object");if(!t.name)throw gh("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const r of e)if(!n[r])throw gh(r);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function gh(t){return Bt.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aO{constructor(e,n,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const i=sO(e);this.firebaseDependencies={app:e,appConfig:i,installations:n,analyticsProvider:r}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oO(t){try{t.swRegistration=await navigator.serviceWorker.register(j2,{scope:P2}),t.swRegistration.update().catch(()=>{}),await lO(t.swRegistration)}catch(e){throw Bt.create("failed-service-worker-registration",{browserErrorMessage:e==null?void 0:e.message})}}async function lO(t){return new Promise((e,n)=>{const r=setTimeout(()=>n(new Error(`Service worker not registered after ${x_} ms`)),x_),i=t.installing||t.waiting;t.active?(clearTimeout(r),e()):i?i.onstatechange=s=>{var a;((a=s.target)==null?void 0:a.state)==="activated"&&(i.onstatechange=null,clearTimeout(r),e())}:(clearTimeout(r),n(new Error("No incoming service worker found.")))})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cO(t,e){if(!e&&!t.swRegistration&&await oO(t),!(!e&&t.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw Bt.create("invalid-sw-registration");t.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uO(t,e){e?t.vapidKey=e:t.vapidKey||(t.vapidKey=qI)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JI(t,e){if(!navigator)throw Bt.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw Bt.create("permission-blocked");return await uO(t,e==null?void 0:e.vapidKey),await cO(t,e==null?void 0:e.serviceWorkerRegistration),J2(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dO(t,e,n){const r=hO(e);(await t.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[HI],message_name:n[M2],message_time:n[V2],message_device_time:Math.floor(Date.now()/1e3)})}function hO(t){switch(t){case Lo.NOTIFICATION_CLICKED:return"notification_open";case Lo.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fO(t,e){const n=e.data;if(!n.isFirebaseMessaging)return;t.onMessageHandler&&n.messageType===Lo.PUSH_RECEIVED&&(typeof t.onMessageHandler=="function"?t.onMessageHandler(D_(n)):t.onMessageHandler.next(D_(n)));const r=n.data;iO(r)&&r[L2]==="1"&&await dO(t,n.messageType,r)}const j_="@firebase/messaging",P_="0.12.23";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mO=t=>{const e=new aO(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",n=>fO(e,n)),e},pO=t=>{const e=t.getProvider("messaging").getImmediate();return{getToken:r=>JI(e,r)}};function gO(){yn(new an("messaging",mO,"PUBLIC")),yn(new an("messaging-internal",pO,"PRIVATE")),Ut(j_,P_),Ut(j_,P_,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zp(){try{await ju()}catch{return!1}return typeof window<"u"&&Du()&&Vm()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yO(t,e){if(!navigator)throw Bt.create("only-available-in-window");return t.onMessageHandler=e,()=>{t.onMessageHandler=null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XI(t=qo()){return zp().then(e=>{if(!e)throw Bt.create("unsupported-browser")},e=>{throw Bt.create("indexed-db-unsupported")}),Rr(Re(t),"messaging").getImmediate()}async function vO(t,e){return t=Re(t),JI(t,e)}function _O(t,e){return t=Re(t),yO(t,e)}gO();const wO="",O_=async t=>{try{if(typeof window>"u")return{success:!1,error:"no_window"};if(!await zp())return{success:!1,error:"not_supported"};const n=await navigator.serviceWorker.register("/firebase-messaging-sw.js"),r=XI(Zi);if(await Notification.requestPermission()!=="granted")return{success:!1,error:"denied"};const s=await vO(r,{vapidKey:wO,serviceWorkerRegistration:n});if(!s)return{success:!1,error:"no_token"};const a=tt(xe(oe,"users"),at("uid","==",t)),l=await ot(a);if(!l.empty){const u=l.docs[0];await xn(Nt(oe,"users",u.id),{fcmToken:s,fcmUpdatedAt:new Date})}return{success:!0,token:s}}catch(e){return console.error("FCM register error:",e),{success:!1,error:e.code||String(e)}}},EO=async t=>{if(!await zp())return()=>{};const n=XI(Zi);return _O(n,r=>t(r))};function TO(){const[t,e]=M.useState(!1),[n,r]=M.useState(!1),[i,s]=M.useState(null),[a,l]=M.useState(!0),[u,d]=M.useState("dashboard"),[m,p]=M.useState(0);M.useEffect(()=>{const S=SP(R=>{R?(s({uid:R.uid,email:R.email,name:R.email.split("@")[0]}),r(!0),O_(R.uid).catch(()=>{}),EO(D=>{console.info("[FCM] Foreground",D)}).catch(()=>{})):(s(null),r(!1)),l(!1)});return()=>S()},[]);const g=S=>{e(!0),setTimeout(()=>{s(S),r(!0),e(!1),S!=null&&S.uid&&O_(S.uid).catch(()=>{})},3e3)},k=async()=>{try{await IP(),s(null),r(!1)}catch(S){console.error("Logout error:",S)}};return a?c.jsx(w_,{}):t?c.jsx(w_,{}):n?c.jsx("div",{className:"app-container",children:c.jsx("main",{className:"app-main",children:c.jsx(D2,{user:i,onLogout:k,refreshKey:m,setRefreshKey:p})})}):c.jsx(ZP,{onLogin:g})}yh.createRoot(document.getElementById("root")).render(c.jsx(q_.StrictMode,{children:c.jsx(TO,{})}));
